<!DOCTYPE html>
<html data-integrity="">
<head>
<title>YavirLab</title>
<meta http-equiv="X-UA-Compatible" content="IE=10">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<HTA:APPLICATION 
    ID="YavirLabApp"
    APPLICATIONNAME="YavirLab"
    BORDER="thin"
    BORDERSTYLE="normal"
    CAPTION="yes"
    ICON=""
    SHOWINTASKBAR="yes"
    SINGLEINSTANCE="yes"
    SYSMENU="yes"
    VERSION="1.0"
    WINDOWSTATE="normal"
    SCROLL="auto">
    
<script language="VBScript">
Function yam()
Dim shell,scriptPath
Set shell = CreateObject("WScript.Shell")
On Error Resume Next
scriptPath = shell.CurrentDirectory
If Err.Number <> 0 Then
scriptPath = "ERROR: WScript.Shell.CurrentDirectory not available."
End If
On Error GoTo 0
yam = scriptPath & "\YavirLab"
End Function
Function yax()
Dim fso,htaPath,parentFolderPath, dbFolder
Set fso = CreateObject("Scripting.FileSystemObject")
On Error Resume Next
htaPath = yam()
If htaPath = "" Then
MsgBox "Не вдалося визначити шлях до HTA-файлу.", vbCritical, "Критична помилка"
yax = ""
Exit Function
End If
parentFolderPath = fso.GetParentFolderName(htaPath)
If Err.Number <> 0 Then
MsgBox "Не вдалося отримати батьківську теку з шляху: " & htaPath & vbCrLf & "Помилка: " & Err.Description, vbCritical, "Помилка шляху"
yax = ""
Exit Function
End If
dbFolder = parentFolderPath & "\YavirLabDB"
If Not fso.FolderExists(dbFolder) Then
fso.CreateFolder dbFolder
If Err.Number <> 0 Then
MsgBox "Не вдалося створити теку бази даних: " & dbFolder & vbCrLf & "Перевірте права доступу." & vbCrLf & "Помилка: " & Err.Description, vbCritical, "Помилка доступу"
yax = ""
Exit Function
End If
End If
yax = dbFolder
On Error GoTo 0
End Function
Function yay()
yay = yax() & "\users.tsv"
End Function
Function yaz()
yaz = yax() & "\settings.tsv"
End Function
Function yba()
Dim fso,usersFile,settingsFile
Set fso = CreateObject("Scripting.FileSystemObject")
yba = True
On Error Resume Next
usersFile = yay()
If Not fso.FileExists(usersFile) Then
Dim file
Set file = fso.CreateTextFile(usersFile, True, True)
file.WriteLine "ID" & vbTab & "Username" & vbTab & "PasswordHash" & vbTab & "Salt" & vbTab & "Role" & vbTab & "XORKey" & vbTab & "CreatedDate" & vbTab & "LastLogin"
file.Close
Set file = Nothing
End If
settingsFile = yaz()
If Not fso.FileExists(settingsFile) Then
Set file = fso.CreateTextFile(settingsFile, True, True)
file.WriteLine "UserID" & vbTab & "SettingsData" & vbTab & "UpdatedDate"
file.Close
Set file = Nothing
End If
If Err.Number <> 0 Then
MsgBox "Помилка створення TSV файлів: " & Err.Description, vbCritical
yba = False
End If
On Error GoTo 0
End Function
Function yau()
Dim fso,usersFile,file, line, fields
yau = False
If Not yba() Then Exit Function
Set fso = CreateObject("Scripting.FileSystemObject")
usersFile = yay()
On Error Resume Next
If fso.FileExists(usersFile) Then
Set file = fso.OpenTextFile(usersFile, 1, False, -1)
If Not file.AtEndOfStream Then
file.ReadLine
End If
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= 4 Then
If Trim(fields(4)) = "Administrator" Then
yau = True
Exit Do
End If
End If
End If
Loop
file.Close
Set file = Nothing
End If
On Error GoTo 0
End Function
Function yao(username)
Dim fso,usersFile,file, line, fields
yao = ""
If Not yba() Then Exit Function
Set fso = CreateObject("Scripting.FileSystemObject")
usersFile = yay()
On Error Resume Next
If fso.FileExists(usersFile) Then
Set file = fso.OpenTextFile(usersFile, 1, False, -1)
If Not file.AtEndOfStream Then
file.ReadLine
End If
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= 7 Then
If Trim(fields(1)) = username Then
yao = Trim(fields(0)) & "," & _
Trim(fields(2)) & "," & _
Trim(fields(3)) & "," & _
Trim(fields(4)) & "," & _
Trim(fields(5))
Exit Do
End If
End If
End If
Loop
file.Close
Set file = Nothing
End If
On Error GoTo 0
End Function
Function yap(username)
yap = (yao(username) <> "")
End Function
Function ybb()
Dim fso,usersFile,file, line, fields, maxID
maxID = 0
Set fso = CreateObject("Scripting.FileSystemObject")
usersFile = yay()
On Error Resume Next
If fso.FileExists(usersFile) Then
Set file = fso.OpenTextFile(usersFile, 1, False, -1)
If Not file.AtEndOfStream Then
file.ReadLine
End If
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= 0 Then
Dim currentID
currentID = CInt(Trim(fields(0)))
If currentID > maxID Then
maxID = currentID
End If
End If
End If
Loop
file.Close
Set file = Nothing
End If
ybb = maxID + 1
On Error GoTo 0
End Function
Sub yan(username, hash, salt, role, xorkey)
Dim fso,usersFile,file, userID, currentDate
If Not yba() Then Exit Sub
Set fso = CreateObject("Scripting.FileSystemObject")
usersFile = yay()
On Error Resume Next
userID = ybb()
currentDate = Now()
If role = "" Then role = "Guest"
If xorkey = "" Then xorkey = "-"
Set file = fso.OpenTextFile(usersFile, 8, True, -1)
file.WriteLine userID & vbTab & username & vbTab & hash & vbTab & salt & vbTab & role & vbTab & xorkey & vbTab & currentDate & vbTab & "-"
file.Close
Set file = Nothing
If Err.Number <> 0 Then
MsgBox "Помилка створення користувача: " & Err.Description, vbCritical
End If
On Error GoTo 0
End Sub
Sub yaq(username)
Dim fso,usersFile,tempFile, file, tempFilePath, line, fields, currentDate
If Not yba() Then Exit Sub
Set fso = CreateObject("Scripting.FileSystemObject")
usersFile = yay()
tempFilePath = yax() & "\users_temp.tsv"
currentDate = Now()
On Error Resume Next
If fso.FileExists(usersFile) Then
Set tempFile = fso.CreateTextFile(tempFilePath, True, True)
Set file = fso.OpenTextFile(usersFile, 1, False, -1)
If Not file.AtEndOfStream Then
tempFile.WriteLine file.ReadLine
End If
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= 7 Then
If Trim(fields(1)) = username Then
fields(7) = currentDate
End If
tempFile.WriteLine Join(fields, vbTab)
End If
End If
Loop
file.Close
tempFile.Close
Set file = Nothing
Set tempFile = Nothing
fso.DeleteFile usersFile
fso.MoveFile tempFilePath, usersFile
End If
On Error GoTo 0
End Sub
Function yar()
Dim fso,usersFile,file, line, fields, userList
yar = ""
If Not yba() Then Exit Function
Set fso = CreateObject("Scripting.FileSystemObject")
usersFile = yay()
userList = ""
On Error Resume Next
If fso.FileExists(usersFile) Then
Set file = fso.OpenTextFile(usersFile, 1, False, -1)
If Not file.AtEndOfStream Then
file.ReadLine
End If
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= 7 Then
If userList <> "" Then userList = userList & "|"
Dim lastLogin
lastLogin = Trim(fields(7))
If lastLogin = "-" Or lastLogin = "" Then
lastLogin = "Ніколи"
End If
userList = userList & Trim(fields(0)) & "," & _
Trim(fields(1)) & "," & _
Trim(fields(4)) & "," & _
lastLogin
End If
End If
Loop
file.Close
Set file = Nothing
yar = userList
End If
On Error GoTo 0
End Function
Sub yas(userID)
Dim fso,usersFile,tempFile, file, tempFilePath, line, fields
If Not yba() Then Exit Sub
If userID = 1 Then Exit Sub
Set fso = CreateObject("Scripting.FileSystemObject")
usersFile = yay()
tempFilePath = yax() & "\users_temp.tsv"
On Error Resume Next
If fso.FileExists(usersFile) Then
Set tempFile = fso.CreateTextFile(tempFilePath, True, True)
Set file = fso.OpenTextFile(usersFile, 1, False, -1)
If Not file.AtEndOfStream Then
tempFile.WriteLine file.ReadLine
End If
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= 0 Then
If CInt(Trim(fields(0))) <> CInt(userID) Then
tempFile.WriteLine line
End If
End If
End If
Loop
file.Close
tempFile.Close
Set file = Nothing
Set tempFile = Nothing
fso.DeleteFile usersFile
fso.MoveFile tempFilePath, usersFile
End If
On Error GoTo 0
End Sub
Sub yat(username, newHash, newSalt, newEncryptedXORKey)
Dim fso,usersFile,tempFile, file, tempFilePath, line, fields
If Not yba() Then Exit Sub
Set fso = CreateObject("Scripting.FileSystemObject")
usersFile = yay()
tempFilePath = yax() & "\users_temp.tsv"
On Error Resume Next
If fso.FileExists(usersFile) Then
Set tempFile = fso.CreateTextFile(tempFilePath, True, True)
Set file = fso.OpenTextFile(usersFile, 1, False, -1)
If Not file.AtEndOfStream Then
tempFile.WriteLine file.ReadLine
End If
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= 7 Then
If Trim(fields(1)) = username Then
fields(2) = newHash
fields(3) = newSalt
fields(5) = newEncryptedXORKey
End If
tempFile.WriteLine Join(fields, vbTab)
End If
End If
Loop
file.Close
tempFile.Close
Set file = Nothing
Set tempFile = Nothing
fso.DeleteFile usersFile
fso.MoveFile tempFilePath, usersFile
End If
If Err.Number <> 0 Then
MsgBox "Помилка зміни паролю з XOR: " & Err.Description, vbCritical
End If
On Error GoTo 0
End Sub
Function yaw()
Dim fso,file,content, path
Set fso = CreateObject("Scripting.FileSystemObject")
On Error Resume Next
path = yam()
If fso.FileExists(path) Then
Set file = fso.OpenTextFile(path, 1, False, 0)
content = file.ReadAll
file.Close
If Err.Number <> 0 Then
Err.Clear
Set file = fso.OpenTextFile(path, 1, False, -1)
content = file.ReadAll
file.Close
End If
content = Replace(content, vbCrLf, vbLf)
content = Replace(content, vbCr, vbLf)
yaw = content
Else
yaw = ""
End If
Set fso = Nothing
On Error GoTo 0
End Function
Function yav()
Dim fso,usersFile,userCount
yav = ""
userCount = 0
Set fso = CreateObject("Scripting.FileSystemObject")
usersFile = yay()
On Error Resume Next
If Not yba() Then
yav = "Помилка створення TSV файлів"
Exit Function
End If
If fso.FileExists(usersFile) Then
Dim file,line
Set file = fso.OpenTextFile(usersFile, 1, False, -1)
If Not file.AtEndOfStream Then
file.ReadLine
End If
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
userCount = userCount + 1
End If
Loop
file.Close
Set file = Nothing
yav = "TSV база працює. Користувачів: " & userCount
Else
yav = "TSV файли не знайдено"
End If
If Err.Number <> 0 Then
yav = "Помилка роботи з TSV: " & Err.Description
End If
On Error GoTo 0
End Function
Function ybf(userID)
Dim fso,settingsFile,file, line, fields
ybf = ""
Set fso = CreateObject("Scripting.FileSystemObject")
settingsFile = yaz()
On Error Resume Next
If fso.FileExists(settingsFile) Then
Set file = fso.OpenTextFile(settingsFile, 1, False, -1)
If Not file.AtEndOfStream Then
file.ReadLine
End If
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= 1 Then
If CInt(Trim(fields(0))) = CInt(userID) Then
ybf = Trim(fields(1))
Exit Do
End If
End If
End If
Loop
file.Close
Set file = Nothing
End If
On Error GoTo 0
End Function
Sub ybg(userID, settingsData)
Dim fso,settingsFile,tempFile, file, tempFilePath, line, fields, currentDate, userFound
Set fso = CreateObject("Scripting.FileSystemObject")
settingsFile = yaz()
tempFilePath = yax() & "\settings_temp.tsv"
currentDate = Now()
userFound = False
On Error Resume Next
If fso.FileExists(settingsFile) Then
Set tempFile = fso.CreateTextFile(tempFilePath, True, True)
Set file = fso.OpenTextFile(settingsFile, 1, False, -1)
If Not file.AtEndOfStream Then
tempFile.WriteLine file.ReadLine
End If
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= 1 Then
If CInt(Trim(fields(0))) = CInt(userID) Then
tempFile.WriteLine userID & vbTab & settingsData & vbTab & currentDate
userFound = True
Else
tempFile.WriteLine line
End If
End If
End If
Loop
If Not userFound Then
tempFile.WriteLine userID & vbTab & settingsData & vbTab & currentDate
End If
file.Close
tempFile.Close
Set file = Nothing
Set tempFile = Nothing
fso.DeleteFile settingsFile
fso.MoveFile tempFilePath, settingsFile
End If
If Err.Number <> 0 Then
MsgBox "Помилка збереження налаштувань: " & Err.Description, vbCritical
End If
On Error GoTo 0
End Sub
Function ybi(analysisDate, shift)
Dim fso,filePath,file, line, fields
ybi = ""
If Not ybr(analysisDate) Then Exit Function
Set fso = CreateObject("Scripting.FileSystemObject")
filePath = ybs(analysisDate)
On Error Resume Next
If fso.FileExists(filePath) Then
Set file = fso.OpenTextFile(filePath, 1, False, -1)
If Not file.AtEndOfStream Then file.ReadLine
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= 2 Then
If Trim(fields(0)) = analysisDate Then
If CInt(shift) = 1 Then
ybi = Trim(fields(1))
Else
ybi = Trim(fields(2))
End If
Exit Do
End If
End If
End If
Loop
file.Close
Set file = Nothing
End If
Set fso = Nothing
On Error GoTo 0
End Function
Function ybn(analysisDate, shift)
Dim fso,filePath,file, line, fields, userId, moderatorId
ybn = ""
If Not ybr(analysisDate) Then Exit Function
Set fso = CreateObject("Scripting.FileSystemObject")
filePath = ybs(analysisDate)
On Error Resume Next
If fso.FileExists(filePath) Then
Set file = fso.OpenTextFile(filePath, 1, False, -1)
If Not file.AtEndOfStream Then file.ReadLine
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= 11 Then
If Trim(fields(0)) = analysisDate Then
If CInt(shift) = 1 Then
verifiedData = Trim(fields(3))
userId = Trim(fields(6))
moderatorId = Trim(fields(10))
Else
verifiedData = Trim(fields(4))
userId = Trim(fields(8))
moderatorId = Trim(fields(12))
End If
ybn = verifiedData & "|||" & userId & "|||" & moderatorId
Exit Do
End If
End If
End If
Loop
file.Close
Set file = Nothing
End If
Set fso = Nothing
On Error GoTo 0
End Function
Sub ybp(analysisDate, encryptedProductionFlow, updatedDate, userID, shift)
Dim fso,filePath,tempFilePath, file, tempFile, line, fields, recordFound
If Not ybr(analysisDate) Then Exit Sub
Set fso = CreateObject("Scripting.FileSystemObject")
filePath = ybs(analysisDate)
tempFilePath = fso.GetParentFolderName(filePath) & "\prod_temp.tsv"
recordFound = False
On Error Resume Next
If fso.FileExists(filePath) Then
Set tempFile = fso.CreateTextFile(tempFilePath, True, True)
Set file = fso.OpenTextFile(filePath, 1, False, -1)
If Not file.AtEndOfStream Then tempFile.WriteLine file.ReadLine
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) < 12 Then
Dim tempFields(12), i
For i = 0 To UBound(fields) : tempFields(i) = fields(i) : Next
For i = UBound(fields) + 1 To 12 : tempFields(i) = "" : Next
fields = tempFields
End If
If UBound(fields) >= 12 Then
If Trim(fields(0)) = analysisDate Then
recordFound = True
If CInt(shift) = 1 Then
fields(1) = encryptedProductionFlow
fields(5) = updatedDate
fields(6) = userID
Else
fields(2) = encryptedProductionFlow
fields(7) = updatedDate
fields(8) = userID
End If
tempFile.WriteLine Join(fields, vbTab)
Else
tempFile.WriteLine line
End If
End If
End If
Loop
If Not recordFound Then
Dim newFields(12), j
For j = 0 To 12 : newFields(j) = "" : Next
newFields(0) = analysisDate
If CInt(shift) = 1 Then
newFields(1) = encryptedProductionFlow
newFields(5) = updatedDate
newFields(6) = userID
Else
newFields(2) = encryptedProductionFlow
newFields(7) = updatedDate
newFields(8) = userID
End If
tempFile.WriteLine Join(newFields, vbTab)
End If
file.Close
tempFile.Close
Set file = Nothing
Set tempFile = Nothing
fso.DeleteFile filePath, True
fso.MoveFile tempFilePath, filePath
End If
If Err.Number <> 0 Then
MsgBox "Помилка збереження ProductionFlow: " & Err.Description, vbCritical
End If
Set fso = Nothing
On Error GoTo 0
End Sub
Function ybj()
Dim fso,allFiles,filePath, file, line, recordCount
ybj = ""
recordCount = 0
Set fso = CreateObject("Scripting.FileSystemObject")
On Error Resume Next
allFiles = ybk()
If IsNull(allFiles) Then
ybj = "ProductionFlowDB працює. Записів: 0"
Exit Function
End If
For Each filePath In allFiles
If fso.FileExists(filePath) Then
Set file = fso.OpenTextFile(filePath, 1, False, -1)
If Not file.AtEndOfStream Then file.ReadLine
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then recordCount = recordCount + 1
Loop
file.Close
Set file = Nothing
End If
Next
If Err.Number <> 0 Then
ybj = "Помилка роботи з ProductionFlowDB: " & Err.Description
Else
ybj = "ProductionFlowDB працює. Записів: " & recordCount
End If
Set fso = Nothing
On Error GoTo 0
End Function
Sub ybo(analysisDate, encryptedVerifiedData, updatedDate, moderatorID, shift)
Dim fso,filePath,tempFilePath, file, tempFile, line, fields, recordFound
If Not ybr(analysisDate) Then Exit Sub
Set fso = CreateObject("Scripting.FileSystemObject")
filePath = ybs(analysisDate)
tempFilePath = fso.GetParentFolderName(filePath) & "\verified_temp.tsv"
recordFound = False
On Error Resume Next
If fso.FileExists(filePath) Then
Set tempFile = fso.CreateTextFile(tempFilePath, True, True)
Set file = fso.OpenTextFile(filePath, 1, False, -1)
If Not file.AtEndOfStream Then tempFile.WriteLine file.ReadLine
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) < 12 Then
Dim tempFields(12), i
For i = 0 To UBound(fields) : tempFields(i) = fields(i) : Next
For i = UBound(fields) + 1 To 12 : tempFields(i) = "" : Next
fields = tempFields
End If
If UBound(fields) >= 12 Then
If Trim(fields(0)) = analysisDate Then
recordFound = True
If CInt(shift) = 1 Then
fields(3) = encryptedVerifiedData
fields(9) = updatedDate
fields(10) = moderatorID
Else
fields(4) = encryptedVerifiedData
fields(11) = updatedDate
fields(12) = moderatorID
End If
tempFile.WriteLine Join(fields, vbTab)
Else
tempFile.WriteLine line
End If
End If
End If
Loop
If Not recordFound Then
Dim newFields(12), j
For j = 0 To 12 : newFields(j) = "" : Next
newFields(0) = analysisDate
If CInt(shift) = 1 Then
newFields(3) = encryptedVerifiedData
newFields(9) = updatedDate
newFields(10) = moderatorID
Else
newFields(4) = encryptedVerifiedData
newFields(11) = updatedDate
newFields(12) = moderatorID
End If
tempFile.WriteLine Join(newFields, vbTab)
End If
file.Close
tempFile.Close
Set file = Nothing
Set tempFile = Nothing
fso.DeleteFile filePath, True
fso.MoveFile tempFilePath, filePath
End If
If Err.Number <> 0 Then
MsgBox "Помилка збереження VerifiedProductionFlow: " & Err.Description, vbCritical
End If
Set fso = Nothing
On Error GoTo 0
End Sub
Function ybt(baseColumnName)
Dim fso,allFiles,filePath, file, line, fields, datesWithData, dateValue, formattedDate
Dim colIndex1,colIndex2,separator
datesWithData = ""
separator = ","
Set fso = CreateObject("Scripting.FileSystemObject")
Select Case LCase(baseColumnName)
Case "pfupdateddate" : colIndex1 = 5 : colIndex2 = 7
Case "vpfupdateddate" : colIndex1 = 9 : colIndex2 = 11
Case Else : ybt = "" : Exit Function
End Select
allFiles = ybk()
On Error Resume Next
If IsArray(allFiles) Then
For Each filePath In allFiles
If fso.FileExists(filePath) Then
Set file = fso.OpenTextFile(filePath, 1, False, -1)
If Not file.AtEndOfStream Then file.ReadLine
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= colIndex2 And (Trim(fields(colIndex1)) <> "" Or Trim(fields(colIndex2)) <> "") Then
dateValue = Trim(fields(0))
Dim dateParts,y,m, d
dateParts = Split(dateValue, "-")
If UBound(dateParts) = 2 Then
y = CStr(dateParts(0)): m = CStr(dateParts(1)): d = CStr(dateParts(2))
If Len(m) = 1 Then m = "0" & m
If Len(d) = 1 Then d = "0" & d
formattedDate = y & "-" & m & "-" & d
If InStr(separator & datesWithData & separator, separator & formattedDate & separator) = 0 Then
If datesWithData <> "" Then datesWithData = datesWithData & separator
datesWithData = datesWithData & formattedDate
End If
End If
End If
End If
Loop
file.Close
End If
Next
End If
If Err.Number <> 0 Then ybt = "Error: " & Err.Description Else ybt = datesWithData
On Error GoTo 0
End Function
Function ybu()
Dim fso,allFiles,filePath, file, line, fields, unverifiedList, separator
unverifiedList = ""
separator = "|"
Set fso = CreateObject("Scripting.FileSystemObject")
On Error Resume Next
allFiles = ybk()
If IsArray(allFiles) Then
For Each filePath In allFiles
If fso.FileExists(filePath) Then
Set file = fso.OpenTextFile(filePath, 1, False, -1)
If Not file.AtEndOfStream Then file.ReadLine
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= 11 Then
Dim dateValue
dateValue = Trim(fields(0))
If Trim(fields(1)) <> "" And Trim(fields(9)) = "" Then
If unverifiedList <> "" Then unverifiedList = unverifiedList & separator
unverifiedList = unverifiedList & dateValue & " (Зміна 1)"
End If
If Trim(fields(2)) <> "" And Trim(fields(11)) = "" Then
If unverifiedList <> "" Then unverifiedList = unverifiedList & separator
unverifiedList = unverifiedList & dateValue & " (Зміна 2)"
End If
End If
End If
Loop
file.Close
Set file = Nothing
End If
Next
End If
ybu = unverifiedList
Set fso = Nothing
On Error GoTo 0
End Function
Function ybl()
Dim fso,allFiles,filePath, file, line, fields, allData, rowSeparator
allData = ""
rowSeparator = "|||ROW|||"
Set fso = CreateObject("Scripting.FileSystemObject")
On Error Resume Next
allFiles = ybk()
If Not IsNull(allFiles) Then
For Each filePath In allFiles
If fso.FileExists(filePath) Then
Set file = fso.OpenTextFile(filePath, 1, False, -1)
If Not file.AtEndOfStream Then file.ReadLine
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= 2 Then
Dim dateValue
dateValue = Trim(fields(0))
If Trim(fields(1)) <> "" Then
If allData <> "" Then allData = allData & rowSeparator
allData = allData & dateValue & "|||1|||" & Trim(fields(1))
End If
If Trim(fields(2)) <> "" Then
If allData <> "" Then allData = allData & rowSeparator
allData = allData & dateValue & "|||2|||" & Trim(fields(2))
End If
End If
End If
Loop
file.Close
Set file = Nothing
End If
Next
End If
ybl = allData
Set fso = Nothing
On Error GoTo 0
End Function
Function ybm()
Dim fso,allFiles,filePath, file, line, fields, allData, rowSeparator
allData = ""
rowSeparator = "|||ROW|||"
Set fso = CreateObject("Scripting.FileSystemObject")
On Error Resume Next
allFiles = ybk()
If Not IsNull(allFiles) Then
For Each filePath In allFiles
If fso.FileExists(filePath) Then
Set file = fso.OpenTextFile(filePath, 1, False, -1)
If Not file.AtEndOfStream Then file.ReadLine
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= 12 Then
Dim dateValue
dateValue = Trim(fields(0))
If Trim(fields(9)) <> "" And Trim(fields(3)) <> "" Then
If allData <> "" Then allData = allData & rowSeparator
allData = allData & dateValue & "|||" & Trim(fields(3)) & "|||" & Trim(fields(6)) & "|||" & Trim(fields(10))
End If
If Trim(fields(11)) <> "" And Trim(fields(4)) <> "" Then
If allData <> "" Then allData = allData & rowSeparator
allData = allData & dateValue & "|||" & Trim(fields(4)) & "|||" & Trim(fields(8)) & "|||" & Trim(fields(12))
End If
End If
End If
Loop
file.Close
Set file = Nothing
End If
Next
End If
ybm = allData
Set fso = Nothing
On Error GoTo 0
End Function
Function ybv()
ybv = yax() & "\ProductionFlowDB\index.tsv"
End Function
Sub UpdateIndexFile(key, filePath)
On Error Resume Next
Dim fso,indexFile
Set fso = CreateObject("Scripting.FileSystemObject")
Set indexFile = fso.OpenTextFile(ybv(), 8, True, -1)
indexFile.WriteLine key & vbTab & filePath
indexFile.Close
Set fso = Nothing
On Error GoTo 0
End Sub
Function ybw()
On Error Resume Next
Dim fso,indexFile,dict, line, parts
Set fso = CreateObject("Scripting.FileSystemObject")
Set dict = CreateObject("Scripting.Dictionary")
If fso.FileExists(ybv()) Then
Set indexFile = fso.OpenTextFile(ybv(), 1, False, -1)
Do Until indexFile.AtEndOfStream
line = Trim(indexFile.ReadLine())
If line <> "" Then
parts = Split(line, vbTab)
If UBound(parts) = 1 Then
If Not dict.Exists(Trim(parts(0))) Then
dict.Add Trim(parts(0)), Trim(parts(1))
End If
End If
End If
Loop
indexFile.Close
End If
Set ybw = dict
Set fso = Nothing
On Error GoTo 0
End Function
Function ybs(theDate)
On Error Resume Next
Dim yearPart,monthPart,dbFolder, filePath, fso
Set fso = CreateObject("Scripting.FileSystemObject")
yearPart = Year(theDate)
monthPart = Month(theDate)
If monthPart < 10 Then monthPart = "0" & monthPart
dbFolder = yax() & "\ProductionFlowDB"
filePath = dbFolder & "\" & yearPart & "\" & monthPart & ".tsv"
ybs = filePath
On Error GoTo 0
End Function
Function ybr(theDate)
On Error Resume Next
ybr = True
Dim fso,filePath,yearFolderPath, dbFolderPath, indexDict, dateKey, relativePath
Set fso = CreateObject("Scripting.FileSystemObject")
filePath = ybs(theDate)
Dim yearPart,monthPart
yearPart = Year(theDate)
monthPart = Right("0" & Month(theDate), 2)
dateKey = yearPart & "-" & monthPart
relativePath = yearPart & "\" & monthPart & ".tsv"
Set indexDict = ybw()
If indexDict.Exists(dateKey) Then
Set fso = Nothing
Set indexDict = Nothing
Exit Function
End If
yearFolderPath = fso.GetParentFolderName(filePath)
dbFolderPath = fso.GetParentFolderName(yearFolderPath)
If Not fso.FolderExists(dbFolderPath) Then fso.CreateFolder dbFolderPath
If Not fso.FolderExists(yearFolderPath) Then fso.CreateFolder yearFolderPath
If Not fso.FileExists(filePath) Then
Dim file
Set file = fso.CreateTextFile(filePath, True, True)
file.WriteLine "Date" & vbTab & "ProductionFlow_1" & vbTab & "ProductionFlow_2" & vbTab & "VerifiedProductionFlow_1" & vbTab & "VerifiedProductionFlow_2" & vbTab & "PFUpdatedDate_1" & vbTab & "User_1" & vbTab & "PFUpdatedDate_2" & vbTab & "User_2" & vbTab & "VPFUpdatedDate_1" & vbTab & "Moderator_1" & vbTab & "VPFUpdatedDate_2" & vbTab & "Moderator_2"
file.Close
Set file = Nothing
Call UpdateIndexFile(dateKey, relativePath)
End If
If Err.Number <> 0 Then
MsgBox "Помилка створення файлу ProductionFlowDB: " & Err.Description, vbCritical
ybr = False
End If
Set fso = Nothing
Set indexDict = Nothing
On Error GoTo 0
End Function
Function ybk()
On Error Resume Next
Dim fso,mainFolder,yearFolders, yearFolder, monthFiles, monthFile, fileListStr, separator
Set fso = CreateObject("Scripting.FileSystemObject")
fileListStr = ""
separator = "|"
mainFolder = yax() & "\ProductionFlowDB"
If fso.FolderExists(mainFolder) Then
Set yearFolders = fso.GetFolder(mainFolder).SubFolders
For Each yearFolder In yearFolders
Set monthFiles = yearFolder.Files
For Each monthFile In monthFiles
If LCase(fso.GetExtensionName(monthFile.Name)) = "tsv" Then
If fileListStr <> "" Then fileListStr = fileListStr & separator
fileListStr = fileListStr & monthFile.Path
End If
Next
Next
End If
ybk = Split(fileListStr, separator)
On Error GoTo 0
End Function
Function ybx(analysisDate, shift)
Dim fso,filePath,file, line, fields, columnIndex
ybx = False
Set fso = CreateObject("Scripting.FileSystemObject")
filePath = ybs(analysisDate)
If CInt(shift) = 1 Then
columnIndex = 9
Else
columnIndex = 11
End If
On Error Resume Next
If fso.FileExists(filePath) Then
Set file = fso.OpenTextFile(filePath, 1, False, -1)
If Not file.AtEndOfStream Then file.ReadLine
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= columnIndex Then
If Trim(fields(0)) = analysisDate Then
If Trim(fields(columnIndex)) <> "" Then
ybx = True
End If
Exit Do
End If
End If
End If
Loop
file.Close
Set file = Nothing
End If
Set fso = Nothing
On Error GoTo 0
End Function
Sub Window_OnLoad
Call yu()
Dim dbTest
dbTest = yav()
If Not yau() Then
Call yk()
Else
Call ym()
document.getElementById("username").focus
End If
End Sub
</script>

<style>
* {
  box-sizing: border-box
}
html {
  height: 100%;
  font-size: 100%;
  margin: 0;
  padding: 0;
  -webkit-text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
  overflow: hidden
}
body {
  margin: 0;
  padding: 0;
  border: none;
  font-family: "Segoe UI",Arial,sans-serif;
  font-size: 16px;
  line-height: 1.4;
  color: #424242;
  background-color: #f5f5f5;
  width: 100%;
  height: 100%;
  overflow: hidden
}
h1,
h2,
h3,
h4,
h5,
h6 {
  margin: 0;
  padding: 0
}
ol,
ul {
  margin: 0;
  padding: 0;
  list-style: none
}
input,
select,
textarea {
  font-family: inherit;
  font-size: inherit;
  margin: 0;
  padding: 0;
  border: none;
  background: 0 0
}
img {
  display: block;
  max-width: 100%;
  width: 100%;
  height: auto;
  border: none
}
table {
  border-spacing: 0;
  width: 100%;
  border-collapse: collapse;
  margin-top: 16px
}
td,
th {
  padding: 0;
  margin: 0;
  text-align: left
}
fieldset {
  border: none;
  margin: 0;
  padding: 0
}
legend {
  padding: 0;
  margin: 0
}
#adminSetupForm,
#changePasswordForm,
#createUserForm,
#deleteUserForm,
#loginForm,
#myXORKeyForm,
#registerForm,
#secureContent,
#usersListForm {
  display: none
}
h1 {
  text-align: center;
  color: #334155;
  font-size: 28px;
  font-weight: 700;
  margin-bottom: 36px
}
h2 {
  color: #334155;
  font-size: 24px;
  font-weight: 700;
  margin-bottom: 24px
}
h3 {
  color: #334155;
  font-size: 20px;
  font-weight: 600;
  margin-bottom: 16px;
  margin-top: 0
}
h4 {
  color: #424242;
  font-size: 18px;
  font-weight: 600;
  margin-bottom: 16px
}
h5 {
  color: #424242;
  font-size: 16px;
  font-weight: 600;
  margin-bottom: 8px
}
h6 {
  color: #757575;
  font-size: 14px;
  font-weight: 600;
  margin-bottom: 8px
}
p {
  margin: 0 0 16px;
  padding: 0;
  font-size: 16px;
  line-height: 1.5;
  color: #424242
}
p:last-child {
  margin-bottom: 0
}
a {
  color: #3498db;
  text-decoration: none;
  cursor: pointer;
  -webkit-transition: color .3s;
  -moz-transition: color .3s;
  -o-transition: color .3s;
  transition: color .3s
}
a:hover {
  color: #2980b9;
  text-decoration: underline
}
a:focus {
  outline: #3498db solid 2px;
  outline-offset: 2px
}
label {
  display: block;
  margin-bottom: 8px;
  font-weight: 600;
  color: #757575;
  font-size: 16px
}
.success-message {
  text-align: center;
  font-size: 18px;
  color: #22c55e;
  font-weight: 600;
  margin-top: 24px
}
.info-note {
  font-size: 12px;
  color: #9e9e9e;
  margin-top: 8px;
  text-align: center
}
.security-info {
  background: #f5f5f5;
  padding: 16px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  margin-top: 16px;
  font-size: 13px;
  color: #757575;
  line-height: 1.5
}
.security-info strong {
  color: #424242;
  font-weight: 700
}
.form-toggle {
  text-align: center;
  margin-top: 24px
}
.form-toggle a {
  color: #3498db;
  font-weight: 600
}
.form-toggle a:hover {
  text-decoration: underline
}
.text-center {
  text-align: center
}
.text-left {
  text-align: left
}
.text-right {
  text-align: right
}
.text-muted {
  color: #9e9e9e
}
.text-primary {
  color: #3498db
}
.text-success {
  color: #22c55e
}
.text-danger {
  color: #ef4444
}
.text-warning {
  color: #f59e0b
}
.font-weight-normal {
  font-weight: 400
}
.font-weight-bold {
  font-weight: 700
}
.font-size-small {
  font-size: 12px
}
.font-size-large {
  font-size: 18px
}
.promo-box {
  max-width: 35vw;
  width: 35vw;
  margin: 0;
  border: none;
  overflow: hidden;
  position: absolute;
  top: 50%;
  left: 30%;
  transform: translate(-50%,-50%);
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: flex-start;
  -webkit-justify-content: flex-start;
  justify-content: flex-start;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
  z-index: 1
}
@media screen and (max-width:768px) {
  .promo-box {
    position: absolute;
    top: 50%;
    left: 20%;
    transform: translate(-50%,-50%)
  }
}
.promo-box__footer {
  position: absolute;
  top: 96%;
  left: 50%;
  transform: translate(-50%,-50%);
  font-size: 8px;
  color: #000;
  z-index: 1
}
.promo-box__footer-text {
  font-size: 12px
}
.logo__icon {
  max-width: 12.783vw;
  width: 12.783vw
}
@media screen and (max-width:648px) {
  .logo__icon {
    display: none
  }
}
.logo__text {
  max-width: 20.37vw;
  width: 20.37vw;
  margin-left: -1.71vw;
  margin-bottom: -.1vw;
  text-align: center
}
@media screen and (max-width:1024px) {
  .logo__text {
    display: none
  }
}
@media print {
  .promo-box {
    display: none!important
  }
}
button {
  background: 0 0;
  margin: 0;
  font-family: inherit;
  border: none;
  padding: 16px 24px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 600;
  width: 100%;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  background: -ms-linear-gradient(top,#3498db,#2980b9);
  background: -webkit-linear-gradient(135deg,#3498db,#2980b9);
  background: linear-gradient(135deg,#3498db,#2980b9);
  color: #fff
}
button:focus,
button:hover {
  background: -ms-linear-gradient(top,#2980b9,#1f618d);
  background: -webkit-linear-gradient(135deg,#2980b9,#1f618d);
  background: linear-gradient(135deg,#2980b9,#1f618d);
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.secondary-btn {
  border: 2px solid #3498db;
  padding: 16px 24px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 600;
  width: 100%;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  background: 0 0;
  color: #3498db;
  margin-top: 16px
}
.secondary-btn:focus,
.secondary-btn:hover {
  background: #e3f2fd;
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.back-button {
  border: none;
  padding: 16px 24px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 600;
  width: 100%;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  background: #9e9e9e;
  color: #fff;
  margin-top: 10px;
  font-size: 24px;
  line-height: 1
}
.back-button:hover {
  background: #757575;
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.back-button--journal {
  width: 36px;
  padding: 8px;
  margin-top: 0
}
.danger-button {
  border: none;
  padding: 16px 24px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 600;
  width: 100%;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  background: #ef4444;
  color: #fff
}
.danger-button:focus,
.danger-button:hover {
  background: #dc2626;
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.menu-button {
  border: none;
  padding: 12px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 4px;
  border-radius: 4px;
  cursor: pointer;
  font-weight: 600;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  display: block;
  width: 100%;
  margin-bottom: 10px;
  background: #3498db;
  color: #fff;
  -webkit-border-radius: 4px;
  font-size: 14px
}
.menu-button:hover {
  background: #2980b9;
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.button-group {
  display: block
}
.button-group .button {
  margin-bottom: 10px
}
.button-group .button:last-child {
  margin-bottom: 0
}
.btn-small {
  padding: 8px 16px;
  font-size: 12px
}
.btn-large {
  padding: 24px 36px;
  font-size: 18px
}
.btn-disabled {
  opacity: .6;
  cursor: not-allowed
}
.btn-disabled:hover {
  -webkit-transform: none;
  -ms-transform: none;
  transform: none
}
.btn-loading {
  position: relative;
  color: transparent
}
.btn-loading:after {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  width: 16px;
  height: 16px;
  margin-top: -8px;
  margin-left: -8px;
  border: 2px solid transparent;
  border-top: 2px solid #fff;
  -webkit-border-radius: 50%;
  -moz-border-radius: 50%;
  border-radius: 50%;
  animation: 1s linear infinite spin
}
@keyframes spin {
  0% {
    -webkit-transform: rotate(0);
    -ms-transform: rotate(0);
    transform: rotate(0)
  }
  100% {
    -webkit-transform: rotate(360deg);
    -ms-transform: rotate(360deg);
    transform: rotate(360deg)
  }
}
.btn-icon {
  position: relative
}
.btn-icon:before {
  content: "";
  display: inline-block;
  width: 16px;
  height: 16px;
  margin-right: 8px;
  vertical-align: middle
}
.btn-icon-only {
  width: auto;
  min-width: 44px;
  height: 44px;
  padding: 10px
}
.btn-icon-only:before {
  margin-right: 0
}
.btn-success {
  border: none;
  padding: 16px 24px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 600;
  width: 100%;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  background: #22c55e;
  color: #fff
}
.btn-success:hover {
  background: #1a9a49;
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.btn-warning {
  border: none;
  padding: 16px 24px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 600;
  width: 100%;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  background: #f59e0b;
  color: #fff
}
.btn-warning:hover {
  background: #c57f08;
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.btn-info {
  border: none;
  padding: 16px 24px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 600;
  width: 100%;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  background: #3498db;
  color: #fff
}
.btn-info:hover {
  background: #217dbb;
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.btn-light {
  border: none;
  padding: 16px 24px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 600;
  width: 100%;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  background: #f5f5f5;
  color: #424242
}
.btn-light:hover {
  background: #dcdcdc;
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.btn-outline-primary {
  border: 2px solid #3498db;
  padding: 16px 24px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 600;
  width: 100%;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  background: 0 0;
  color: #3498db
}
.btn-outline-primary:hover {
  background: #3498db;
  color: #fff;
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.btn-outline-secondary {
  border: 2px solid #334155;
  padding: 16px 24px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 600;
  width: 100%;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  background: 0 0;
  color: #334155
}
.btn-outline-secondary:hover {
  background: #334155;
  color: #fff;
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.btn-outline-danger {
  border: 2px solid #ef4444;
  padding: 16px 24px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 600;
  width: 100%;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  background: 0 0;
  color: #ef4444
}
.btn-outline-danger:hover {
  background: #ef4444;
  color: #fff;
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.wrapper {
  min-width: 100vw;
  width: 100%;
  min-height: 100vh;
  max-height: 100vh;
  overflow-y: auto
}
@media screen and (max-height:768px) {
  .wrapper {
    padding-right: 8vw;
    padding-top: 8vh;
    display: -ms-flexbox;
    display: -webkit-flex;
    display: flex;
    -ms-flex-direction: row;
    -webkit-flex-direction: row;
    flex-direction: row;
    -ms-flex-wrap: nowrap;
    -webkit-flex-wrap: nowrap;
    flex-wrap: nowrap;
    -ms-flex-pack: flex-end;
    -webkit-justify-content: flex-end;
    justify-content: flex-end;
    -ms-flex-align: flex-start;
    -webkit-align-items: flex-start;
    align-items: flex-start
  }
}
.containerForm {
  background-color: rgba(255,255,255,.95);
  -webkit-border-radius: 12px;
  -moz-border-radius: 12px;
  border-radius: 12px;
  -webkit-box-shadow: 0 10px 15px rgba(0,0,0,.1);
  -moz-box-shadow: 0 10px 15px rgba(0,0,0,.1);
  box-shadow: 0 10px 15px rgba(0,0,0,.1);
  padding: 36px;
  max-width: 90%;
  width: 480px
}
@media screen and (min-height:768px) {
  .containerForm {
    position: absolute;
    top: 50%;
    left: 70%;
    transform: translate(-50%,-50%);
    z-index: 1
  }
}
#loginForm {
  min-height: 450px
}
#adminSetupForm {
  min-height: 645px
}
#myXORKeyForm,
#secureContent,
#usersListForm {
  min-height: 768px
}
#createUserForm {
  min-height: 720px
}
#changePasswordForm {
  min-height: 740px
}
.form-group {
  margin-bottom: 24px
}
.form-group:last-child {
  margin-bottom: 0
}
.form-row {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: space-between;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  -ms-flex-align: flex-start;
  -webkit-align-items: flex-start;
  align-items: flex-start;
  margin-bottom: 24px
}
.form-row .form-group {
  flex: 1;
  margin-bottom: 0
}
.form-row .form-group:not(:last-child) {
  margin-right: 16px
}
input[type=date],
input[type=email],
input[type=number],
input[type=password],
input[type=tel],
input[type=text],
input[type=url] {
  width: 100%;
  padding: 8px;
  border: 2px solid #e0e0e0;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  font-size: 16px;
  box-sizing: border-box;
  -webkit-transition: border-color .3s;
  -moz-transition: border-color .3s;
  -o-transition: border-color .3s;
  transition: border-color .3s
}
input[type=date]:focus,
input[type=email]:focus,
input[type=number]:focus,
input[type=password]:focus,
input[type=tel]:focus,
input[type=text]:focus,
input[type=url]:focus,
select:focus,
textarea:focus {
  border-color: #3498db;
  outline: 0;
  -webkit-box-shadow: 0 0 0 3px rgba(52,152,219,.25);
  -moz-box-shadow: 0 0 0 3px rgba(52,152,219,.25);
  box-shadow: 0 0 0 3px rgba(52,152,219,.25)
}
input[type=date]:hover,
input[type=email]:hover,
input[type=number]:hover,
input[type=password]:hover,
input[type=tel]:hover,
input[type=text]:hover,
input[type=url]:hover,
textarea:hover {
  border-color: #bdbdbd
}
input[type=date]:disabled,
input[type=email]:disabled,
input[type=number]:disabled,
input[type=password]:disabled,
input[type=tel]:disabled,
input[type=text]:disabled,
input[type=url]:disabled,
select:disabled,
textarea:disabled {
  background-color: #f5f5f5;
  color: #bdbdbd;
  border-color: #e0e0e0;
  cursor: not-allowed
}
textarea {
  width: 100%;
  padding: 8px;
  border: 2px solid #e0e0e0;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  box-sizing: border-box;
  -webkit-transition: border-color .3s;
  -moz-transition: border-color .3s;
  -o-transition: border-color .3s;
  transition: border-color .3s;
  resize: vertical;
  min-height: 80px;
  font-family: monospace;
  font-size: 12px;
  line-height: 1.4
}
select {
  width: 100%;
  padding: 8px 40px 8px 8px;
  border: 2px solid #e0e0e0;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  font-size: 16px;
  box-sizing: border-box;
  -webkit-transition: border-color .3s;
  -moz-transition: border-color .3s;
  -o-transition: border-color .3s;
  transition: border-color .3s;
  background-image: url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 4 5'%3E%3Cpath fill='%23666' d='M2 0L0 2h4zm0 5L0 3h4z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 12px center;
  background-size: 12px;
  cursor: pointer
}
select:hover {
  border-color: #bdbdbd;
  background-color: #e3f2fd
}
select::-ms-expand {
  display: none
}
.form-check {
  display: block;
  margin-bottom: 16px
}
.form-check input[type=checkbox],
.form-check input[type=radio] {
  width: auto;
  margin-right: 8px;
  vertical-align: middle
}
.form-check label {
  display: inline-block;
  margin-bottom: 0;
  font-weight: 400;
  cursor: pointer
}
.form-check-inline {
  display: inline-block;
  margin-right: 24px;
  margin-bottom: 0
}
.form-group.has-success input,
.form-group.has-success select,
.form-group.has-success textarea {
  border-color: #22c55e
}
.form-group.has-success input:focus,
.form-group.has-success select:focus,
.form-group.has-success textarea:focus {
  border-color: #22c55e;
  -webkit-box-shadow: 0 0 0 3px rgba(34,197,94,.25);
  -moz-box-shadow: 0 0 0 3px rgba(34,197,94,.25);
  box-shadow: 0 0 0 3px rgba(34,197,94,.25)
}
.form-group.has-error input,
.form-group.has-error select,
.form-group.has-error textarea {
  border-color: #ef4444
}
.form-group.has-error input:focus,
.form-group.has-error select:focus,
.form-group.has-error textarea:focus {
  border-color: #ef4444;
  -webkit-box-shadow: 0 0 0 3px rgba(239,68,68,.25);
  -moz-box-shadow: 0 0 0 3px rgba(239,68,68,.25);
  box-shadow: 0 0 0 3px rgba(239,68,68,.25)
}
.form-group.has-warning input,
.form-group.has-warning select,
.form-group.has-warning textarea {
  border-color: #f59e0b
}
.form-group.has-warning input:focus,
.form-group.has-warning select:focus,
.form-group.has-warning textarea:focus {
  border-color: #f59e0b;
  -webkit-box-shadow: 0 0 0 3px rgba(245,158,11,.25);
  -moz-box-shadow: 0 0 0 3px rgba(245,158,11,.25);
  box-shadow: 0 0 0 3px rgba(245,158,11,.25)
}
.form-feedback {
  display: block;
  margin-top: 8px;
  font-size: 12px
}
.form-feedback.valid-feedback {
  color: #22c55e
}
.form-feedback.invalid-feedback {
  color: #ef4444
}
.form-feedback.warning-feedback {
  color: #f59e0b
}
.password-wrapper {
  position: relative
}
.password-wrapper input[type=password],
.password-wrapper input[type=text] {
  padding-right: 40px
}
.password-toggle-icon {
  position: absolute;
  top: 50%;
  right: 12px;
  transform: translateY(-50%);
  cursor: pointer;
  user-select: none;
  color: #9e9e9e;
  font-size: 20px;
  transition: color .2s
}
.password-toggle-icon:hover {
  color: #424242
}
.menu {
  background: #f5f5f5;
  padding: 24px;
  -webkit-border-radius: 8px;
  -moz-border-radius: 8px;
  border-radius: 8px;
  margin-top: 16px
}
.menu h3 {
  margin-top: 0;
  color: #334155;
  margin-bottom: 16px
}
.role-badge.Administrator {
  background: #dcfce7;
  color: #b45309;
  padding: 4px 8px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px;
  font-size: 16px;
  font-weight: 700;
  font-family: "Lucida Sans Unicode","Lucida Grande",sans-serif;
  letter-spacing: .75px
}
.role-badge.Moderator {
  background: #dcfce7;
  color: #15803d;
  padding: 4px 8px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px;
  font-size: 16px;
  font-weight: 700;
  font-family: "Lucida Sans Unicode","Lucida Grande",sans-serif;
  letter-spacing: .75px
}
.role-badge.User {
  background: #dcfce7;
  color: #3498db;
  padding: 4px 8px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px;
  font-size: 16px;
  font-weight: 700;
  font-family: "Lucida Sans Unicode","Lucida Grande",sans-serif;
  letter-spacing: .75px
}
.role-badge.Guest {
  background: #dcfce7;
  color: #424242;
  padding: 4px 8px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px;
  font-size: 16px;
  font-weight: 700;
  font-family: "Lucida Sans Unicode","Lucida Grande",sans-serif;
  letter-spacing: .75px
}
.role-badge.Auditor {
  background: #dcfce7;
  color: #0d47a1;
  padding: 4px 8px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px;
  font-size: 16px;
  font-weight: 700;
  font-family: "Lucida Sans Unicode","Lucida Grande",sans-serif;
  letter-spacing: .75px
}
table td,
table th {
  padding: 8px;
  text-align: left;
  border: 1px solid #e0e0e0
}
table th {
  background-color: #eee;
  font-weight: 700;
  position: sticky;
  top: 0;
  z-index: 10
}
table tr:nth-child(2n) {
  background-color: #fafafa
}
table tr:hover {
  background-color: #e3f2fd
}
table th.sortable {
  cursor: pointer;
  user-select: none
}
table th.sortable:hover {
  background-color: #bdbdbd
}
table th.sortable:after {
  content: " ↕";
  color: #9e9e9e;
  font-size: 12px
}
table th.sortable.sort-asc:after {
  content: " ↑";
  color: #3498db
}
table th.sortable.sort-desc:after {
  content: " ↓";
  color: #3498db
}
table td {
  vertical-align: middle
}
table td.text-center {
  text-align: center
}
table td.text-right {
  text-align: right
}
table td.actions {
  white-space: nowrap;
  width: 1%
}
.stats-grid {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: wrap;
  -webkit-flex-wrap: wrap;
  flex-wrap: wrap;
  -ms-flex-pack: space-between;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  -ms-flex-align: stretch;
  -webkit-align-items: stretch;
  align-items: stretch;
  margin-bottom: 24px;
  gap: 16px
}
.stat-card {
  flex: 1;
  min-width: 200px;
  background: #fff;
  padding: 24px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  -webkit-box-shadow: 0 1px 3px rgba(0,0,0,.1);
  -moz-box-shadow: 0 1px 3px rgba(0,0,0,.1);
  box-shadow: 0 1px 3px rgba(0,0,0,.1);
  text-align: center
}
.stat-card .stat-number {
  font-size: 32px;
  font-weight: 700;
  color: #3498db;
  margin-bottom: 8px
}
.stat-card .stat-label {
  color: #9e9e9e;
  font-size: 12px;
  text-transform: uppercase;
  letter-spacing: 1px
}
.stat-card.stat-success .stat-number {
  color: #22c55e
}
.stat-card.stat-warning .stat-number {
  color: #f59e0b
}
.stat-card.stat-danger .stat-number {
  color: #ef4444
}
.alert {
  padding: 16px;
  margin-bottom: 16px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  border: 1px solid transparent
}
.alert.alert-success {
  color: #16a34a;
  background-color: #dcfce7;
  border-color: #22c55e
}
.alert.alert-danger {
  color: #dc2626;
  background-color: #fee2e2;
  border-color: #ef4444
}
.alert.alert-warning {
  color: #d97706;
  background-color: #fef3c7;
  border-color: #f59e0b
}
.alert.alert-info {
  color: #2980b9;
  background-color: #bbdefb;
  border-color: #3498db
}
.progress {
  width: 100%;
  height: 20px;
  background-color: #f5f5f5;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  overflow: hidden;
  margin-bottom: 16px
}
.progress .progress-bar {
  height: 100%;
  background-color: #3498db;
  -webkit-transition: width .6s;
  -moz-transition: width .6s;
  -o-transition: width .6s;
  transition: width .6s
}
.progress .progress-bar.progress-striped {
  background-image: linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);
  background-size: 1rem 1rem
}
.progress .progress-bar.progress-animated {
  animation: 1s linear infinite progress-bar-stripes
}
@keyframes progress-bar-stripes {
  from {
    background-position: 1rem 0
  }
  to {
    background-position: 0 0
  }
}
.modal {
  -ms-flex-pack: center;
  -webkit-justify-content: center;
  justify-content: center;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center
}
.modal .modal-dialog {
  background: #fff;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  max-width: 500px;
  width: 90%;
  max-height: 90vh;
  overflow-y: auto
}
.modal .modal-header {
  padding: 24px;
  border-bottom: 1px solid #e0e0e0;
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: space-between;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center
}
.modal .modal-header h5 {
  margin: 0;
  color: #424242
}
.modal .modal-header .close {
  background: 0 0;
  border: none;
  font-size: 24px;
  cursor: pointer;
  padding: 0;
  width: auto;
  color: #9e9e9e
}
.modal .modal-header .close:hover {
  color: #424242
}
.modal .modal-body {
  padding: 24px
}
.modal .modal-footer {
  padding: 24px;
  border-top: 1px solid #e0e0e0;
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: flex-end;
  -webkit-justify-content: flex-end;
  justify-content: flex-end;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center
}
.modal .modal-footer button {
  width: auto;
  margin-left: 8px
}
.modal .modal-footer button:first-child {
  margin-left: 0
}
.dropdown {
  position: relative;
  display: inline-block
}
.dropdown .dropdown-toggle {
  cursor: pointer
}
.dropdown .dropdown-toggle:after {
  content: " ▼";
  font-size: 12px;
  margin-left: 8px
}
.dropdown .dropdown-menu {
  position: absolute;
  top: 100%;
  left: 0;
  z-index: 1000;
  display: none;
  min-width: 160px;
  background-color: #fff;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  -webkit-box-shadow: 0 4px 6px rgba(0,0,0,.07);
  -moz-box-shadow: 0 4px 6px rgba(0,0,0,.07);
  box-shadow: 0 4px 6px rgba(0,0,0,.07);
  border: 1px solid #e0e0e0
}
.dropdown .dropdown-menu.show {
  display: block
}
.dropdown .dropdown-menu .dropdown-item {
  display: block;
  padding: 8px 16px;
  color: #424242;
  text-decoration: none;
  border: none;
  background: 0 0;
  width: 100%;
  text-align: left;
  cursor: pointer
}
.dropdown .dropdown-menu .dropdown-item:hover {
  background-color: #e3f2fd;
  color: #424242
}
.dropdown .dropdown-menu .dropdown-item:focus {
  background-color: #3498db;
  color: #fff;
  outline: 0
}
.dropdown .dropdown-menu .dropdown-item.disabled {
  color: #9e9e9e;
  cursor: not-allowed
}
.dropdown .dropdown-menu .dropdown-item.disabled:hover {
  background-color: transparent
}
.dropdown .dropdown-menu .dropdown-divider {
  height: 0;
  margin: 8px 0;
  overflow: hidden;
  border-top: 1px solid #e0e0e0
}
.pagination {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: center;
  -webkit-justify-content: center;
  justify-content: center;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
  margin-top: 24px
}
.pagination .page-item {
  margin: 0 2px
}
.pagination .page-item .page-link {
  display: block;
  padding: 8px 16px;
  background: #fff;
  border: 1px solid #e0e0e0;
  color: #3498db;
  text-decoration: none;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s
}
.pagination .page-item .page-link:hover {
  background-color: #e3f2fd;
  border-color: #3498db
}
.pagination .page-item .page-link:focus {
  outline: #3498db solid 2px;
  outline-offset: 2px
}
.pagination .page-item.active .page-link {
  background-color: #3498db;
  border-color: #3498db;
  color: #fff
}
.pagination .page-item.disabled .page-link {
  color: #9e9e9e;
  cursor: not-allowed
}
.pagination .page-item.disabled .page-link:hover {
  background-color: #fff;
  border-color: #e0e0e0
}
.datepicker {
  position: absolute;
  background: #fff;
  border: 2px solid #3498db;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  -webkit-box-shadow: 0 20px 25px rgba(0,0,0,.1);
  -moz-box-shadow: 0 20px 25px rgba(0,0,0,.1);
  box-shadow: 0 20px 25px rgba(0,0,0,.1);
  z-index: 1060;
  font-family: "Segoe UI",Arial,sans-serif;
  font-size: 14px;
  width: 280px;
  animation: .3s ease-out datepicker-fadeIn;
  transform-origin: top left
}
.datepicker-header {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: space-between;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
  padding: 12px;
  background: #3498db;
  color: #fff;
  -webkit-border-radius: 4px 4px 0 0;
  -moz-border-radius: 4px 4px 0 0;
  border-radius: 4px 4px 0 0
}
.datepicker-title {
  font-weight: 700;
  font-size: 16px;
  color: #fff
}
.datepicker-btn {
  width: 48px;
  background: rgba(255,255,255,.2);
  border: none;
  color: #fff;
  padding: 6px 12px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
  -webkit-transition: background .15s;
  -moz-transition: background .15s;
  -o-transition: background .15s;
  transition: background .15s
}
.datepicker-btn:hover {
  background: rgba(255,255,255,.3);
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.datepicker-btn:active {
  -webkit-transform: translateY(0);
  -ms-transform: translateY(0);
  transform: translateY(0);
  background: rgba(255,255,255,.4)
}
.datepicker-btn:focus {
  outline: rgba(255,255,255,.5) solid 2px;
  outline-offset: 2px
}
.datepicker-weekdays {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: wrap;
  -webkit-flex-wrap: wrap;
  flex-wrap: wrap;
  -ms-flex-pack: flex-start;
  -webkit-justify-content: flex-start;
  justify-content: flex-start;
  -ms-flex-align: stretch;
  -webkit-align-items: stretch;
  align-items: stretch;
  padding: 8px;
  background: #fafafa;
  border-bottom: 1px solid #e0e0e0
}
.datepicker-weekdays span {
  display: block;
  width: 14.28%;
  text-align: center;
  padding: 4px;
  font-size: 12px;
  font-weight: 700;
  color: #9e9e9e
}
.datepicker-days {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: wrap;
  -webkit-flex-wrap: wrap;
  flex-wrap: wrap;
  -ms-flex-pack: flex-start;
  -webkit-justify-content: flex-start;
  justify-content: flex-start;
  -ms-flex-align: stretch;
  -webkit-align-items: stretch;
  align-items: stretch;
  padding: 8px;
  background: #fff
}
.datepicker-day {
  width: 14.28%;
  text-align: center;
  padding: 8px 4px;
  cursor: pointer;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px;
  -webkit-transition: .15s;
  -moz-transition: .15s;
  -o-transition: .15s;
  transition: .15s;
  color: #424242;
  position: relative
}
.datepicker-day:hover {
  background: #e3f2fd;
  color: #3498db;
  -webkit-transform: scale(1.05);
  -ms-transform: scale(1.05);
  transform: scale(1.05)
}
.datepicker-day:active {
  -webkit-transform: scale(.95);
  -ms-transform: scale(.95);
  transform: scale(.95)
}
.datepicker-day.other-month {
  color: #9e9e9e
}
.datepicker-day.other-month:hover {
  color: #757575;
  background: #f5f5f5
}
.datepicker-day.disabled {
  color: #ccc!important;
  background-color: #f5f5f5!important;
  cursor: not-allowed!important
}
.datepicker-day.disabled:hover {
  background-color: #f5f5f5!important;
  color: #ccc!important;
  -webkit-transform: none!important;
  -ms-transform: none!important;
  transform: none!important
}
.datepicker-day.selected {
  background: #3498db;
  color: #fff;
  -webkit-box-shadow: 0 4px 6px rgba(0,0,0,.07);
  -moz-box-shadow: 0 4px 6px rgba(0,0,0,.07);
  box-shadow: 0 4px 6px rgba(0,0,0,.07);
  font-weight: 700
}
.datepicker-day.selected:hover {
  background: #2980b9;
  -webkit-transform: scale(1.05);
  -ms-transform: scale(1.05);
  transform: scale(1.05)
}
.datepicker-day.today {
  background: #f59e0b;
  color: #fff;
  font-weight: 700;
  -webkit-box-shadow: 0 1px 2px rgba(0,0,0,.05);
  -moz-box-shadow: 0 1px 2px rgba(0,0,0,.05);
  box-shadow: 0 1px 2px rgba(0,0,0,.05)
}
.datepicker-day.today:hover {
  background: #d97706;
  -webkit-transform: scale(1.05);
  -ms-transform: scale(1.05);
  transform: scale(1.05)
}
.datepicker-day.today.selected {
  background: #3498db
}
.datepicker-day.today.selected::after {
  content: "";
  position: absolute;
  bottom: 2px;
  left: 50%;
  transform: translateX(-50%);
  width: 4px;
  height: 4px;
  background: #f59e0b;
  -webkit-border-radius: 9999px;
  -moz-border-radius: 9999px;
  border-radius: 9999px
}
.datepicker-day:focus {
  outline: #3498db solid 2px;
  outline-offset: 2px;
  z-index: 1
}
.datepicker-footer {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: space-between;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
  padding: 8px 12px;
  border-top: 1px solid #e0e0e0;
  background: #fafafa;
  -webkit-border-radius: 0 0 4px 4px;
  -moz-border-radius: 0 0 4px 4px;
  border-radius: 0 0 4px 4px
}
.datepicker-footer .datepicker-btn {
  width: 48%;
  background: #9e9e9e;
  color: #fff;
  padding: 6px 16px;
  font-size: 12px
}
.datepicker-footer .datepicker-btn:hover {
  background: #757575;
  -webkit-box-shadow: 0 1px 2px rgba(0,0,0,.05);
  -moz-box-shadow: 0 1px 2px rgba(0,0,0,.05);
  box-shadow: 0 1px 2px rgba(0,0,0,.05)
}
.datepicker-footer .datepicker-btn:active {
  -webkit-transform: translateY(0);
  -ms-transform: translateY(0);
  transform: translateY(0);
  -webkit-box-shadow: none;
  -moz-box-shadow: none;
  box-shadow: none
}
.datepicker-footer .datepicker-btn#todayBtn {
  background: #3498db
}
.datepicker-footer .datepicker-btn#todayBtn:hover {
  background: #2980b9
}
.datepicker-footer .datepicker-btn#closeBtn {
  background: #9e9e9e
}
.datepicker-footer .datepicker-btn#closeBtn:hover {
  background: #757575
}
.datepicker-input {
  position: relative
}
.datepicker-input input {
  width: 100%;
  padding: 8px 30px 8px 8px;
  border: 2px solid #e0e0e0;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  font-size: 16px;
  box-sizing: border-box;
  -webkit-transition: border-color .3s;
  -moz-transition: border-color .3s;
  -o-transition: border-color .3s;
  transition: border-color .3s;
  background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEzIDJIMTVWMTRIMVYySDE1VjJINTNNMyA2SDE1TTUgMFY0TTExIDBWNCIgc3Ryb2tlPSIjNjY2IiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiLz4KPC9zdmc+");
  background-repeat: no-repeat;
  background-position: right 8px center;
  background-size: 16px 16px
}
.datepicker-input input:focus {
  border-color: #3498db;
  outline: 0;
  -webkit-box-shadow: 0 0 0 3px rgba(52,152,219,.25);
  -moz-box-shadow: 0 0 0 3px rgba(52,152,219,.25);
  box-shadow: 0 0 0 3px rgba(52,152,219,.25)
}
.datepicker-input input:hover {
  border-color: #bdbdbd
}
.datepicker-input input:disabled {
  background-color: #f5f5f5;
  color: #bdbdbd;
  border-color: #e0e0e0;
  cursor: not-allowed
}
.datepicker.loading .datepicker-days {
  position: relative
}
.datepicker.loading .datepicker-days::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(255,255,255,.8);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1
}
.datepicker.loading .datepicker-days::after {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  width: 20px;
  height: 20px;
  margin: -10px 0 0 -10px;
  border: 2px solid #e0e0e0;
  border-top: 2px solid #3498db;
  -webkit-border-radius: 9999px;
  -moz-border-radius: 9999px;
  border-radius: 9999px;
  animation: 1s linear infinite datepicker-spin;
  z-index: 2
}
@keyframes datepicker-spin {
  0% {
    transform: rotate(0)
  }
  100% {
    transform: rotate(360deg)
  }
}
@media screen and (max-width:480px) {
  .datepicker {
    width: 260px;
    font-size: 12px
  }
  .datepicker-header {
    padding: 8px 12px
  }
  .datepicker-btn {
    width: 40px;
    padding: 4px 8px;
    font-size: 12px
  }
  .datepicker-day {
    padding: 6px 2px;
    font-size: 12px
  }
  .datepicker-footer {
    padding: 6px 8px
  }
  .datepicker-footer .datepicker-btn {
    padding: 4px 12px;
    font-size: 12px
  }
}
@media screen and (max-height:600px) {
  .datepicker .datepicker-header {
    padding: 6px 12px
  }
  .datepicker .datepicker-day {
    padding: 4px 2px
  }
  .datepicker .datepicker-footer {
    padding: 4px 8px
  }
}
@media (prefers-color-scheme:dark) {
  .datepicker {
    background: #1e293b;
    border-color: #475569;
    color: #f5f5f5
  }
  .datepicker .datepicker-header {
    background: #334155;
    color: #f5f5f5
  }
  .datepicker .datepicker-weekdays {
    background: #334155;
    border-color: #475569
  }
  .datepicker .datepicker-weekdays span {
    color: #bdbdbd
  }
  .datepicker .datepicker-days {
    background: #1e293b
  }
  .datepicker .datepicker-day {
    color: #eee
  }
  .datepicker .datepicker-day:hover {
    background: #334155;
    color: #42a5f5
  }
  .datepicker .datepicker-day.other-month {
    color: #9e9e9e
  }
  .datepicker .datepicker-day.other-month:hover {
    color: #bdbdbd;
    background: #334155
  }
  .datepicker .datepicker-day.selected {
    background: #2980b9;
    color: #fff
  }
  .datepicker .datepicker-day.selected:hover {
    background: #3498db
  }
  .datepicker .datepicker-day.today {
    background: #d97706;
    color: #fff
  }
  .datepicker .datepicker-day.today:hover {
    background: #f59e0b
  }
  .datepicker .datepicker-footer {
    background: #334155;
    border-color: #475569
  }
  .datepicker .datepicker-footer .datepicker-btn:hover {
    background: #475569
  }
}
@keyframes datepicker-fadeIn {
  from {
    opacity: 0;
    -webkit-transform: scale(.95) translateY(-10px);
    -ms-transform: scale(.95) translateY(-10px);
    transform: scale(.95) translateY(-10px)
  }
  to {
    opacity: 1;
    -webkit-transform: scale(1) translateY(0);
    -ms-transform: scale(1) translateY(0);
    transform: scale(1) translateY(0)
  }
}
.datepicker.closing {
  animation: .15s ease-in datepicker-fadeOut
}
@keyframes datepicker-fadeOut {
  from {
    opacity: 1;
    -webkit-transform: scale(1) translateY(0);
    -ms-transform: scale(1) translateY(0);
    transform: scale(1) translateY(0)
  }
  to {
    opacity: 0;
    -webkit-transform: scale(.95) translateY(-10px);
    -ms-transform: scale(.95) translateY(-10px);
    transform: scale(.95) translateY(-10px)
  }
}
@media (prefers-contrast:high) {
  .datepicker {
    border-width: 3px
  }
  .datepicker .datepicker-day {
    border: 1px solid transparent
  }
  .datepicker .datepicker-day:focus {
    border-color: #424242;
    outline: 0
  }
  .datepicker .datepicker-day.selected {
    border-color: #fff
  }
}
@media (prefers-reduced-motion:reduce) {
  .datepicker {
    animation: none
  }
  .datepicker .datepicker-btn,
  .datepicker .datepicker-day {
    transition: none
  }
  .datepicker .datepicker-btn:hover,
  .datepicker .datepicker-day:hover {
    transform: none
  }
}
.modal {
  display: none;
  position: fixed;
  z-index: 1050;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0,0,0,.5)
}
.modal-content {
  background-color: rgba(255,255,255,.95);
  margin: 5% auto;
  padding: 24px;
  border: 1px solid #e0e0e0;
  width: 80vw;
  max-width: 900px;
  -webkit-border-radius: 12px;
  -moz-border-radius: 12px;
  border-radius: 12px;
  -webkit-box-shadow: 0 20px 25px rgba(0,0,0,.1);
  -moz-box-shadow: 0 20px 25px rgba(0,0,0,.1);
  box-shadow: 0 20px 25px rgba(0,0,0,.1);
  position: relative
}
.modal-header {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: space-between;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
  padding-bottom: 16px;
  border-bottom: 1px solid #eee;
  margin-bottom: 24px
}
.modal-header h2 {
  margin: 0;
  font-size: 22px
}
.modal-close {
  width: 40px;
  height: 40px;
  color: #9e9e9e;
  font-size: 32px;
  font-weight: 700;
  cursor: pointer;
  text-align: center;
  line-height: 32px;
  background: 0 0;
  border: none;
  padding: 4px
}
.modal-close:focus,
.modal-close:hover {
  color: #424242;
  text-decoration: none;
  background: 0 0
}
.metric-select-label {
  margin-top: -24px
}
#chartMetricSelect {
  padding: 0 8px;
  border: 2px solid #e0e0e0;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  font-size: 16px;
  box-sizing: border-box;
  -webkit-transition: border-color .3s;
  -moz-transition: border-color .3s;
  -o-transition: border-color .3s;
  transition: border-color .3s;
  width: auto;
  min-width: 250px;
  margin-bottom: 24px;
  height: 36px
}
#chartMetricSelect:focus {
  border-color: #3498db;
  outline: 0;
  -webkit-box-shadow: 0 0 0 3px rgba(52,152,219,.25);
  -moz-box-shadow: 0 0 0 3px rgba(52,152,219,.25);
  box-shadow: 0 0 0 3px rgba(52,152,219,.25)
}
#chartMetricSelect:hover {
  border-color: #bdbdbd
}
#chartMetricSelect:disabled {
  background-color: #f5f5f5;
  color: #bdbdbd;
  border-color: #e0e0e0;
  cursor: not-allowed
}
#qualityChartContainer {
  position: relative;
  height: 450px;
  width: 100%
}
#bunkerDetailsModalTitle {
  width: 92%;
  max-width: 92%;
  word-wrap: break-word;
  overflow-wrap: break-word
}
.bunker-details-table {
  position: relative;
  width: 100%;
  max-width: 100%;
  border-collapse: collapse;
  margin-bottom: 24px;
  table-layout: fixed
}
.bunker-details-table td,
.bunker-details-table th {
  padding: 8px 4px;
  border: 1px solid #e0e0e0;
  text-align: center;
  word-wrap: break-word;
  overflow-wrap: break-word
}
.bunker-details-table th {
  background-color: #eee;
  font-weight: 700;
  vertical-align: top
}
.bunker-details-table .bunker-label {
  padding-left: 8px;
  text-align: left;
  font-weight: 600;
  width: 15%;
  min-width: 70px
}
@media print {
  .modal {
    display: relative!important
  }
  .modal-content {
    box-shadow: none!important;
    border: 1px solid #000!important;
    margin: 0 auto!important;
    width: 100%!important;
    max-width: none!important;
    height: auto!important
  }
  .modal-close {
    display: none!important
  }
}
.workspace-container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: #f5f5f5;
  padding: 24px;
  box-sizing: border-box;
  overflow: auto;
  z-index: 1030
}
#verifiedDataMessage {
  display: none;
  text-align: center;
  padding: 64px;
  font-size: 18px;
  color: #2980b9;
  font-weight: 700
}
.journal-header {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: space-between;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
  margin-bottom: 24px;
  background: rgba(255,255,255,.95);
  padding: 15px 24px;
  -webkit-border-radius: 12px;
  -moz-border-radius: 12px;
  border-radius: 12px;
  -webkit-box-shadow: 0 10px 15px rgba(0,0,0,.1);
  -moz-box-shadow: 0 10px 15px rgba(0,0,0,.1);
  box-shadow: 0 10px 15px rgba(0,0,0,.1);
  position: relative
}
@media screen and (max-width:768px) {
  .journal-header {
    display: -ms-flexbox;
    display: -webkit-flex;
    display: flex;
    -ms-flex-direction: column;
    -webkit-flex-direction: column;
    flex-direction: column;
    -ms-flex-wrap: nowrap;
    -webkit-flex-wrap: nowrap;
    flex-wrap: nowrap;
    -ms-flex-pack: flex-start;
    -webkit-justify-content: flex-start;
    justify-content: flex-start;
    -ms-flex-align: stretch;
    -webkit-align-items: stretch;
    align-items: stretch;
    gap: 16px
  }
}
.journal-title {
  font-size: 24px;
  font-weight: 700;
  color: #334155;
  margin: 0;
  letter-spacing: 1px
}
@media screen and (max-width:480px) {
  .journal-title {
    font-size: 20px;
    text-align: center
  }
}
.journal-controls {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: wrap;
  -webkit-flex-wrap: wrap;
  flex-wrap: wrap;
  -ms-flex-pack: flex-end;
  -webkit-justify-content: flex-end;
  justify-content: flex-end;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center
}
@media screen and (max-width:768px) {
  .journal-controls {
    display: -ms-flexbox;
    display: -webkit-flex;
    display: flex;
    -ms-flex-direction: row;
    -webkit-flex-direction: row;
    flex-direction: row;
    -ms-flex-wrap: wrap;
    -webkit-flex-wrap: wrap;
    flex-wrap: wrap;
    -ms-flex-pack: center;
    -webkit-justify-content: center;
    justify-content: center;
    -ms-flex-align: center;
    -webkit-align-items: center;
    align-items: center;
    width: 100%
  }
}
.control-group {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: flex-start;
  -webkit-justify-content: flex-start;
  justify-content: flex-start;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
  margin-right: 15px;
  margin-bottom: 10px;
  font-weight: 600;
  color: #757575;
  white-space: nowrap
}
.control-group:last-child {
  margin-right: 0
}
.control-group label {
  margin-bottom: 0;
  margin-right: 8px;
  font-size: 14px;
  color: #757575
}
.journal-controls .control-input {
  padding: 0 4px;
  border: 2px solid #e0e0e0;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  box-sizing: border-box;
  -webkit-transition: border-color .3s;
  -moz-transition: border-color .3s;
  -o-transition: border-color .3s;
  transition: border-color .3s;
  width: 80px;
  height: 26px;
  font-size: 14px;
  vertical-align: middle
}
.journal-controls .control-input:hover {
  border-color: #bdbdbd
}
.journal-controls .control-input:disabled {
  background-color: #f5f5f5;
  color: #bdbdbd;
  border-color: #e0e0e0;
  cursor: not-allowed
}
.journal-controls .control-input:focus {
  outline: 0;
  border-color: #3498db;
  -webkit-box-shadow: 0 0 0 3px rgba(52,152,219,.25);
  -moz-box-shadow: 0 0 0 3px rgba(52,152,219,.25);
  box-shadow: 0 0 0 3px rgba(52,152,219,.25)
}
.journal-controls .control-input[type=date] {
  width: 108px
}
.journal-controls .control-input#brigadeInfo {
  width: 120px
}
.journal-controls .control-input#sampleSelection,
.journal-controls .control-input#shiftNumber {
  width: 48px
}
.journal-table-container {
  background: rgba(255,255,255,.95);
  -webkit-border-radius: 12px;
  -moz-border-radius: 12px;
  border-radius: 12px;
  -webkit-box-shadow: 0 10px 15px rgba(0,0,0,.1);
  -moz-box-shadow: 0 10px 15px rgba(0,0,0,.1);
  box-shadow: 0 10px 15px rgba(0,0,0,.1);
  padding: 24px;
  overflow-x: auto
}
@media screen and (max-width:768px) {
  .journal-table-container {
    padding: 16px;
    margin: 0 -16px;
    border-radius: 0
  }
}
.journal-table {
  border-collapse: collapse;
  margin-top: 16px;
  font-size: 12px;
  width: 91.5vw
}
.journal-table th {
  background: #334155;
  color: #fff;
  font-weight: 700;
  position: sticky;
  top: 0;
  z-index: 10;
  padding: 6px;
  text-align: center;
  vertical-align: middle;
  border: 1px solid #1f618d
}
.journal-table th[rowspan="2"] {
  vertical-align: middle
}
.journal-table td {
  padding: 2px 4px;
  border: 1px solid #e0e0e0;
  text-align: center;
  vertical-align: middle
}
.journal-table td.product-name {
  font-weight: 700;
  background-color: rgba(255,255,255,.95);
  text-align: center;
  vertical-align: middle
}
.journal-table td:hover {
  background-color: #e3f2fd
}
.journal-table tbody tr.product-group-1,
.journal-table tbody tr.product-group-3 {
  background-color: #f5f0e6
}
.journal-table tbody tr.product-group-2 {
  background-color: #fff8e1
}
.journal-table tfoot td {
  font-weight: 700
}
.journal-table tfoot .footer-title {
  text-align: right!important;
  padding: 8px;
  color: #fff;
  background-color: #64748b
}
.journal-table tfoot .footer-value {
  background-color: #cbd5e1;
  text-align: center;
  font-size: 14px
}
.table-input,
.table-select {
  width: 100%;
  border: 1px solid #e0e0e0;
  margin: 0;
  font-size: 14px;
  line-height: 14px;
  background: #fff;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px;
  box-sizing: border-box;
  -webkit-transition: .15s;
  -moz-transition: .15s;
  -o-transition: .15s;
  transition: .15s
}
.table-input:focus,
.table-select:focus {
  border-color: #3498db;
  outline: 0;
  background-color: #e3f2fd;
  -webkit-box-shadow: 0 0 0 3px rgba(52,152,219,.25);
  -moz-box-shadow: 0 0 0 3px rgba(52,152,219,.25);
  box-shadow: 0 0 0 3px rgba(52,152,219,.25)
}
.table-input:hover,
.table-select:hover {
  border-color: #2980b9
}
.table-input:disabled,
.table-select:disabled {
  background-color: #f5f5f5;
  color: #bdbdbd;
  border-color: #e0e0e0;
  cursor: not-allowed
}
.table-input.number,
.table-select.number {
  font-size: 14px;
  text-align: center
}
.table-input.text,
.table-select.text {
  font-size: 14px;
  text-align: left
}
.table-select {
  cursor: pointer;
  background-image: url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 4 5'%3E%3Cpath fill='%23666' d='M2 0L0 2h4zm0 5L0 3h4z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 6px center;
  background-size: 8px;
  padding-right: 8px
}
.table-select::-ms-expand {
  display: none
}
.table-select:hover {
  background-color: #e3f2fd
}
.table-text {
  padding: 0;
  margin: 0;
  color: #424242
}
.table-text.number {
  font-size: 14px;
  line-height: 14px;
  text-align: center;
  font-weight: 600
}
.col-table {
  width: 6.1vw;
  min-width: 64px
}
.journal-footer {
  margin-top: 24px;
  background: rgba(255,255,255,.95);
  padding: 15px 24px;
  -webkit-border-radius: 12px;
  -moz-border-radius: 12px;
  border-radius: 12px;
  -webkit-box-shadow: 0 10px 15px rgba(0,0,0,.1);
  -moz-box-shadow: 0 10px 15px rgba(0,0,0,.1);
  box-shadow: 0 10px 15px rgba(0,0,0,.1);
  text-align: center
}
@media screen and (max-width:768px) {
  .journal-footer {
    padding: 16px;
    margin: 24px -16px 0;
    border-radius: 0
  }
}
.journal-footer .footer-buttons {
  width: 100%;
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: wrap;
  -webkit-flex-wrap: wrap;
  flex-wrap: wrap;
  -ms-flex-pack: center;
  -webkit-justify-content: center;
  justify-content: center;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center
}
.journal-notes {
  font-size: 13px;
  color: #757575;
  line-height: 1.5;
  margin-bottom: 15px;
  text-align: left
}
.journal-notes strong {
  color: #424242;
  font-weight: 700
}
.sieve strong {
  padding-top: 24px;
  font-size: 11px
}
.save-btn {
  border: none;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 600;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  background: -ms-linear-gradient(top,#3498db,#2980b9);
  background: -webkit-linear-gradient(135deg,#3498db,#2980b9);
  background: linear-gradient(135deg,#3498db,#2980b9);
  color: #fff
}
.save-btn:focus,
.save-btn:hover {
  background: -ms-linear-gradient(top,#2980b9,#1f618d);
  background: -webkit-linear-gradient(135deg,#2980b9,#1f618d);
  background: linear-gradient(135deg,#2980b9,#1f618d);
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.danger-btn {
  border: none;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 600;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  background: #ef4444;
  color: #fff
}
.danger-btn:focus,
.danger-btn:hover {
  background: #dc2626;
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.danger-btn,
.save-btn {
  max-width: 320px;
  width: 40vw;
  min-width: 240px;
  padding: 12px 36px;
  margin: 4px 24px;
  font-size: 16px
}
@media screen and (max-width:480px) {
  .danger-btn,
  .save-btn {
    width: 30%
  }
}
.danger-btn:hover,
.save-btn:hover {
  -webkit-box-shadow: 0 4px 6px rgba(0,0,0,.07);
  -moz-box-shadow: 0 4px 6px rgba(0,0,0,.07);
  box-shadow: 0 4px 6px rgba(0,0,0,.07);
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.danger-btn:active,
.save-btn:active {
  -webkit-transform: translateY(0);
  -ms-transform: translateY(0);
  transform: translateY(0);
  -webkit-box-shadow: 0 1px 2px rgba(0,0,0,.05);
  -moz-box-shadow: 0 1px 2px rgba(0,0,0,.05);
  box-shadow: 0 1px 2px rgba(0,0,0,.05)
}
@media screen and (max-width:768px) {
  .workspace-container {
    padding: 16px
  }
  .journal-table {
    font-size: 11px
  }
  .journal-table td,
  .journal-table th {
    padding: 4px
  }
  .table-input,
  .table-select {
    padding: 2px;
    font-size: 11px
  }
}
@media print {
  .workspace-container {
    position: static;
    width: auto;
    height: auto;
    background: #fff;
    padding: 0
  }
  .journal-footer,
  .journal-header {
    background: #fff;
    box-shadow: none;
    border: 1px solid #424242
  }
  .back-button,
  .danger-btn,
  .save-btn {
    display: none
  }
  .journal-table {
    font-size: 10px
  }
  .journal-table td,
  .journal-table th {
    border: 1px solid #424242;
    padding: 4px 2px
  }
  .journal-table th {
    background: #f5f5f5;
    color: #424242
  }
  .table-input,
  .table-select {
    border: none;
    background: 0 0;
    padding: 0
  }
}
.product-name-container {
  position: relative;
  width: 100%;
  height: 100%;
  display: block;
  padding-right: 20px;
  line-height: 1.2
}
.product-toggle-btn {
  position: absolute;
  top: 0;
  right: 0;
  width: 18px;
  height: 18px;
  background: #3498db;
  color: #fff;
  border: 1px solid #2980b9;
  -webkit-border-radius: 2px;
  -moz-border-radius: 2px;
  border-radius: 2px;
  font-size: 12px;
  font-weight: 700;
  line-height: 1;
  text-align: center;
  cursor: pointer;
  padding: 0;
  margin: 0;
  z-index: 2;
  -webkit-transition: .15s;
  -moz-transition: .15s;
  -o-transition: .15s;
  transition: .15s
}
.product-toggle-btn:focus {
  outline: 0
}
.product-toggle-btn:hover {
  background: #2980b9;
  border-color: #1f618d;
  -webkit-transform: scale(1.1);
  -ms-transform: scale(1.1);
  transform: scale(1.1);
  -webkit-box-shadow: 0 1px 2px rgba(0,0,0,.05);
  -moz-box-shadow: 0 1px 2px rgba(0,0,0,.05);
  box-shadow: 0 1px 2px rgba(0,0,0,.05)
}
.product-toggle-btn:active {
  -webkit-transform: scale(.95);
  -ms-transform: scale(.95);
  transform: scale(.95);
  -webkit-box-shadow: none;
  -moz-box-shadow: none;
  box-shadow: none
}
.product-toggle-btn.inactive {
  background: #9e9e9e;
  border-color: #757575;
  color: #fff
}
.product-toggle-btn.inactive:hover {
  background: #757575;
  border-color: #9e9e9e
}
.product-row {
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s
}
.product-row.inactive {
  background-color: #f5f5f5!important;
  color: #bdbdbd;
  opacity: .6
}
.product-row.inactive .table-input,
.product-row.inactive .table-select {
  background-color: #f5f5f5!important;
  color: #bdbdbd!important;
  border-color: #e0e0e0!important;
  cursor: not-allowed!important
}
.product-row.inactive .table-input:focus,
.product-row.inactive .table-input:hover,
.product-row.inactive .table-select:focus,
.product-row.inactive .table-select:hover {
  background-color: #f5f5f5!important;
  border-color: #e0e0e0!important;
  -webkit-box-shadow: none!important;
  -moz-box-shadow: none!important;
  box-shadow: none!important
}
.product-row.inactive .table-text {
  color: #bdbdbd!important
}
.product-row.inactive:hover {
  background-color: #ededed!important
}
@media screen and (max-width:480px) {
  .product-name-container {
    font-size: 12px;
    padding-right: 18px
  }
  .product-toggle-btn {
    width: 14px;
    height: 14px;
    font-size: 9px;
    top: 1px;
    right: 1px
  }
}
@media print {
  .product-row.inactive,
  .product-toggle-btn {
    display: none!important
  }
}
.journal-table td .moisture-single {
  position: absolute;
  font-size: 12px;
  color: #757575;
  font-weight: 400;
  z-index: 1
}
.journal-table td .moisture-1 {
  top: 12px;
  left: 4px
}
.journal-table td .moisture-2 {
  bottom: 12px;
  left: 4px
}
.unverified-shifts-container {
  background: #fff8e1;
  border: 1px solid #d97706;
  -webkit-border-radius: 12px;
  -moz-border-radius: 12px;
  border-radius: 12px;
  padding: 24px;
  margin-bottom: 24px;
  -webkit-box-shadow: 0 10px 15px rgba(0,0,0,.1);
  -moz-box-shadow: 0 10px 15px rgba(0,0,0,.1);
  box-shadow: 0 10px 15px rgba(0,0,0,.1)
}
.unverified-shifts-container h3 {
  margin-top: 0;
  color: #b45309;
  font-size: 18px;
  margin-bottom: 16px
}
.unverified-shifts-container ul {
  list-style-type: disc;
  padding-left: 20px;
  margin: 0
}
.unverified-shifts-container ul li {
  margin-bottom: 8px;
  font-size: 14px;
  color: #424242
}
.unverified-shifts-container.all-verified {
  background: #f0fdf4;
  border-color: #16a34a
}
.unverified-shifts-container.all-verified h3 {
  color: #15803d
}
#verificationMessage.verified {
  color: #15803d;
  font-weight: 700
}
.quality-journal-table thead th {
  text-align: center;
  vertical-align: middle
}
.quality-journal-table tbody td {
  text-align: center;
  vertical-align: middle;
  font-size: 14px
}
#qualityJournal .journal-header {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: flex-start;
  -webkit-justify-content: flex-start;
  justify-content: flex-start;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center
}
#qualityJournal .journal-header .journal-title {
  flex-grow: 1;
  text-align: center;
  padding-right: 52px
}
#qualityJournal .journal-controls {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: space-between;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
  gap: 24px;
  width: auto;
  min-width: 360px
}
.pagination-controls {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: space-between;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
  gap: 12px;
  width: auto;
  min-width: 360px
}
#qualityJournal .month-display {
  font-size: 18px;
  font-weight: 600;
  color: #334155;
  min-width: 180px;
  text-align: center
}
#qualityJournal .pagination-btn {
  border: 1px solid #e0e0e0;
  padding: 0;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 600;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  width: 40px;
  height: 40px;
  font-size: 20px;
  line-height: 1;
  background: #f5f5f5;
  color: #334155
}
#qualityJournal .pagination-btn:hover {
  background: #eee;
  border-color: #bdbdbd;
  -webkit-transform: translateY(0);
  -ms-transform: translateY(0);
  transform: translateY(0)
}
#qualityJournal .chart-btn {
  font-size: 24px;
  margin-right: 12px;
  color: #64748b
}
@media (max-width:1200px) {
  .quality-journal-table .rotated-text {
    height: 136px;
    min-width: 24px;
    max-width: 40px;
    padding: 0;
    overflow-x: hidden
  }
  .quality-journal-table .rotated-text > div {
    width: 136px;
    min-width: 136px;
    margin: auto;
    transform: translate(-34%,0) rotate(-90deg)
  }
}
.product-summary-table {
  padding-top: 16px
}
#moistureJournal .journal-info-bar {
  width: 100%;
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: flex-end;
  -webkit-justify-content: flex-end;
  justify-content: flex-end;
  -ms-flex-align: flex-start;
  -webkit-align-items: flex-start;
  align-items: flex-start;
  padding: 0 24px 16px;
  margin: 0 auto;
  color: #757575
}
#moistureJournal .journal-info-bar strong {
  color: #424242
}
#moistureJournal .journal-info-bar__item {
  font-size: 14px
}
#moistureJournal .journal-info-bar__brigade {
  margin-right: 24px
}
#moistureJournal .moisture-table td,
#moistureJournal .moisture-table th {
  text-align: center;
  vertical-align: middle;
  padding: 8px
}
#moistureJournal .moisture-table tbody tr {
  font-size: 14px
}
#moistureJournal .moisture-table tbody tr:hover {
  background-color: #e3f2fd
}
#moistureJournal .moisture-table tbody tr.product-group-1,
#moistureJournal .moisture-table tbody tr.product-group-3 {
  background-color: #f5f0e6
}
#moistureJournal .moisture-table tbody tr.product-group-2 {
  background-color: #fff8e1
}
.qc-section {
  margin-bottom: 32px
}
.qc-section:last-child {
  margin-bottom: 0
}
.qc-section-title {
  font-size: 20px;
  color: #334155;
  margin-bottom: 16px;
  padding-bottom: 8px;
  border-bottom: 2px solid #eee
}
.qc-table tbody td {
  vertical-align: middle;
  text-align: center;
  font-size: 14px
}
.qc-table tbody td:first-child {
  text-align: left;
  font-weight: 600
}
#qualityControlJournal .journal-info-bar {
  width: 100%;
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: flex-end;
  -webkit-justify-content: flex-end;
  justify-content: flex-end;
  -ms-flex-align: flex-start;
  -webkit-align-items: flex-start;
  align-items: flex-start;
  padding: 0 24px 16px;
  margin: 0 auto;
  color: #757575
}
#qualityControlJournal .journal-info-bar strong {
  color: #424242
}
#qualityControlJournal .journal-info-bar__item {
  font-size: 14px
}
#qualityControlJournal .journal-info-bar__brigade {
  margin-right: 24px
}
.consolidated-table thead th {
  text-align: center;
  vertical-align: middle
}
.consolidated-table tbody td {
  text-align: center;
  vertical-align: middle;
  font-size: 14px
}
#consolidatedJournal .journal-header {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: flex-start;
  -webkit-justify-content: flex-start;
  justify-content: flex-start;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center
}
#consolidatedJournal .journal-header .journal-title {
  flex-grow: 1;
  text-align: center;
  padding-right: 52px
}
#consolidatedJournal .journal-controls {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: space-between;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
  gap: 12px;
  width: 360px
}
#consolidatedJournal .month-display {
  font-size: 18px;
  font-weight: 600;
  color: #334155;
  min-width: 180px;
  text-align: center
}
#consolidatedJournal .pagination-btn {
  border: 1px solid #e0e0e0;
  padding: 0;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 600;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  width: 40px;
  height: 40px;
  font-size: 20px;
  line-height: 1;
  background: #f5f5f5;
  color: #334155
}
#consolidatedJournal .pagination-btn:hover {
  background: #eee;
  border-color: #bdbdbd;
  -webkit-transform: translateY(0);
  -ms-transform: translateY(0);
  transform: translateY(0)
}
#xorKeyDisplay {
  display: none;
  margin-top: 24px
}
#xorKeyDisplay button,
#xorKeyDisplay textarea {
  margin-top: 10px
}
#usersList p {
  text-align: center;
  color: #9e9e9e;
  font-style: italic
}
.security-info br {
  line-height: 1.8
}
.logo {
  margin: 0 auto 24px;
  display: block
}
@media screen and (max-width:480px) {
  .containerForm {
    width: 95%;
    padding: 24px
  }
  .wrapper {
    padding: 8px
  }
}
@media print {
  body {
    background: #fff!important;
    color: #000!important
  }
  .containerForm {
    box-shadow: none!important;
    border: 1px solid #000
  }
  button {
    display: none!important
  }
}

</style>
</head>
<body id="body" onload="VBScript:Window_OnLoad()">
    <div class="wrapper">
        <div class="promo-box">
  <img
    src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzc0IiBoZWlnaHQ9IjMyMyIgdmlld0JveD0iMCAwIDM3NCAzMjMiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGQ9Ik0yNDggMTYyQzI0OCAxNjIgMjQ3Ljg3IDI2OS41NjMgMjQ4LjI3MyAzMTguMDE1QzI0OC4zMDMgMzIxLjU5NCAyNDYuOTU3IDMyMi41OTIgMjQzLjU5IDMyMi41ODVDMjAyLjYwMyAzMjIuNDk1IDE2MS42MTYgMzIyLjQ3NSAxMjAuNjMgMzIyLjUzNUMxMTcuMzg1IDMyMi41NCAxMTYuMjU4IDMyMS41MzEgMTE2LjM0NiAzMTguMjJDMTE2LjU1OCAzMTAuMjI4IDExNi40NjQgMzAyLjIyNyAxMTYuNDE2IDI5NC4yM0MxMTYuMTg2IDI1NS43NjIgMTE1Ljk3NiAyMTcuMjk0IDExNS41NzIgMTc4LjgyOEMxMTUuNTQ2IDE3Ni4zOSAxMTQuMzg3IDE3My42NjggMTEyLjk5NiAxNzEuNTg1Qzk3LjI5OTEgMTQ4LjA5MSAxNS40NTM4IDI0LjY5NjkgMCAxQzQuNjY4NzkgNi4zNjEzOSA3NC45ODYgMTExLjk5OSA3OS4zNTE4IDExNy45ODRDODYuMjU3MiAxMjguNDg0IDkzLjE3MTkgMTM4LjU5NyA5OS45NTM1IDE0OC43OThDMTA1LjkwOCAxNTcuNzU1IDExMS42NDYgMTY2LjY0MyAxMTcuNSAxNzZDMTE3LjUgMTc2IDE4MCAxMDkuNSAxODQgMTA3QzE4My43NDMgMTEwLjcyOSAxODMgMjQ2LjUgMTgzIDI0Ni41QzE4MyAyNDYuNSAxMjguMTU2IDMwOS43NzIgMTI2LjAzMiAzMTEuODE0QzEyMy40MjUgMzE0LjYyMSAxMjEuMTM5IDMxNy40MTYgMTE4LjUgMzIwLjVDMTE5Ljg2NyAzMjAuNjQ3IDEyMC40OSAzMjAuNjYxIDEyMS4xMjEgMzIwLjY2MUMxNDMuMzg3IDMyMC42NDkgMTg3LjkxOCAzMjAuNTcxIDE4Ny45MTggMzIwLjU3MUwyMDEuNzggMzIwLjQ3N0MyMDMuOTE2IDMyMC41MzkgMjA1LjYyOSAzMjAuNTM1IDIwNy43NjggMzIwLjU3MUMyMDkuOTA1IDMyMC41OTQgMjExLjYxNiAzMjAuNTc1IDIxMy43MjggMzIwLjYwMUMyMTUuMjAxIDMyMC42MTEgMjE2LjI3MyAzMjAuNTc2IDIxNy43OTIgMzIwLjU4NkMyMjAuOTQgMzIwLjU5MyAyMjMuNjQxIDMyMC41NTYgMjI2LjgwNyAzMjAuNTcyQzIzMi4yNTcgMzIwLjYzNiAyMzcuMjQ1IDMyMC41NjIgMjQyLjIyOCAzMjAuNjg3QzI0NS4xNDEgMzIwLjc2MSAyNDYuNDc5IDMxOS43MjkgMjQ2LjQ1MSAzMTYuNjU0QzI0Ni4xNDMgMjgzLjU5IDI0NS45MDQgMjUwLjUyNiAyNDUuNzMyIDIxNy4wNjhDMjQ1LjgyMiAyMTcuMTM0IDI0NS44MDEgMjE1LjA3NSAyNDUuNzMyIDIxNy4wNjhMMjQ2IDE2NUwyNDggMTYyWiIgZmlsbD0iIzc5QTdCRCIvPgo8cGF0aCBkPSJNMTgzIDI0Ni41QzE4Mi45ODMgMjM1Ljg1NyAxODIuOTQxIDIyNi4zMjYgMTgyLjk1NSAyMTUuNjgzQzE4Mi45NzYgMjAwLjM4MyAxODIuOTQ3IDE4NS4wODMgMTgzLjA0MSAxNjkuNzg0TDE4NCAxMDdMMjU4LjUgMi41TDMxOS41IDcwTDE4MyAyNDYuNVoiIGZpbGw9IiNCOUYwRjciLz4KPHBhdGggZD0iTTExMS4yNzQgMy4wMDAwN0MxMTIgMyAxMjEgMTYgMTIxIDE2QzEzOS43NDIgNDIuNjUwMyAxNjUuMzQ0IDgwLjI4OTEgMTg0IDEwN0MxODMuNDk5IDEwNy4zOTUgMTgzLjQ5OSAxMDcuNjg0IDE4MyAxMDcuNUMxODAuNjEgMTA0LjczNCAxNzguODYxIDEwMS43MzcgMTc3IDk5QzE3MS43MDMgOTEuMjA4NCAxNjUuOTk1IDgzLjExNDggMTYwLjU4NiA3NS40MDQyQzE1MC45MTYgNjEuNjIwMiAxNDAuOTk5IDQ4LjAwOSAxMzEuMTg4IDM0LjMyMzhDMTI4LjAzOSAyOS45MzE4IDEyNC44OTggMjUuNTM0MSAxMjEuNzAzIDIwLjc3NDVDMTE4LjgzOCAxNi40MjA4IDExNi4zNTMgMTIuMzQ0OCAxMTMuNSA4QzExMi43MTkgNi4xODkzOSAxMTEuNjUgNC41NDY3NSAxMTEgM0wxMTEuMjc0IDMuMDAwMDdaIiBmaWxsPSIjQjlGMEY3Ii8+CjxwYXRoIGQ9Ik0zMTkuNSA3MEMzMTkuNSA3MCAzNzAuMjc4IDMuNTkwNTMgMzcxIDEuNUMzNjYuOTcgMC45MTg4NjEgMjYzLjk5IDIuNDQ1MDggMjYwIDEuNUMyNjQuNzU3IDEuMTE1MSAzNjcuNDMzIDAgMzc0IDBDMzcxLjY0NSAzLjM4MDE3IDMxOS41IDcwIDMxOS41IDcwWiIgZmlsbD0iIzc5QTdCRCIvPgo8cGF0aCBkPSJNMTIwLjUgMzIwLjk5NUMxMTguNSAzMjEgMTE4IDMyMSAxMTggMzIwLjVMMjQ4IDE2Mi41QzI0OCAxNjIuNSAyNDcgMzE2LjUgMjQ2LjUgMzE4LjVDMjQ1LjQ0MyAzMjIuNzI3IDIzNy42NDcgMzIxLjA5OSAyMTkuMDc4IDMyMC45OTVDMTg3LjMwOSAzMjAuODE3IDE1NS4yNDYgMzIxLjA4NiAxMjAuNSAzMjAuOTk1WiIgZmlsbD0iIzIwNjQ4OSIvPgo8cGF0aCBkPSJNMzczIDAuNUwzMTkgNjkuNUwyNTguNSAyLjVMMjU5LjUgMUwzNzMgMC41WiIgZmlsbD0iIzVDQ0FERiIvPgo8cGF0aCBkPSJNMTg0IDEwOEwxMTcuNSAxNzZMMCAxSDExMC41TDE4NCAxMDhaIiBmaWxsPSIjNTU4NjlDIi8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTgyLjYgMTExLjhWMjYyLjg0NEMxODIuNiAyNzcuNzc3IDE4MyAyODUgMTc4LjUgMjkxQzE3NCAyOTggMTY2IDMwMCAxNTIuNSAzMDFDMTQ4LjUgMzAxLjI5NiAxNDEuMzY3IDMwMS4zMzMgMTM1LjUgMzAwTDEzMiAzMDRDMTM3LjUgMzA1IDE0Ni4wMTIgMzA2LjQ5OSAxNTMuNSAzMDZDMTY4LjUgMzA1IDE3OC4yIDMwMyAxODIuNiAyOTQuNUMxODcgMjg2IDE4Ny41IDI4MS41IDE4OCAyNjNMMTg4LjIgMTA3LjRMMTcwLjIgMTA2LjJDMTQxLjkzMyAxMDQuNiAxMTcuOTMzIDk5LjI2NjYgOTguMiA5MC4xOTk5Qzg3LjUzMzMgODUuMTMzMyA3OS4xMzMzIDc4LjE5OTkgNzMgNjkuMzk5OUM2Ni44NjY3IDYwLjMzMzIgNjMuOCA0OS42NjY2IDYzLjggMzcuMzk5OUw1OSAzNy43OTk5QzU5IDU5LjEzMzMgNjcgNzUuNTMzMiA4MyA4Ni45OTk5Qzk5IDk4LjE5OTkgMTE5LjggMTA1LjQgMTQ1LjQgMTA4LjZMMTU0LjYgMTA4LjJWMTA5QzE0OC43MzMgMTA5LjggMTQ1LjY2NyAxMTAuMiAxNDUuNCAxMTAuMkMxMzYuNiAxMTIuNiAxMjkuNCAxMTcuNCAxMjMuOCAxMjQuNkMxMTguMiAxMzEuOCAxMTUuNCAxMzkuNCAxMTUuNCAxNDcuNEMxMTUuNCAxNTUuMTMzIDExOS4wNjcgMTY3LjggMTIyIDE3MUwxMjQuNzY5IDE2OC4xQzEyMy4xNjkgMTY0LjM2NyAxMjAuNiAxNTMuMjY3IDEyMC42IDE0OC4yQzEyMC42IDEzNS42NjcgMTI1LjEzMyAxMjYuMzMzIDEzNC4yIDEyMC4yQzE0My4yNjcgMTE0LjA2NyAxNTQuMiAxMTEgMTY3IDExMUgxNzAuMkwxODIuNiAxMTEuOFoiIGZpbGw9IiNCOUYwRjciLz4KPHBhdGggZD0iTTIwOC4yODYgMzA0QzIwNC42OTMgMzA0IDIwMS44ODMgMzAzLjA1MyAxOTkuODU4IDMwMS4xNThDMTk3Ljg5OCAyOTkuMjYzIDE5Ni45MTggMjk2LjYxNyAxOTYuOTE4IDI5My4yMlYyMzcuNTU2QzE5Ni45MTggMjM1LjQ2NSAxOTcuNzY3IDIzNC40MiAxOTkuNDY2IDIzNC40MkMyMDEuMjMgMjM0LjQyIDIwMi4xMTIgMjM1LjQ2NSAyMDIuMTEyIDIzNy41NTZWMjkzLjUxNEMyMDIuMTEyIDI5NS4yNzggMjAyLjYwMiAyOTYuNzE1IDIwMy41ODIgMjk3LjgyNkMyMDQuNjI3IDI5OC44NzEgMjA1Ljk5OSAyOTkuMzk0IDIwNy42OTggMjk5LjM5NEgyNDAuODIyQzI0MS44NjcgMjk5LjM5NCAyNDIuNjE5IDI5OS41OSAyNDMuMDc2IDI5OS45ODJDMjQzLjUzMyAzMDAuMzA5IDI0My43NjIgMzAwLjg5NyAyNDMuNzYyIDMwMS43NDZDMjQzLjc2MiAzMDMuMjQ5IDI0Mi43ODIgMzA0IDI0MC44MjIgMzA0SDIwOC4yODZaIiBmaWxsPSIjQjlGMEY3Ii8+Cjwvc3ZnPgo="
    alt="YavirLab Logo"
    class="logo__icon"
    width="400"
    height="200"
  />
  <img
    src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTkwIiBoZWlnaHQ9IjExNCIgdmlld0JveD0iMCAwIDU5MCAxMTQiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGQ9Ik00MC4xIDExMlY3Mi4xTDAuMDUgMi41SDIzLjZMNTAuOSA1My42NUg1MS4yTDc4LjM1IDIuNUgxMDIuMDVMNjIgNzIuMVYxMTJINDAuMVpNMTA4LjA4NiAxMTMuNUMxMDAuMzg2IDExMy41IDk0LjI4NjMgMTExLjM1IDg5Ljc4NjMgMTA3LjA1Qzg1LjM4NjMgMTAyLjc1IDgzLjE4NjMgOTcgODMuMTg2MyA4OS44QzgzLjE4NjMgODAuOCA4Ni42ODYzIDczLjg1IDkzLjY4NjMgNjguOTVDMTAwLjc4NiA2NC4wNSAxMTAuODM2IDYxLjYgMTIzLjgzNiA2MS42SDEzNC4xODZDMTM0LjE4NiA1Ni44IDEzMi45MzYgNTMuNCAxMzAuNDM2IDUxLjRDMTI3LjkzNiA0OS40IDEyMy42MzYgNDguNCAxMTcuNTM2IDQ4LjRDMTEyLjYzNiA0OC40IDEwNy44MzYgNDkgMTAzLjEzNiA1MC4yQzk4LjUzNjMgNTEuNCA5My44MzYzIDUzLjMgODkuMDM2MyA1NS45TDg2LjYzNjMgMzkuN0M5MS42MzYzIDM3LjIgOTYuODM2MyAzNS40IDEwMi4yMzYgMzQuM0MxMDcuNzM2IDMzLjEgMTEzLjczNiAzMi41IDEyMC4yMzYgMzIuNUMxMjguNTM2IDMyLjUgMTM1LjE4NiAzMy41IDE0MC4xODYgMzUuNUMxNDUuMjg2IDM3LjUgMTQ4Ljk4NiA0MC43NSAxNTEuMjg2IDQ1LjI1QzE1My41ODYgNDkuNjUgMTU0LjczNiA1NS41IDE1NC43MzYgNjIuOFYxMTJIMTM1LjA4NkwxMzQuOTM2IDEwM0gxMzQuNjM2QzEzMS44MzYgMTA2LjIgMTI3Ljk4NiAxMDguNzUgMTIzLjA4NiAxMTAuNjVDMTE4LjE4NiAxMTIuNTUgMTEzLjE4NiAxMTMuNSAxMDguMDg2IDExMy41Wk0xMTUuNTg2IDk3LjlDMTE5LjA4NiA5Ny45IDEyMi4yMzYgOTcuMyAxMjUuMDM2IDk2LjFDMTI3LjgzNiA5NC45IDEzMC4wMzYgOTMuMjUgMTMxLjYzNiA5MS4xNUMxMzMuMzM2IDg4Ljk1IDEzNC4xODYgODYuNTUgMTM0LjE4NiA4My45NVY3NS4xSDEyNi44MzZDMTE4LjczNiA3NS4xIDExMi42ODYgNzYuMTUgMTA4LjY4NiA3OC4yNUMxMDQuNjg2IDgwLjI1IDEwMi42ODYgODMuNCAxMDIuNjg2IDg3LjdDMTAyLjY4NiA5MC45IDEwMy43ODYgOTMuNCAxMDUuOTg2IDk1LjJDMTA4LjI4NiA5NyAxMTEuNDg2IDk3LjkgMTE1LjU4NiA5Ny45Wk0xODIuMTYxIDExMkwxNTYuMzYxIDM0SDE3OC4yNjFMMTk2LjU2MSA5OC4ySDE5Ni44NjFMMjE1LjAxMSAzNEgyMzYuOTExTDIxMS4xMTEgMTEySDE4Mi4xNjFaTTI0NS41NzggMTEyVjM1LjVIMjY2LjU3OFYxMTJIMjQ1LjU3OFpNMjU2LjA3OCAyNC44NUMyNTIuMTc4IDI0Ljg1IDI0OS4wNzggMjMuOCAyNDYuNzc4IDIxLjdDMjQ0LjQ3OCAxOS41IDI0My4zMjggMTYuNSAyNDMuMzI4IDEyLjdDMjQzLjMyOCA4Ljg5OTk5IDI0NC40NzggNS45NDk5OSAyNDYuNzc4IDMuODVDMjQ5LjA3OCAxLjY1IDI1Mi4xNzggMC41NDk5OTUgMjU2LjA3OCAwLjU0OTk5NUMyNTkuOTc4IDAuNTQ5OTk1IDI2My4wNzggMS42NSAyNjUuMzc4IDMuODVDMjY3LjY3OCA1Ljk0OTk5IDI2OC44MjggOC44OTk5OSAyNjguODI4IDEyLjdDMjY4LjgyOCAxNi41IDI2Ny42NzggMTkuNSAyNjUuMzc4IDIxLjdDMjYzLjA3OCAyMy44IDI1OS45NzggMjQuODUgMjU2LjA3OCAyNC44NVpNMjg0LjYxOCAxMTJWMzRIMzA0LjQxOEwzMDQuNTY4IDQ4LjU1SDMwNS4wMThDMzA3LjYxOCA0NS4wNSAzMTAuNjY4IDQyLjE1IDMxNC4xNjggMzkuODVDMzE3Ljc2OCAzNy40NSAzMjEuNjY4IDM1LjY1IDMyNS44NjggMzQuNDVDMzMwLjE2OCAzMy4xNSAzMzQuNTY4IDMyLjUgMzM5LjA2OCAzMi41VjUwLjA1QzMzMi44NjggNTAuMDUgMzI3LjIxOCA1MS4yIDMyMi4xMTggNTMuNUMzMTcuMDE4IDU1LjggMzEyLjk2OCA1OC45NSAzMDkuOTY4IDYyLjk1QzMwNi45NjggNjYuODUgMzA1LjQ2OCA3MS4yIDMwNS40NjggNzZWMTEySDI4NC42MThaTTM0Ny40OTMgMTEyVjIuNUgzNjguOTQzVjkzLjU1SDQyNS45NDNWMTEySDM0Ny40OTNaTTQ1MS45MTQgMTEzLjVDNDQ0LjIxNCAxMTMuNSA0MzguMTE0IDExMS4zNSA0MzMuNjE0IDEwNy4wNUM0MjkuMjE0IDEwMi43NSA0MjcuMDE0IDk3IDQyNy4wMTQgODkuOEM0MjcuMDE0IDgwLjggNDMwLjUxNCA3My44NSA0MzcuNTE0IDY4Ljk1QzQ0NC42MTQgNjQuMDUgNDU0LjY2NCA2MS42IDQ2Ny42NjQgNjEuNkg0NzguMDE0QzQ3OC4wMTQgNTYuOCA0NzYuNzY0IDUzLjQgNDc0LjI2NCA1MS40QzQ3MS43NjQgNDkuNCA0NjcuNDY0IDQ4LjQgNDYxLjM2NCA0OC40QzQ1Ni40NjQgNDguNCA0NTEuNjY0IDQ5IDQ0Ni45NjQgNTAuMkM0NDIuMzY0IDUxLjQgNDM3LjY2NCA1My4zIDQzMi44NjQgNTUuOUw0MzAuNDY0IDM5LjdDNDM1LjQ2NCAzNy4yIDQ0MC42NjQgMzUuNCA0NDYuMDY0IDM0LjNDNDUxLjU2NCAzMy4xIDQ1Ny41NjQgMzIuNSA0NjQuMDY0IDMyLjVDNDcyLjM2NCAzMi41IDQ3OS4wMTQgMzMuNSA0ODQuMDE0IDM1LjVDNDg5LjExNCAzNy41IDQ5Mi44MTQgNDAuNzUgNDk1LjExNCA0NS4yNUM0OTcuNDE0IDQ5LjY1IDQ5OC41NjQgNTUuNSA0OTguNTY0IDYyLjhWMTEySDQ3OC45MTRMNDc4Ljc2NCAxMDNINDc4LjQ2NEM0NzUuNjY0IDEwNi4yIDQ3MS44MTQgMTA4Ljc1IDQ2Ni45MTQgMTEwLjY1QzQ2Mi4wMTQgMTEyLjU1IDQ1Ny4wMTQgMTEzLjUgNDUxLjkxNCAxMTMuNVpNNDU5LjQxNCA5Ny45QzQ2Mi45MTQgOTcuOSA0NjYuMDY0IDk3LjMgNDY4Ljg2NCA5Ni4xQzQ3MS42NjQgOTQuOSA0NzMuODY0IDkzLjI1IDQ3NS40NjQgOTEuMTVDNDc3LjE2NCA4OC45NSA0NzguMDE0IDg2LjU1IDQ3OC4wMTQgODMuOTVWNzUuMUg0NzAuNjY0QzQ2Mi41NjQgNzUuMSA0NTYuNTE0IDc2LjE1IDQ1Mi41MTQgNzguMjVDNDQ4LjUxNCA4MC4yNSA0NDYuNTE0IDgzLjQgNDQ2LjUxNCA4Ny43QzQ0Ni41MTQgOTAuOSA0NDcuNjE0IDkzLjQgNDQ5LjgxNCA5NS4yQzQ1Mi4xMTQgOTcgNDU1LjMxNCA5Ny45IDQ1OS40MTQgOTcuOVpNNTU2LjY5NiAxMTMuNUM1NTEuNTk2IDExMy41IDU0Ni44OTYgMTEyLjYgNTQyLjU5NiAxMTAuOEM1MzguMjk2IDEwOSA1MzQuNTQ2IDEwNi4zNSA1MzEuMzQ2IDEwMi44NUg1MzEuMDQ2TDUzMC44OTYgMTEySDUxMS4yNDZWMi41SDUzMS45NDZWNDMuMTVINTMyLjI0NkM1MzUuMjQ2IDM5LjU1IDUzOC43OTYgMzYuOSA1NDIuODk2IDM1LjJDNTQ3LjA5NiAzMy40IDU1MS42OTYgMzIuNSA1NTYuNjk2IDMyLjVDNTY2Ljk5NiAzMi41IDU3NC45OTYgMzYuMDUgNTgwLjY5NiA0My4xNUM1ODYuMzk2IDUwLjI1IDU4OS4yNDYgNjAuMiA1ODkuMjQ2IDczQzU4OS4yNDYgODUuOCA1ODYuMzk2IDk1Ljc1IDU4MC42OTYgMTAyLjg1QzU3NC45OTYgMTA5Ljk1IDU2Ni45OTYgMTEzLjUgNTU2LjY5NiAxMTMuNVpNNTUwLjU0NiA5N0M1NTYuNTQ2IDk3IDU2MS4xNDYgOTQuOTUgNTY0LjM0NiA5MC44NUM1NjcuNTQ2IDg2LjY1IDU2OS4xNDYgODAuNyA1NjkuMTQ2IDczQzU2OS4xNDYgNjUuMyA1NjcuNTQ2IDU5LjQgNTY0LjM0NiA1NS4zQzU2MS4xNDYgNTEuMSA1NTYuNTQ2IDQ5IDU1MC41NDYgNDlDNTQ3LjA0NiA0OSA1NDMuODQ2IDQ5Ljc1IDU0MC45NDYgNTEuMjVDNTM4LjE0NiA1Mi43NSA1MzUuOTQ2IDU0LjggNTM0LjM0NiA1Ny40QzUzMi43NDYgNTkuOSA1MzEuOTQ2IDYyLjggNTMxLjk0NiA2Ni4xVjc5LjlDNTMxLjk0NiA4My4yIDUzMi43NDYgODYuMTUgNTM0LjM0NiA4OC43NUM1MzUuOTQ2IDkxLjI1IDUzOC4xNDYgOTMuMjUgNTQwLjk0NiA5NC43NUM1NDMuODQ2IDk2LjI1IDU0Ny4wNDYgOTcgNTUwLjU0NiA5N1oiIGZpbGw9IiMyMDY0ODkiLz4KPC9zdmc+Cg=="
    alt="YavirLab Logo Text"
    class="logo__text"
    width="400"
    height="200"
  />
</div>


        
<div id="adminSetupForm" class="containerForm">
  <h1>⚙️ Налаштування адміністратора</h1>
  <p>База даних порожня. Створіть обліковий запис адміністратора:</p>
  <div class="form-group">
    <label for="adminPassword">Пароль адміністратора:</label>
    <input type="password" id="adminPassword" autocomplete="off" />
  </div>
  <div class="form-group">
    <label for="adminXORKey">Головний XOR ключ:</label>
    <input type="text" id="adminXORKey" autocomplete="off" />
  </div>
  <button onclick="yb()">Створити адміністратора</button>
  <div class="security-info">
    <strong>Важливо:</strong><br />
    • Пароль: мінімум 8 символів<br />
    • XOR ключ: мінімум 16 символів<br />
    • Збережіть ці дані в надійному місці!
  </div>
</div>


        
<div id="loginForm" class="containerForm">
  <h1>🔐 Вхід в систему</h1>
  <div class="form-group">
    <label for="username">Ім'я користувача:</label>
    <input type="text" id="username" autocomplete="off" value="" />
  </div>
  <div class="form-group">
    <label for="password">Пароль:</label>
    <div class="password-wrapper">
      <input type="password" id="password" autocomplete="off" value="" />
      <span
        class="password-toggle-icon"
        onclick="yv('password', this)"
        title="Показати/приховати пароль"
      >
        👁️
      </span>
    </div>
  </div>
  <button onclick="ya()">Увійти</button>
  <div class="info-note">Логін та пароль чутливі до регістру.</div>
</div>


<div id="secureContent" class="containerForm">
  <p>Користувач : <span class="role-badge" id="welcomeUser"></span></p>

  
  <div id="adminMenu" class="menu">
    <h3>🛠️ Панель адміністратора</h3>
    <button class="menu-button" onclick="yn()">
      Створити користувача
    </button>
    <button class="menu-button" onclick="yo()">
      Видалити користувача
    </button>
    <button class="menu-button" onclick="yp()">
      Список користувачів
    </button>
    <button class="menu-button" onclick="yr()">Мій XORKey</button>
  </div>

  
  <div id="workspaceMenu" class="menu">
    <h3>Меню</h3>
    <button
      id="workJournalLink"
      class="menu-button"
      onclick="ys()"
    >
      Робочий журнал
    </button>
    <button
      id="summaryWorkJournalLink"
      class="menu-button"
      onclick="yw()"
      style="display: none"
    >
      Зведений робочий журнал
    </button>
    <button
      id="qualityJournalLink"
      class="menu-button"
      onclick="yx()"
    >
      Журнал якості продукції
    </button>
    <button
      id="moistureJournalLink"
      class="menu-button"
      onclick="yy()"
    >
      Журнал вологості<br />Готова продукція
    </button>
    <button
      id="qualityControlJournalLink"
      class="menu-button"
      onclick="ycs()"
    >
      Журнал оперативно-<br />якісного контролю
    </button>
    <button
      id="consolidatedJournalLink"
      class="menu-button"
      onclick="yaa()"
    >
      Зведений журнал
    </button>
  </div>

  <div class="security-info">
    <strong>Рівень безпеки:</strong><br />
    • SHA-256 хешування<br />
    • XOR шифрування даних<br />
    • Система ролей користувачів<br />
    • Локальна TSV база даних
  </div>

  <button
    onclick="yq()"
    id="showChangePasswordFormLink"
    class="secondary-btn"
  >
    Змінити пароль
  </button>
  <button onclick="yc()" class="secondary-btn">Вийти з системи</button>
</div>


<div id="changePasswordForm" class="containerForm">
  <h1>🔑 Зміна паролю</h1>
  <div class="form-group">
    <label for="currentPassword">Поточний пароль:</label>
    <input type="password" id="currentPassword" autocomplete="off" />
  </div>
  <div class="form-group">
    <label for="newPassword">Новий пароль:</label>
    <input type="password" id="newPassword" autocomplete="off" />
  </div>
  <div class="form-group">
    <label for="confirmPassword">Підтвердіть новий пароль:</label>
    <input type="password" id="confirmPassword" autocomplete="off" />
  </div>
  <button onclick="yd()">Змінити пароль</button>
  <button onclick="yt()" class="back-button">Повернутися</button>

  <div class="security-info">
    <strong>Вимоги до паролю:</strong><br />
    • Мінімум 8 символів<br />
    • Великі та малі літери<br />
    • Цифри та спеціальні символи
  </div>
</div>


        
<div id="createUserForm" class="containerForm">
  <h1>👤 Створити користувача</h1>
  <div class="form-group">
    <label for="newUserName">Ім'я користувача:</label>
    <input type="text" id="newUserName" autocomplete="off" />
  </div>
  <div class="form-group">
    <label for="newUserPassword">Пароль:</label>
    <input type="password" id="newUserPassword" autocomplete="off" />
  </div>
  <div class="form-group">
    <label for="newUserRole">Роль:</label>
    <select id="newUserRole">
      <option value="Guest">Guest (обмежений доступ)</option>
      <option value="User">User (повний доступ)</option>
      <option value="Moderator">Moderator (розширений доступ)</option>
      <option value="Auditor">Auditor (розширений перегляд)</option>
    </select>
  </div>
  <button onclick="yf()">Створити користувача</button>
  <button onclick="yt()" class="back-button">Повернутися</button>

  <div class="security-info">
    <strong>XOR ключі:</strong><br />
    • Guest: перші 8 символів головного ключа<br />
    • User/Moderator: повний головний ключ
  </div>
</div>


<div id="deleteUserForm" class="containerForm">
  <h1>🗑️ Видалити користувача</h1>
  <div class="form-group">
    <label for="deleteUserID">ID користувача для видалення:</label>
    <input type="number" id="deleteUserID" min="2" autocomplete="off" />
  </div>
  <button onclick="yg()" class="danger-button">
    Видалити користувача
  </button>
  <button onclick="yt()" class="back-button">Повернутися</button>

  <div class="security-info">
    <strong>Увага:</strong><br />
    • Неможливо видалити адміністратора (ID=1)<br />
    • Дія незворотна!
  </div>
</div>


<div id="usersListForm" class="containerForm">
  <h1>📋 Список користувачів</h1>
  <div id="usersList">
    <p>Завантаження...</p>
  </div>
  <button onclick="yh()">Оновити список</button>
  <button onclick="yt()" class="back-button">Повернутися</button>
</div>


<div id="myXORKeyForm" class="containerForm">
  <h1>🔑 Мій XORKey</h1>

  <div id="xorKeyGet" style="display: block">
    <div class="form-group">
      <label for="decryptPassword">Введіть ваш пароль для розшифрування:</label>
      <input type="password" id="decryptPassword" autocomplete="off" />
    </div>
    <button onclick="yi()">Показати XORKey</button>
  </div>

  <div id="xorKeyDisplay" style="display: none; margin-top: 20px">
    <div class="security-info">
      <strong>Ваш головний XORKey:</strong><br />
      <textarea
        id="xorKeyValue"
        readonly
        style="
          width: 100%;
          height: 80px;
          margin-top: 10px;
          font-family: monospace;
          font-size: 12px;
        "
      ></textarea>
    </div>
    <button onclick="yj()" style="margin-top: 10px">
      Копіювати в буфер
    </button>
  </div>

  <button onclick="yt()" class="back-button">Повернутися</button>

  <div class="security-info">
    <strong>Безпека:</strong><br />
    • XORKey зберігається в зашифрованому вигляді<br />
    • Для розшифрування потрібен ваш пароль<br />
    • Не передавайте цей ключ сторонім особам
  </div>
</div>


        <div id="workspace" class="workspaceContainer">
  
  <div class="workspace-container">
  <div class="journal-header">
    <button
      class="back-button back-button--journal"
      onclick="yt()"
      tabindex="1"
    >
      ⮪
    </button>
    <h1 class="journal-title">Робочий журнал</h1>
    <div class="journal-controls">
      <div class="control-group">
        <label>Відбір:</label>
        <select class="control-input" id="sampleSelection" tabindex="2">
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5</option>
          <option value="6">6</option>
        </select>
      </div>
      <div class="control-group">
        <label>Зміна:</label>
        <select class="control-input" id="shiftNumber" tabindex="3">
          <option value="1">1</option>
          <option value="2">2</option>
        </select>
      </div>
      <div class="control-group">
        <label>Дата:</label>
        <input
          type="date"
          class="control-input"
          id="journalDate"
          tabindex="4"
        />
      </div>
      <div class="control-group">
        <label>Бригада:</label>
        <input
          type="text"
          class="control-input"
          id="brigadeInfo"
          value="Ушакова"
          tabindex="5"
        />
      </div>
    </div>
  </div>

  <div class="journal-table-container">
    <div id="verifiedDataMessage">Дані верифіковано і не підлягають зміні.</div>

    <table class="journal-table" id="qualityTable">
      <thead>
        <tr>
          <th rowspan="2" class="col-table col-product">
            Назва про&shy;дукції
          </th>
          <th rowspan="2" class="col-table col-bunker">Бункер/ Силос/ Яма</th>
          <th colspan="4">Воло&shy;гість</th>
          <th rowspan="2" class="col-table col-whiteness">Білість, од.</th>
          <th colspan="3">Сира клейко&shy;вина</th>
          <th rowspan="2" class="col-table col-residue">
            Зали&shy;шок на ситі *, %
          </th>
          <th rowspan="2" class="col-table col-passage">
            Прохо&shy;дження через сито **, %
          </th>
          <th rowspan="2" class="col-table col-metal">
            Метало&shy;домішки, мг
          </th>
          <th rowspan="2" class="col-table col-color">Колір, запах, смак</th>
          <th rowspan="2" class="col-table col-crust">Хруст&shy;кість</th>
          <th rowspan="2" class="col-table col-infection">
            Зараже&shy;ність шкідни&shy;ками
          </th>
        </tr>
        <tr>
          <th class="col-table col-sample">№ бюкси</th>
          <th class="col-table col-mass">Маса бюкси з наважкою 500г, мг</th>
          <th class="col-table col-moisture">
            Маса бюкси з наважкою після сушиль&shy;ної шафи, мг
          </th>
          <th class="col-table col-avg-moisture">Середня воло&shy;гість, %</th>
          <th class="col-table col-quantity">Кількість, %</th>
          <th class="col-table col-idk">ІДК, од.</th>
          <th class="col-table col-falling-number">ЧП,с</th>
        </tr>
      </thead>
      <tbody>
        <tr class="product-group-1 product-row" data-product="drama">
          <td rowspan="2" class="product-name">
            <div class="product-name-container">
              I драна
              <button
                class="product-toggle-btn"
                onclick="toggleProductRow('drama')"
                tabindex="-1"
                title="Активувати/деактивувати продукцію"
              ></button>
            </div>
          </td>
          <td rowspan="2"></td>
          <td>
            <select class="table-select" id="drama_sample1" tabindex="26">
              <option value=""></option>
              <option value="1">1</option>
              <option value="4a">4a</option>
              <option value="10a">10a</option>
              <option value="18a">18a</option>
              <option value="1a">1a</option>
              <option value="2a">2a</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="drama_mass1"
              tabindex="41"
              value="1838"
            />
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="drama_dried1"
              tabindex="56"
              value=""
            />
          </td>
          <td rowspan="2">
            <span class="table-text number" id="drama_moisture"> </span>
          </td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
        </tr>
        <tr class="product-group-1 product-row" data-product="drama">
          <td>
            <select class="table-select" id="drama_sample2" tabindex="27">
              <option value=""></option>
              <option value="1">1</option>
              <option value="4a">4a</option>
              <option value="10a">10a</option>
              <option value="18a">18a</option>
              <option value="1a">1a</option>
              <option value="2a">2a</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="drama_mass2"
              tabindex="42"
              value="1842"
            />
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="drama_dried2"
              tabindex="57"
              value=""
            />
          </td>
        </tr>

        <tr class="product-group-2 product-row" data-product="vs">
          <td rowspan="2" class="product-name">
            <div class="product-name-container">
              В/С
              <button
                class="product-toggle-btn"
                onclick="toggleProductRow('vs')"
                tabindex="-1"
                title="Активувати/деактивувати продукцію"
              ></button>
            </div>
          </td>
          <td rowspan="2">
            <select class="table-select" id="vs_bunker" tabindex="6">
              <option value=""></option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
              <option value="7">7</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="10">10</option>
            </select>
          </td>
          <td>
            <select class="table-select" id="vs_sample1" tabindex="28">
              <option value=""></option>
              <option value="1">1</option>
              <option value="4a">4a</option>
              <option value="10a">10a</option>
              <option value="18a">18a</option>
              <option value="1a">1a</option>
              <option value="2a">2a</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="vs_mass1"
              tabindex="43"
              value="1838"
            />
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="vs_dried1"
              tabindex="58"
              value=""
            />
          </td>
          <td rowspan="2">
            <span class="table-text number" id="vs_moisture"> </span>
          </td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="vs_whiteness"
              tabindex="81"
              value=""
            />
          </td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="vs_gluten_quantity"
              tabindex="83"
              step="0.1"
              value=""
            />
          </td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="vs_gluten_idk"
              tabindex="84"
              value=""
            />
          </td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="vs_falling_number"
              tabindex="85"
              value=""
            />
          </td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="vs_residue"
              tabindex="97"
              step="0.1"
              value=""
            />
          </td>
          <td rowspan="2"></td>
          <td rowspan="2">
            <input
              type="text"
              class="table-input text"
              id="vs_metal"
              tabindex="107"
              value="сл."
            />
          </td>
          <td rowspan="2">
            <input
              type="text"
              class="table-input text"
              id="vs_color"
              tabindex="112"
              value="вл."
            />
          </td>
          <td rowspan="2">
            <input
              type="text"
              class="table-input text"
              id="vs_crunch"
              tabindex="117"
              value="н/в"
            />
          </td>
          <td rowspan="2"></td>
        </tr>
        <tr class="product-group-2 product-row" data-product="vs">
          <td>
            <select class="table-select" id="vs_sample2" tabindex="29">
              <option value=""></option>
              <option value="1">1</option>
              <option value="4a">4a</option>
              <option value="10a">10a</option>
              <option value="18a">18a</option>
              <option value="1a">1a</option>
              <option value="2a">2a</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="vs_mass2"
              tabindex="44"
              value="1842"
            />
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="vs_dried2"
              tabindex="59"
              value=""
            />
          </td>
        </tr>

        <tr class="product-group-3 product-row" data-product="first">
          <td rowspan="2" class="product-name">
            <div class="product-name-container">
              1/С
              <button
                class="product-toggle-btn"
                onclick="toggleProductRow('first')"
                tabindex="-1"
                title="Активувати/деактивувати продукцію"
              ></button>
            </div>
          </td>
          <td rowspan="2">
            <select class="table-select" id="first_bunker" tabindex="7">
              <option value=""></option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
              <option value="7">7</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="10">10</option>
            </select>
          </td>
          <td>
            <select class="table-select" id="first_sample1" tabindex="30">
              <option value=""></option>
              <option value="1">1</option>
              <option value="4a">4a</option>
              <option value="10a">10a</option>
              <option value="18a">18a</option>
              <option value="1a">1a</option>
              <option value="2a">2a</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="first_mass1"
              tabindex="45"
              value="1838"
            />
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="first_dried1"
              tabindex="60"
              value=""
            />
          </td>
          <td rowspan="2">
            <span class="table-text number" id="first_moisture"> </span>
          </td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="first_whiteness"
              tabindex="82"
              value=""
            />
          </td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="first_gluten_quantity"
              tabindex="86"
              step="0.1"
              value=""
            />
          </td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="first_gluten_idk"
              tabindex="87"
              value=""
            />
          </td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="first_falling_number"
              tabindex="88"
              value=""
            />
          </td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="first_residue"
              tabindex="98"
              step="0.1"
              value=""
            />
          </td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="first_passage"
              tabindex="103"
              step="0.1"
              value="92.4"
            />
          </td>
          <td rowspan="2">
            <input
              type="text"
              class="table-input text"
              id="first_metal"
              tabindex="108"
              value="сл."
            />
          </td>
          <td rowspan="2">
            <input
              type="text"
              class="table-input text"
              id="first_color"
              tabindex="113"
              value="вл."
            />
          </td>
          <td rowspan="2">
            <input
              type="text"
              class="table-input text"
              id="first_crunch"
              tabindex="118"
              value="н/в"
            />
          </td>
          <td rowspan="2"></td>
        </tr>
        <tr class="product-group-3 product-row" data-product="first">
          <td>
            <select class="table-select" id="first_sample2" tabindex="31">
              <option value=""></option>
              <option value="1">1</option>
              <option value="4a">4a</option>
              <option value="10a">10a</option>
              <option value="18a">18a</option>
              <option <option value="1a">1a</option>
              <option value="2a">2a</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="first_mass2"
              tabindex="46"
              value="1842"
            />
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="first_dried2"
              tabindex="61"
              value=""
            />
          </td>
        </tr>

        <tr class="product-group-2 product-row" data-product="bran">
          <td rowspan="2" class="product-name">
            <div class="product-name-container">
              Висівки
              <button
                class="product-toggle-btn"
                onclick="toggleProductRow('bran')"
                tabindex="-1"
                title="Активувати/деактивувати продукцію"
              ></button>
            </div>
          </td>
          <td rowspan="2">
            <select class="table-select" id="bran_bunker" tabindex="8">
              <option value=""></option>
              <option value="11">11</option>
              <option value="12">12</option>
              <option value="13">13</option>
              <option value="14">14</option>
            </select>
          </td>
          <td>
            <select class="table-select" id="bran_sample1" tabindex="32">
              <option value=""></option>
              <option value="1">1</option>
              <option value="4a">4a</option>
              <option value="10a">10a</option>
              <option value="18a">18a</option>
              <option value="1a">1a</option>
              <option value="2a">2a</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="bran_mass1"
              tabindex="47"
              value="1838"
            />
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="bran_dried1"
              tabindex="62"
              value=""
            />
          </td>
          <td rowspan="2">
            <span class="table-text number" id="bran_moisture"> </span>
          </td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="bran_passage"
              tabindex="104"
              step="0.1"
              value="10.5"
            />
          </td>
          <td rowspan="2">
            <input
              type="text"
              class="table-input text"
              id="bran_metal"
              tabindex="109"
              value="сл."
            />
          </td>
          <td rowspan="2">
            <input
              type="text"
              class="table-input text"
              id="bran_color"
              tabindex="114"
              value="вл."
            />
          </td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
        </tr>
        <tr class="product-group-2 product-row" data-product="bran">
          <td>
            <select class="table-select" id="bran_sample2" tabindex="33">
              <option value=""></option>
              <option value="1">1</option>
              <option value="4a">4a</option>
              <option value="10a">10a</option>
              <option value="18a">18a</option>
              <option value="1a">1a</option>
              <option value="2a">2a</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="bran_mass2"
              tabindex="48"
              value="1842"
            />
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="bran_dried2"
              tabindex="63"
              value=""
            />
          </td>
        </tr>

        <tr class="product-group-3 product-row" data-product="feed">
          <td rowspan="2" class="product-name">
            <div class="product-name-container">
              Подача
              <button
                class="product-toggle-btn"
                onclick="toggleProductRow('feed')"
                tabindex="-1"
                title="Активувати/деактивувати продукцію"
              ></button>
            </div>
          </td>
          <td rowspan="2">
            <select class="table-select" id="feed_bunker" tabindex="9">
              <option value=""></option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
            </select>
          </td>
          <td>
            <select class="table-select" id="feed_sample1" tabindex="34">
              <option value=""></option>
              <option value="1">1</option>
              <option value="4a">4a</option>
              <option value="10a">10a</option>
              <option value="18a">18a</option>
              <option value="1a">1a</option>
              <option value="2a">2a</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="feed_mass1"
              tabindex="49"
              value="1816"
            />
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="feed_dried1"
              tabindex="64"
              value=""
            />
          </td>
          <td rowspan="2">
            <span class="table-text number" id="feed_moisture"> </span>
          </td>
          <td rowspan="2"></td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="feed_gluten_quantity"
              tabindex="89"
              step="0.1"
              value=""
            />
          </td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="feed_gluten_idk"
              tabindex="90"
              value=""
            />
          </td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="feed_falling_number"
              tabindex="91"
              value=""
            />
          </td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2">
            <input
              type="text"
              class="table-input text"
              id="feed_color"
              tabindex="115"
              value="вл."
            />
          </td>
          <td rowspan="2"></td>
          <td rowspan="2">
            <input
              type="text"
              class="table-input text"
              id="feed_infection"
              tabindex="120"
              value="н/в"
            />
          </td>
        </tr>
        <tr class="product-group-3 product-row" data-product="feed">
          <td>
            <select class="table-select" id="feed_sample2" tabindex="35">
              <option value=""></option>
              <option value="1">1</option>
              <option value="4a">4a</option>
              <option value="10a">10a</option>
              <option value="18a">18a</option>
              <option value="1a">1a</option>
              <option value="2a">2a</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="feed_mass2"
              tabindex="50"
              value="1808"
            />
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="feed_dried2"
              tabindex="65"
              value=""
            />
          </td>
        </tr>

        <tr class="product-group-2 product-row" data-product="soak">
          <td rowspan="2" class="product-name">
            <div class="product-name-container">
              I Замочка
              <button
                class="product-toggle-btn"
                onclick="toggleProductRow('soak')"
                tabindex="-1"
                title="Активувати/деактивувати продукцію"
              ></button>
            </div>
          </td>
          <td rowspan="2">
            <select class="table-select" id="soak_bunker" tabindex="10">
              <option value=""></option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
              <option value="1а">1а</option>
              <option value="2а">2а</option>
              <option value="3а">3а</option>
              <option value="4а">4а</option>
              <option value="5а">5а</option>
              <option value="6а">6а</option>
            </select>
          </td>
          <td>
            <select class="table-select" id="soak_sample1" tabindex="36">
              <option value=""></option>
              <option value="1">1</option>
              <option value="4a">4a</option>
              <option value="10a">10a</option>
              <option value="18a">18a</option>
              <option value="1a">1a</option>
              <option value="2a">2a</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="soak_mass1"
              tabindex="51"
              value="1865"
            />
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="soak_dried1"
              tabindex="66"
              value=""
            />
          </td>
          <td rowspan="2">
            <span class="table-text number" id="soak_moisture"></span>
          </td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
        </tr>
        <tr class="product-group-2 product-row" data-product="soak">
          <td>
            <select class="table-select" id="soak_sample2" tabindex="37">
              <option value=""></option>
              <option value="1">1</option>
              <option value="4a">4a</option>
              <option value="10a">10a</option>
              <option value="18a">18a</option>
              <option value="1a">1a</option>
              <option value="2a">2a</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="soak_mass2"
              tabindex="52"
              value="1872"
            />
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="soak_dried2"
              tabindex="67"
              value=""
            />
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="journal-footer">
    <div class="journal-notes sieve">
      <strong>* Залишок на ситі №43 для В/С та №35 для 1/С</strong><br />
      <strong>** Прохід через сито №43 для 1/С та №27 для Висівок</strong>
    </div>
    <div class="footer-buttons">
      <button
        class="save-btn"
        onclick="ycp()"
        tabindex="121"
      >
        Зберегти</button
      ><button
        id="deleteSampleBtn"
        class="danger-btn"
        onclick="yce()"
        tabindex="122"
        style="display: none"
      >
        Видалити відбір
      </button>
    </div>
  </div>
</div>

</div>

<div id="summaryWorkspace" class="workspaceContainer">
  
  <div class="workspace-container">
  <div class="journal-header">
    <button
      class="back-button back-button--journal"
      onclick="yt()"
      tabindex="1"
    >
      ⮪
    </button>
    <h1 class="journal-title">Зведений робочий журнал</h1>
    <div class="journal-controls">
      <div class="control-group">
        <label>Зміна:</label>
        <select class="control-input" id="summaryWorkShiftNumber" tabindex="2">
          <option value="1">1</option>
          <option value="2">2</option>
        </select>
      </div>
      <div class="control-group">
        <label>Дата:</label>
        <input
          type="date"
          class="control-input"
          id="summaryWorkJournalDate"
          tabindex="3"
        />
      </div>
      <div class="control-group">
        <label>Бригада:</label>
        <input
          type="text"
          class="control-input"
          id="summaryWorkBrigadeInfo"
          readonly
          tabindex="4"
        />
      </div>
    </div>
  </div>

  <div class="unverified-shifts-container" id="unverifiedShiftsContainer">
    <h3>Неверифіковані зміни:</h3>
    <ul id="unverifiedShiftsList"></ul>
  </div>

  <div class="journal-table-container">
    <div id="summaryWorkTablesContainer"></div>
  </div>

  <div class="journal-footer" id="summaryWorkFooter">
    <div class="journal-notes">
      <strong id="verificationMessage"
        >Перевірте дані та підтвердіть їх правильність</strong
      >
    </div>
    <div class="footer-buttons">
      <button class="save-btn" onclick="verifySummaryWorkData()" tabindex="120">
        Підтвердити
      </button>
    </div>
  </div>
</div>

</div>

<div id="qualityJournal" class="workspaceContainer">
  <div class="workspace-container">
  <div class="journal-header">
    <button
      class="back-button back-button--journal"
      onclick="yt()"
      tabindex="1"
    >
      &#x2BAA;
    </button>
    <h1 class="journal-title">Журнал якості продукції</h1>

    <div class="journal-controls">
      <button
        class="pagination-btn chart-btn"
        id="openChartBtn"
        onclick="ydd()"
        title="Показати графік"
        style="display: none"
      >
        📈
      </button>
      <div class="pagination-controls">
        <button
          class="pagination-btn"
          onclick="changeQualityJournalMonth(-1)"
          title="Попередній місяць"
        >
          &lt;
        </button>
        <span id="qualityJournalMonthDisplay" class="month-display"></span>
        <button
          class="pagination-btn"
          onclick="changeQualityJournalMonth(1)"
          title="Наступний місяць"
        >
          &gt;
        </button>
      </div>
    </div>
  </div>

  <div class="journal-table-container">
    <div
      id="quality-journal-no-data"
      style="
        display: none;
        text-align: center;
        padding: 40px;
        font-size: 16px;
        color: #757575;
      "
    >
      Дані за поточний період відсутні.
    </div>
    <table
      class="journal-table quality-journal-table"
      id="quality-journal-table"
    >
      <thead>
        <tr>
          <th rowspan="2">Дата</th>
          <th rowspan="2">Бригада</th>
          <th colspan="4">Якість зерна</th>
          <th>I драна</th>
          <th colspan="6">Бо&shy;рош&shy;но В/С</th>
          <th colspan="7">Бо&shy;рош&shy;но 1/С</th>
          <th colspan="2">Ви&shy;сів&shy;ки</th>
        </tr>
        <tr>
          <th class="rotated-text"><div>Во&shy;ло&shy;гість, %</div></th>
          <th class="rotated-text">
            <div>Си&shy;рої клей&shy;ко&shy;ви&shy;ни, %</div>
          </th>
          <th class="rotated-text"><div>ІДК, од.</div></th>
          <th class="rotated-text">
            <div>Чис&shy;ло па&shy;дін&shy;ня, с</div>
          </th>
          <th class="rotated-text"><div>Во&shy;ло&shy;гі&shy;сть, %</div></th>
          <th class="rotated-text"><div>Во&shy;ло&shy;гі&shy;сть, %</div></th>
          <th class="rotated-text"><div>Бі&shy;лі&shy;сть, од.</div></th>
          <th class="rotated-text">
            <div>Си&shy;рої клей&shy;ко&shy;ви&shy;ни, %</div>
          </th>
          <th class="rotated-text"><div>ІДК, од.</div></th>
          <th class="rotated-text">
            <div>Чис&shy;ло па&shy;дін&shy;ня, с</div>
          </th>
          <th class="rotated-text">
            <div>За&shy;ли&shy;шок на си&shy;ті*, %</div>
          </th>
          <th class="rotated-text"><div>Во&shy;ло&shy;гі&shy;сть, %</div></th>
          <th class="rotated-text"><div>Бі&shy;лі&shy;сть, од.</div></th>
          <th class="rotated-text">
            <div>Си&shy;рої клей&shy;ко&shy;ви&shy;ни, %</div>
          </th>
          <th class="rotated-text"><div>ІДК, од.</div></th>
          <th class="rotated-text">
            <div>Чис&shy;ло па&shy;дін&shy;ня, с</div>
          </th>
          <th class="rotated-text">
            <div>За&shy;ли&shy;шок на си&shy;ті*, %</div>
          </th>
          <th class="rotated-text">
            <div>Про&shy;ход&shy;жен&shy;ня че&shy;рез си&shy;то**, %</div>
          </th>
          <th class="rotated-text"><div>Во&shy;ло&shy;гі&shy;сть, %</div></th>
          <th class="rotated-text">
            <div>Про&shy;ход&shy;жен&shy;ня че&shy;рез си&shy;то**, %</div>
          </th>
        </tr>
      </thead>
      <tbody id="quality-journal-body"></tbody>
      <tfoot id="quality-journal-footer">
        <tr>
          <td colspan="2" class="footer-title">Середнє за період:</td>
          <td class="footer-value" id="avg-feed_moisture"></td>
          <td class="footer-value" id="avg-feed_gluten"></td>
          <td class="footer-value" id="avg-feed_idk"></td>
          <td class="footer-value" id="avg-feed_falling_number"></td>
          <td class="footer-value" id="avg-drana_moisture"></td>
          <td class="footer-value" id="avg-vs_moisture"></td>
          <td class="footer-value" id="avg-vs_whiteness"></td>
          <td class="footer-value" id="avg-vs_gluten"></td>
          <td class="footer-value" id="avg-vs_idk"></td>
          <td class="footer-value" id="avg-vs_falling_number"></td>
          <td class="footer-value" id="avg-vs_residue"></td>
          <td class="footer-value" id="avg-first_moisture"></td>
          <td class="footer-value" id="avg-first_whiteness"></td>
          <td class="footer-value" id="avg-first_gluten"></td>
          <td class="footer-value" id="avg-first_idk"></td>
          <td class="footer-value" id="avg-first_falling_number"></td>
          <td class="footer-value" id="avg-first_residue"></td>
          <td class="footer-value" id="avg-first_passage"></td>
          <td class="footer-value" id="avg-bran_moisture"></td>
          <td class="footer-value" id="avg-bran_passage"></td>
        </tr>
      </tfoot>
    </table>
  </div>
</div>

<div id="qualityChartModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Графік показників якості</h2>
      <button class="modal-close" onclick="yde()">
        &times;
      </button>
    </div>
    <div class="modal-body">
      <div class="control-group">
        <label class="metric-select-label" for="chartMetricSelect"
          >Виберіть показник:</label
        >
        <select id="chartMetricSelect">
          <option value="Вологість, %">Вологість, %</option>
          <option value="Сирої клейковини, %">Сирої клейковини, %</option>
          <option value="ІДК, од.">ІДК, од.</option>
          <option value="Число падіння, с">Число падіння, с</option>
          <option value="Білість, од.">Білість, од.</option>
          <option value="Залишок на ситі*, %">Залишок на ситі*, %</option>
          <option value="Проходження через сито**, %">
            Проходження через сито**, %
          </option>
        </select>
      </div>
      <div id="qualityChartContainer">
        <canvas id="qualityLineChart"></canvas>
      </div>
    </div>
  </div>
</div>

<div id="bunkerDetailsModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2 id="bunkerDetailsModalTitle">Середні показники по бункерах</h2>
      <button class="modal-close" onclick="closeBunkerDetailsModal()">
        &times;
      </button>
    </div>
    <div class="modal-body" id="bunkerDetailsModalBody">
      <p>Завантаження даних...</p>
    </div>
  </div>
</div>

</div>

<div id="moistureJournal" class="workspaceContainer">
  
  
<div class="workspace-container">
  <div class="journal-header">
    <button
      class="back-button back-button--journal"
      onclick="yt()"
      tabindex="1"
    >
      ⮪
    </button>
    <h1 class="journal-title">Журнал вологості готової продукції</h1>
    <div class="journal-controls">
      <div class="control-group">
        <label>Зміна:</label>
        <select
          class="control-input"
          id="moistureJournalShiftNumber"
          tabindex="2"
        >
          <option value="1">1</option>
          <option value="2">2</option>
        </select>
      </div>
      <div class="control-group">
        <label>Дата:</label>
        <input
          type="date"
          class="control-input"
          id="moistureJournalDate"
          tabindex="3"
        />
      </div>
    </div>
  </div>

  <div class="journal-info-bar">
    <p class="journal-info-bar__item journal-info-bar__brigade">
      <strong>Бригада:</strong>
      <span id="moistureJournalBrigadeInfo">-</span>
    </p>
    <p class="journal-info-bar__item">
      <strong>Лаборант:</strong>
      <span id="moistureJournalLabTechnicianInfo">-</span>
    </p>
  </div>

  <div class="journal-table-container">
    <div id="moistureJournalTablesContainer">
      <p>Дані відсутні для вибраної дати та зміни.</p>
    </div>
  </div>
</div>

</div>

<div id="qualityControlJournal" class="workspaceContainer">
  
  <div class="workspace-container">
  <div class="journal-header">
    <button
      class="back-button back-button--journal"
      onclick="yt()"
      tabindex="1"
    >
      ⮪
    </button>
    <h1 class="journal-title">Журнал оперативно-якісного контролю</h1>
    <div class="journal-controls">
      <div class="control-group">
        <label>Зміна:</label>
        <select
          class="control-input"
          id="qualityControlShiftNumber"
          tabindex="2"
        >
          <option value="1">1</option>
          <option value="2">2</option>
        </select>
      </div>
      <div class="control-group">
        <label>Дата:</label>
        <input
          type="date"
          class="control-input"
          id="qualityControlJournalDate"
          tabindex="3"
        />
      </div>
    </div>
  </div>

  <div class="journal-info-bar">
    <p class="journal-info-bar__item journal-info-bar__brigade">
      <strong>Бригада:</strong>
      <span id="qualityControlBrigadeInfo">-</span>
    </p>
    <p class="journal-info-bar__item">
      <strong>Лаборант:</strong>
      <span id="qualityControlLabTechnicianInfo">-</span>
    </p>
  </div>

  <div class="journal-table-container" id="qualityControlTablesContainer">
    <p id="qc-no-data-message" style="display: none">
      Дані відсутні для вибраної дати та зміни.
    </p>

    <div class="qc-section">
      <h2 class="qc-section-title">1. ЯКІСТЬ ЗЕРНА</h2>
      <table class="journal-table qc-table">
        <thead>
          <tr>
            <th rowspan="2">Показники якості</th>
            <th colspan="2">До очищення</th>
            <th colspan="2">Після очищення</th>
          </tr>
          <tr>
            <th>Попереднє</th>
            <th>Середньо&shy;змінне</th>
            <th>Попереднє</th>
            <th>Середньо&shy;змінне</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Воло&shy;гість, %</td>
            <td id="qc_grain_feed_moisture_prelim">-</td>
            <td id="qc_grain_feed_moisture_avg">-</td>
            <td id="qc_grain_drana_moisture_prelim">-</td>
            <td id="qc_grain_drana_moisture_avg">-</td>
          </tr>
          <tr>
            <td>Сирої клейко&shy;вини, %</td>
            <td id="qc_grain_feed_gluten_quantity_prelim">-</td>
            <td id="qc_grain_feed_gluten_quantity_avg">-</td>
            <td id="qc_grain_drana_gluten_quantity_prelim">-</td>
            <td id="qc_grain_drana_gluten_quantity_avg">-</td>
          </tr>
          <tr>
            <td>ІДК, од.</td>
            <td id="qc_grain_feed_gluten_idk_prelim">-</td>
            <td id="qc_grain_feed_gluten_idk_avg">-</td>
            <td id="qc_grain_drana_gluten_idk_prelim">-</td>
            <td id="qc_grain_drana_gluten_idk_avg">-</td>
          </tr>
          <tr>
            <td>Число падіння, с</td>
            <td id="qc_grain_feed_falling_number_prelim">-</td>
            <td id="qc_grain_feed_falling_number_avg">-</td>
            <td id="qc_grain_drana_falling_number_prelim">-</td>
            <td id="qc_grain_drana_falling_number_avg">-</td>
          </tr>
          <tr>
            <td>Зараже&shy;ність шкідни&shy;ками</td>
            <td id="qc_grain_feed_infection_prelim">-</td>
            <td id="qc_grain_feed_infection_avg">-</td>
            <td id="qc_grain_drana_infection_prelim">-</td>
            <td id="qc_grain_drana_infection_avg">-</td>
          </tr>
          <tr>
            <td>Запах, смак, колір</td>
            <td id="qc_grain_feed_color_prelim">-</td>
            <td id="qc_grain_feed_color_avg">-</td>
            <td id="qc_grain_drana_color_prelim">-</td>
            <td id="qc_grain_drana_color_avg">-</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="qc-section">
      <h2 class="qc-section-title">2. ЯКІСТЬ ПРОДУКЦІЇ</h2>
      <table class="journal-table qc-table">
        <thead>
          <tr>
            <th rowspan="2">Показ&shy;ники якос&shy;ті</th>
            <th colspan="2">Борошно В/С</th>
            <th colspan="2">Борошно 1/С</th>
            <th colspan="2">Висівки</th>
          </tr>
          <tr>
            <th>Попереднє</th>
            <th>Середньо&shy;змінне</th>
            <th>Попереднє</th>
            <th>Середньо&shy;змінне</th>
            <th>Попереднє</th>
            <th>Середньо&shy;змінне</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Воло&shy;гість, %</td>
            <td id="qc_prod_vs_moisture_prelim">-</td>
            <td id="qc_prod_vs_moisture_avg">-</td>
            <td id="qc_prod_first_moisture_prelim">-</td>
            <td id="qc_prod_first_moisture_avg">-</td>
            <td id="qc_prod_bran_moisture_prelim">-</td>
            <td id="qc_prod_bran_moisture_avg">-</td>
          </tr>
          <tr>
            <td>Білість, од.</td>
            <td id="qc_prod_vs_whiteness_prelim">-</td>
            <td id="qc_prod_vs_whiteness_avg">-</td>
            <td id="qc_prod_first_whiteness_prelim">-</td>
            <td id="qc_prod_first_whiteness_avg">-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Сирої клейко&shy;вини, %</td>
            <td id="qc_prod_vs_gluten_quantity_prelim">-</td>
            <td id="qc_prod_vs_gluten_quantity_avg">-</td>
            <td id="qc_prod_first_gluten_quantity_prelim">-</td>
            <td id="qc_prod_first_gluten_quantity_avg">-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>ІДК, од.</td>
            <td id="qc_prod_vs_gluten_idk_prelim">-</td>
            <td id="qc_prod_vs_gluten_idk_avg">-</td>
            <td id="qc_prod_first_gluten_idk_prelim">-</td>
            <td id="qc_prod_first_gluten_idk_avg">-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Число падіння, с</td>
            <td id="qc_prod_vs_falling_number_prelim">-</td>
            <td id="qc_prod_vs_falling_number_avg">-</td>
            <td id="qc_prod_first_falling_number_prelim">-</td>
            <td id="qc_prod_first_falling_number_avg">-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Зали&shy;шок на ситі *, %</td>
            <td id="qc_prod_vs_residue_prelim">-</td>
            <td id="qc_prod_vs_residue_avg">-</td>
            <td id="qc_prod_first_residue_prelim">-</td>
            <td id="qc_prod_first_residue_avg">-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Проходже&shy;ння через сито **, %</td>
            <td>-</td>
            <td>-</td>
            <td id="qc_prod_first_passage_prelim">-</td>
            <td id="qc_prod_first_passage_avg">-</td>
            <td id="qc_prod_bran_passage_prelim">-</td>
            <td id="qc_prod_bran_passage_avg">-</td>
          </tr>
          <tr>
            <td>Метало&shy;доміш&shy;ки, мг</td>
            <td id="qc_prod_vs_metal_prelim">-</td>
            <td id="qc_prod_vs_metal_avg">-</td>
            <td id="qc_prod_first_metal_prelim">-</td>
            <td id="qc_prod_first_metal_avg">-</td>
            <td id="qc_prod_bran_metal_prelim">-</td>
            <td id="qc_prod_bran_metal_avg">-</td>
          </tr>
          <tr>
            <td>Хруст&shy;кість</td>
            <td id="qc_prod_vs_crunch_prelim">-</td>
            <td id="qc_prod_vs_crunch_avg">-</td>
            <td id="qc_prod_first_crunch_prelim">-</td>
            <td id="qc_prod_first_crunch_avg">-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Запах, смак, колір</td>
            <td id="qc_prod_vs_color_prelim">-</td>
            <td id="qc_prod_vs_color_avg">-</td>
            <td id="qc_prod_first_color_prelim">-</td>
            <td id="qc_prod_first_color_avg">-</td>
            <td id="qc_prod_bran_color_prelim">-</td>
            <td id="qc_prod_bran_color_avg">-</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

</div>

<div id="consolidatedJournal" class="workspaceContainer">
  
  <div class="workspace-container">
  <div class="journal-header">
    <button
      class="back-button back-button--journal"
      onclick="yt()"
      tabindex="1"
    >
      &#x2BAA;
    </button>
    <h1 class="journal-title">Зведений журнал</h1>

    <div class="journal-controls">
      <button
        class="pagination-btn"
        onclick="changeMonth(-1)"
        title="Попередній місяць"
      >
        &lt;
      </button>
      <span id="currentMonthDisplay" class="month-display"></span>
      <button
        class="pagination-btn"
        onclick="changeMonth(1)"
        title="Наступний місяць"
      >
        &gt;
      </button>
    </div>
  </div>

  <div class="journal-table-container">
    <div
      id="consolidated-no-data"
      style="
        display: none;
        text-align: center;
        padding: 40px;
        font-size: 16px;
        color: #757575;
      "
    >
      Дані за поточний період відсутні.
    </div>
    <table class="journal-table consolidated-table" id="consolidated-table">
      <thead>
        <tr>
          <th rowspan="2">Дата</th>
          <th rowspan="2">Бригада</th>
          <th>I драна</th>
          <th colspan="6">Борошно В/С</th>
          <th colspan="7">Борошно 1/С</th>
          <th colspan="2">Висівки</th>
        </tr>
        <tr>
          <th>Воло&shy;гість, %</th>
          <th>Воло&shy;гість, %</th>
          <th>Білість, од.</th>
          <th>Метало&shy;доміш&shy;ки, мг</th>
          <th>Зали&shy;шок на ситі*, %</th>
          <th>Сирої клейко&shy;вини, %</th>
          <th>ІДК, од.</th>
          <th>Воло&shy;гість, %</th>
          <th>Білість, од.</th>
          <th>Метало&shy;доміш&shy;ки, мг</th>
          <th>Зали&shy;шок на ситі*, %</th>
          <th>Проход&shy;ження через сито**, %</th>
          <th>Сирої клейко&shy;вини, %</th>
          <th>ІДК, од.</th>
          <th>Воло&shy;гість, %</th>
          <th>Метало&shy;доміш&shy;ки, мг</th>
        </tr>
      </thead>
      <tbody id="consolidated-journal-body"></tbody>
    </table>
  </div>
</div>

</div>

    </div>
    <div class="promo-box__footer" id="promoBoxFooter">
      <p class="footer-signature" id="footer-signature"></p>
      <p class="promo-box__footer-text">Створено <a href="mailto:m.a.startsev@gmail.com" title="Зв'язатися з розробником">M. Startsev</a> - 2025</p>
    </div>
</body>
<script language="JavaScript">
function ycx(t,e,n){e=e===undefined?1:e;var i=t.filter(function(t){return null!==t&&t!==undefined&&""!==t});if(0===i.length)return"-";var a=i.map(function(t){return"string"==typeof t?parseFloat(t.replace(",",".").replace(/[^\d.-]/g,"")):parseFloat(t)}).filter(function(t){return!isNaN(t)});return n?a.length>0?(a.reduce(function(t,e){return t+e},0)/a.length).toFixed(e):i[0]:0===a.length?"-":(a.reduce(function(t,e){return t+e},0)/a.length).toFixed(e)}function ydc(t,e,n){if(!t)return"-";for(var i=[],a=1;a<=6;a++)t[a]&&t[a][e]&&i.push(t[a][e]);return ycx(i,n,!1)}function yab(t){function e(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function n(t,e){return t>>>e|t<<32-e}function i(t,e){return t>>>e}function a(t,e,n){return t&e^~t&n}function s(t,e,n){return t&e^t&n^e&n}function o(t){return n(t,2)^n(t,13)^n(t,22)}function r(t){return n(t,6)^n(t,11)^n(t,25)}function l(t){return n(t,7)^n(t,18)^i(t,3)}function c(t){return n(t,17)^n(t,19)^i(t,10)}return function(t){for(var e="0123456789abcdef",n="",i=0;i<4*t.length;i++)n+=e.charAt(t[i>>2]>>8*(3-i%4)+4&15)+e.charAt(t[i>>2]>>8*(3-i%4)&15);return n}(function(t,n){var i,u,h,d,f,g,p,m,y,v,b,w,S=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],C=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],x=new Array(64);for(t[n>>5]|=128<<24-n%32,t[15+(n+64>>9<<4)]=n,y=0;y<t.length;y+=16){for(i=C[0],u=C[1],h=C[2],d=C[3],f=C[4],g=C[5],p=C[6],m=C[7],v=0;v<64;v++)x[v]=v<16?t[v+y]:e(e(e(c(x[v-2]),x[v-7]),l(x[v-15])),x[v-16]),b=e(e(e(e(m,r(f)),a(f,g,p)),S[v]),x[v]),w=e(o(i),s(i,u,h)),m=p,p=g,g=f,f=e(d,b),d=h,h=u,u=i,i=e(b,w);C[0]=e(i,C[0]),C[1]=e(u,C[1]),C[2]=e(h,C[2]),C[3]=e(d,C[3]),C[4]=e(f,C[4]),C[5]=e(g,C[5]),C[6]=e(p,C[6]),C[7]=e(m,C[7])}return C}(function(t){for(var e=Array(),n=0;n<8*t.length;n+=8)e[n>>5]|=(255&t.charCodeAt(n/8))<<24-n%32;return e}(t),8*t.length))}function yac(){for(var t="",e=0;e<16;e++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return t}function yad(t,e){return yab(e+t+e)}function yae(t){var e=0;return t.length>=8&&e++,/[a-z]/.test(t)&&e++,/[A-Z]/.test(t)&&e++,/[0-9]/.test(t)&&e++,/[^A-Za-z0-9]/.test(t)&&e++,e}function yaf(t,e){if(!t||!e)throw new Error("Plaintext and key are required");for(var n=yak(t),i=yak(e),a=[],s=0;s<n.length;s++){var o=i[s%i.length];a.push(n[s]^o)}for(var r="",l=0;l<a.length;l++)r+=String.fromCharCode(a[l]);return yai(r)}function yag(t,e){if(!t||!e)throw new Error("Encrypted data and key are required");try{for(var n=yaj(t),i=[],a=0;a<n.length;a++)i.push(n.charCodeAt(a));for(var s=yak(e),o=[],r=0;r<i.length;r++){var l=s[r%s.length];o.push(i[r]^l)}return yal(o)}catch(c){throw new Error("Decryption failed: "+c.message)}}function yah(t){t=t||32;for(var e="",n=0;n<t;n++)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*".charAt(Math.floor(70*Math.random()));return e}function yai(t){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",i=0;i<t.length;){var a=t.charCodeAt(i++)<<16|(i<t.length?t.charCodeAt(i++):0)<<8|(i<t.length?t.charCodeAt(i++):0);n+=e.charAt(a>>18&63),n+=e.charAt(a>>12&63),n+=i-2<t.length?e.charAt(a>>6&63):"=",n+=i-1<t.length?e.charAt(63&a):"="}return n}function yaj(t){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",i=0;for(t=t.replace(/[^A-Za-z0-9+/]/g,"");i<t.length;){var a=e.indexOf(t.charAt(i++)),s=e.indexOf(t.charAt(i++)),o=e.indexOf(t.charAt(i++)),r=e.indexOf(t.charAt(i++)),l=a<<18|s<<12|o<<6|r;n+=String.fromCharCode(l>>16&255),64!==o&&(n+=String.fromCharCode(l>>8&255)),64!==r&&(n+=String.fromCharCode(255&l))}return n}function yak(t){for(var e=[],n=0;n<t.length;n++){var i=t.charCodeAt(n);i<128?e.push(i):i<2048?(e.push(192|i>>6),e.push(128|63&i)):(e.push(224|i>>12),e.push(128|i>>6&63),e.push(128|63&i))}return e}function yal(t){for(var e="",n=0;n<t.length;){var i=t[n++];if(i<128)e+=String.fromCharCode(i);else if(192==(224&i)){var a=t[n++];e+=String.fromCharCode((31&i)<<6|63&a)}else if(224==(240&i)){a=t[n++];var s=t[n++];e+=String.fromCharCode((15&i)<<12|(63&a)<<6|63&s)}}return e}function ye(t){return t.replace(/^\s+|\s+$/g,"")}function yb(){var t=document.getElementById("adminPassword").value,e=document.getElementById("adminXORKey").value;if(t&&e)if(yae(t)<3)alert("Пароль занадто слабкий! Використовуйте принаймні 8 символів, включаючи великі та малі літери, цифри.");else if(e.length<16)alert("XOR ключ повинен містити мінімум 16 символів!");else if("undefined"!=typeof yan)try{var n=yac(),i=yad(t,n),a=yaf(e,t);yan("YavirLab",i,n,"Administrator",a),alert("Адміністратор успішно створений!\nВикористовуйте ім'я користувача 'YavirLab' та вказаний пароль для входу."),ym()}catch(s){alert("Помилка при створенні адміністратора: "+s.message)}else alert("ПОМИЛКА: VBScript функція yan недоступна!");else alert("Будь ласка, заповніть усі поля!")}function ya(){var t=ye(document.getElementById("username").value),e=document.getElementById("password").value;if(t&&e){var n=yao(t);if(n){var i=n.split(","),a=i[0],s=i[1],o=i[2],r=i[3],l=i[4];if(yad(e,o)===s){var c="";if(l&&""!==l)try{c=yag(l,e)}catch(u){c=null}window.currentUserData={id:parseInt(a),username:t,role:r,xorkey:c},yaq(t),yl(t,r),console.log("Успішний вхід")}else alert("Невірне ім'я користувача або пароль")}else alert("Невірне ім'я користувача або пароль")}else alert("Будь ласка, заповніть усі поля!")}function yc(){console.log("Користувач виходить із системи"),window.currentUserData={},document.getElementById("username").value="",document.getElementById("password").value="",ym()}function yd(){var t=document.getElementById("currentPassword").value,e=document.getElementById("newPassword").value,n=document.getElementById("confirmPassword").value;if(t&&e&&n)if(e===n)if(yae(e)<3)alert("Новий пароль занадто слабкий!");else{var i=window.currentUserData.username,a=yao(i);if(a){var s=a.split(","),o=s[1],r=s[2],l=s[4];if(yad(t,r)===o)try{var c="";if(l&&""!==l&&"-"!==l)try{c=yag(l,t)}catch(f){return void alert("Помилка розшифрування XOR ключа: "+f.message)}var u=yac(),h=yad(e,u),d="";if(""!==c)try{d=yaf(c,e)}catch(f){return void alert("Помилка шифрування XOR ключа новим паролем: "+f.message)}else d=l;yat(i,h,u,d),alert("Пароль успішно змінено!"),document.getElementById("currentPassword").value="",document.getElementById("newPassword").value="",document.getElementById("confirmPassword").value=""}catch(f){alert("Помилка при зміні паролю: "+f.message)}else alert("Невірний поточний пароль!")}else alert("Помилка доступу до даних користувача")}else alert("Нові паролі не співпадають!");else alert("Будь ласка, заповніть усі поля!")}function yf(){var t=ye(document.getElementById("newUserName").value),e=document.getElementById("newUserPassword").value,n=document.getElementById("newUserRole").value;if(t&&e&&n)if(yae(e)<2)alert("Пароль занадто слабкий! Використовуйте принаймні 6 символів.");else if(yap(t))alert("Користувач з таким іменем вже існує!");else try{var i=yac(),a=yad(e,i),s="";"Guest"===n?s=window.currentUserData.xorkey?window.currentUserData.xorkey.substring(0,8):"":"User"!==n&&"Moderator"!==n&&"Auditor"!==n||(s=window.currentUserData.xorkey||"");var o="";s&&(o=yaf(s,e)),yan(t,a,i,n,o),alert("Користувача "+t+" ("+n+") успішно створено!"),document.getElementById("newUserName").value="",document.getElementById("newUserPassword").value="",document.getElementById("newUserRole").selectedIndex=0}catch(r){alert("Помилка при створенні користувача: "+r.message)}else alert("Будь ласка, заповніть усі поля!")}function yg(){var t=document.getElementById("deleteUserID").value;t&&"1"!==t?confirm("Ви впевнені, що хочете видалити користувача з ID: "+t+"?")&&(yas(t),alert("Користувача видалено!"),document.getElementById("deleteUserID").value="",yh()):alert("Неможливо видалити адміністратора або невірний ID!")}function yh(){var t=yar(),e=document.getElementById("usersList");if(t){var n=t.split("|"),i="<table border='1' style='width:100%; border-collapse:collapse; margin-bottom:16px;'>";i+="<tr><th>ID</th><th>Ім'я</th><th>Роль</th><th>Останній вхід</th></tr>";for(var a=0;a<n.length;a++)if(n[a]){var s=n[a].split(",");i+="<tr>",i+="<td>"+s[0]+"</td>",i+="<td>"+s[1]+"</td>",i+="<td>"+s[2]+"</td>",i+="<td>"+s[3]+"</td>",i+="</tr>"}i+="</table>",e.innerHTML=i}else e.innerHTML="<p>Користувачів не знайдено</p>"}function yi(){var t=document.getElementById("decryptPassword").value;if(t){var e=yao(window.currentUserData.username);if(e){var n=e.split(","),i=n[1],a=n[2],s=n[4];if(yad(t,a)!==i)return alert("Невірний пароль!"),void(document.getElementById("decryptPassword").value="");try{if(!s||""===s)return void alert("XOR ключ не знайдено в базі даних");var o=yag(s,t);document.getElementById("xorKeyValue").value=o,document.getElementById("xorKeyGet").style.display="none",document.getElementById("xorKeyDisplay").style.display="block",document.getElementById("decryptPassword").value=""}catch(r){alert("Помилка розшифрування XOR ключа: "+r.message),document.getElementById("decryptPassword").value=""}}else alert("Помилка доступу до даних користувача")}else alert("Введіть ваш пароль!")}function yj(){var t=document.getElementById("xorKeyValue");try{t.select(),t.setSelectionRange(0,99999),document.execCommand("copy")?alert("XOR ключ скопійовано в буфер обміну!"):alert("Не вдалося скопіювати. Виділіть текст вручну та скопіюйте (Ctrl+C).")}catch(e){alert("Помилка копіювання: "+e.message+"\nВиділіть текст вручну та скопіюйте (Ctrl+C).")}window.getSelection&&window.getSelection().removeAllRanges()}function yk(){yu(),document.getElementById("adminSetupForm").style.display="block"}function yl(t,e){yu(),document.getElementById("secureContent").style.display="block";var n=document.getElementById("welcomeUser");if(n.innerText=t,n.className="role-badge",e&&(n.className+=" "+e),document.getElementById("adminMenu").style.display="none",document.getElementById("workspaceMenu").style.display="none","Administrator"===e)document.getElementById("adminMenu").style.display="block";else{document.getElementById("workspaceMenu").style.display="block";var i=document.getElementById("workJournalLink"),a=document.getElementById("summaryWorkJournalLink"),s=document.getElementById("moistureJournalLink"),o=document.getElementById("qualityControlJournalLink"),r=document.getElementById("qualityJournalLink"),l=document.getElementById("consolidatedJournalLink"),c=document.getElementById("showChangePasswordFormLink");i.style.display="none",a.style.display="none",s.style.display="none",o.style.display="none",r.style.display="none",l.style.display="none",c.style.display="none","User"!==e&&"Moderator"!==e||(i.style.display="block",a.style.display="block",r.style.display="block",s.style.display="block",o.style.display="block",l.style.display="block",c.style.display="block"),"Auditor"===e&&(r.style.display="block",c.style.display="block"),"Guest"===e&&(s.style.display="block",o.style.display="block",l.style.display="block")}}function ym(){yu(),document.getElementById("loginForm").style.display="block",document.getElementById("username").focus(),document.getElementById("promoBoxFooter").style.display="block"}function yn(){window.currentUserData&&"Administrator"===window.currentUserData.role?(yu(),document.getElementById("createUserForm").style.display="block",document.getElementById("newUserName").focus()):alert("Недостатньо прав доступу!")}function yo(){window.currentUserData&&"Administrator"===window.currentUserData.role?(yu(),document.getElementById("deleteUserForm").style.display="block",document.getElementById("deleteUserID").focus()):alert("Недостатньо прав доступу!")}function yp(){window.currentUserData&&"Administrator"===window.currentUserData.role?(yu(),document.getElementById("usersListForm").style.display="block",yh()):alert("Недостатньо прав доступу!")}function yq(){yu(),document.getElementById("changePasswordForm").style.display="block",document.getElementById("currentPassword").focus()}function yr(){window.currentUserData&&"Administrator"===window.currentUserData.role?(yu(),document.getElementById("myXORKeyForm").style.display="block",document.getElementById("decryptPassword").focus(),document.getElementById("xorKeyDisplay").style.display="none",document.getElementById("decryptPassword").value=""):alert("Недостатньо прав доступу!")}function ys(){yu(),document.getElementById("workspace").style.display="block",setTimeout(function(){document.getElementById("qualityTableBody")&&0===document.getElementById("qualityTableBody").children.length&&(ycc(),initializeTable())},100),ycd(),ybc()}function yw(){window.currentUserData&&"Guest"!==window.currentUserData.role&&"Auditor"!==window.currentUserData.role&&"Administrator"!==window.currentUserData.role?(yu(),document.getElementById("summaryWorkspace").style.display="block",initializeSummaryWorkJournal(),loadSummaryWorkSettings()):alert("Недостатньо прав доступу!")}function yx(){window.currentUserData&&"Administrator"!==window.currentUserData.role?(yu(),document.getElementById("qualityJournal").style.display="block",initializeQualityJournal()):alert("Доступ заборонено для вашої ролі.")}function yy(){window.currentUserData&&"Administrator"!==window.currentUserData.role?(yu(),document.getElementById("moistureJournal").style.display="block",initializeMoistureJournal()):alert("Доступ заборонено для вашої ролі.")}function ycs(){window.currentUserData&&"Administrator"!==window.currentUserData.role&&(yu(),document.getElementById("qualityControlJournal").style.display="block",ycr())}function yaa(){window.currentUserData&&"Administrator"!==window.currentUserData.role?(yu(),document.getElementById("consolidatedJournal").style.display="block",yda()):alert("Доступ заборонено для вашої ролі.")}function yt(){if(window.currentUserData&&window.currentUserData.id){var t=window.currentUserData;document.getElementById("xorKeyDisplay").style.display="none",document.getElementById("xorKeyGet").style.display="block",yl(t.username,t.role)}else ym()}function yu(){for(var t=["loginForm","promoBoxFooter","adminSetupForm","secureContent","createUserForm","deleteUserForm","usersListForm","changePasswordForm","myXORKeyForm","workspace","summaryWorkspace","moistureJournal","qualityControlJournal","consolidatedJournal","qualityJournal"],e=0;e<t.length;e++){var n=document.getElementById(t[e]);n&&(n.style.display="none")}}function yv(t,e){var n=document.getElementById(t);n&&e&&("password"===n.type?(n.type="text",e.textContent="🔒"):(n.type="password",e.textContent="👁️"))}String.prototype.padStart||(String.prototype.padStart=function(t,e){return t|=0,e=String(void 0!==e?e:" "),this.length>t?String(this):((t-=this.length)>e.length&&(e+=e.repeat(t/e.length)),e.slice(0,t)+String(this))}),String.prototype.padEnd||(String.prototype.padEnd=function(t,e){return t|=0,e=String(void 0!==e?e:" "),this.length>t?String(this):((t-=this.length)>e.length&&(e+=e.repeat(t/e.length)),String(this)+e.slice(0,t))}),String.prototype.repeat||(String.prototype.repeat=function(t){"use strict";if(null==this)throw new TypeError("can't convert "+this+" to object");var e=""+this;if((t=+t)!=t&&(t=0),t<0)throw new RangeError("repeat count must be non-negative");if(t==Infinity)throw new RangeError("repeat count must be less than infinity");if(t=Math.floor(t),0==e.length||0==t)return"";if(e.length*t>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");for(var n="",i=0;i<t;i++)n+=e;return n}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var i=arguments[1],a=0;a<n;){var s=e[a];if(t.call(i,s,a,e))return s;a++}return undefined}}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),i=parseInt(n.length)||0;if(0===i)return-1;var a,s=parseInt(e)||0;if(s>=i)return-1;for(a=Math.max(s>=0?s:i-Math.abs(s),0);a<i;a++)if(a in n&&n[a]===t)return a;return-1}),Object.keys||(Object.keys=function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e}),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){var n,i;if(null==this)throw new TypeError("this is null or not defined");var a=Object(this),s=parseInt(a.length)||0;if("function"!=typeof t)throw new TypeError(t+" is not a function");for(arguments.length>1&&(n=e),i=0;i<s;){var o;i in a&&(o=a[i],t.call(n,o,i,a)),i++}}),Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),n=this,i=function(){},a=function(){return n.apply(this instanceof i?this:t,e.concat(Array.prototype.slice.call(arguments)))};return this.prototype&&(i.prototype=this.prototype),a.prototype=new i,a}),Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),function(){"use strict";var t=this,e=t.Chart,n=function(t){this.canvas=t.canvas,this.ctx=t;var e=function(t,e){return t["offset"+e]?t["offset"+e]:document.defaultView.getComputedStyle(t).getPropertyValue(e)};return this.width=e(t.canvas,"Width")||t.canvas.width,this.height=e(t.canvas,"Height")||t.canvas.height,this.aspectRatio=this.width/this.height,i.retinaScale(this),this};n.defaults={global:{animation:!0,animationSteps:60,animationEasing:"easeOutQuart",showScale:!0,scaleOverride:!1,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:!0,scaleLabel:"<%=value%>",scaleIntegersOnly:!0,scaleBeginAtZero:!1,scaleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",responsive:!1,maintainAspectRatio:!0,showTooltips:!0,customTooltips:!1,tooltipEvents:["mousemove","touchstart","touchmove","mouseout"],tooltipFillColor:"rgba(0,0,0,0.8)",tooltipFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipFontSize:14,tooltipFontStyle:"normal",tooltipFontColor:"#fff",tooltipTitleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipTitleFontSize:14,tooltipTitleFontStyle:"bold",tooltipTitleFontColor:"#fff",tooltipTitleTemplate:"<%= label%>",tooltipYPadding:6,tooltipXPadding:6,tooltipCaretSize:8,tooltipCornerRadius:6,tooltipXOffset:10,tooltipTemplate:"<%if (label){%><%=label%>: <%}%><%= value %>",multiTooltipTemplate:"<%= datasetLabel %>: <%= value %>",multiTooltipKeyBackground:"#fff",segmentColorDefault:["#A6CEE3","#1F78B4","#B2DF8A","#33A02C","#FB9A99","#E31A1C","#FDBF6F","#FF7F00","#CAB2D6","#6A3D9A","#B4B482","#B15928"],segmentHighlightColorDefaults:["#CEF6FF","#47A0DC","#DAFFB2","#5BC854","#FFC2C1","#FF4244","#FFE797","#FFA728","#F2DAFE","#9265C2","#DCDCAA","#D98150"],onAnimationProgress:function(){},onAnimationComplete:function(){}}},n.types={};var i=n.helpers={},a=i.each=function(t,e,n){var i=Array.prototype.slice.call(arguments,3);if(t)if(t.length===+t.length){var a;for(a=0;a<t.length;a++)e.apply(n,[t[a],a].concat(i))}else for(var s in t)e.apply(n,[t[s],s].concat(i))},s=i.clone=function(t){var e={};return a(t,function(n,i){t.hasOwnProperty(i)&&(e[i]=n)}),e},o=i.extend=function(t){return a(Array.prototype.slice.call(arguments,1),function(e){a(e,function(n,i){e.hasOwnProperty(i)&&(t[i]=n)})}),t},r=i.merge=function(t,e){var n=Array.prototype.slice.call(arguments,0);return n.unshift({}),o.apply(null,n)},l=i.indexOf=function(t,e){if(Array.prototype.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1},c=(i.where=function(t,e){var n=[];return i.each(t,function(t){e(t)&&n.push(t)}),n},i.findNextWhere=function(t,e,n){n||(n=-1);for(var i=n+1;i<t.length;i++){var a=t[i];if(e(a))return a}},i.findPreviousWhere=function(t,e,n){n||(n=t.length);for(var i=n-1;i>=0;i--){var a=t[i];if(e(a))return a}},i.inherits=function(t){var e=this,n=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return e.apply(this,arguments)},i=function(){this.constructor=n};return i.prototype=e.prototype,n.prototype=new i,n.extend=c,t&&o(n.prototype,t),n.__super__=e.prototype,n}),u=i.noop=function(){},h=i.uid=function(){var t=0;return function(){return"chart-"+t++}}(),d=i.warn=function(t){window.console&&"function"==typeof window.console.warn&&console.warn(t)},f=i.amd="function"==typeof define&&define.amd,g=i.isNumber=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},p=i.max=function(t){return Math.max.apply(Math,t)},m=i.min=function(t){return Math.min.apply(Math,t)},y=(i.cap=function(t,e,n){if(g(e)){if(t>e)return e}else if(g(n)&&n>t)return n;return t},i.getDecimalPlaces=function(t){if(t%1!=0&&g(t)){var e=t.toString();if(e.indexOf("e-")<0)return e.split(".")[1].length;if(e.indexOf(".")<0)return parseInt(e.split("e-")[1]);var n=e.split(".")[1].split("e-");return n[0].length+parseInt(n[1])}return 0}),v=i.radians=function(t){return t*(Math.PI/180)},b=(i.getAngleFromPoint=function(t,e){var n=e.x-t.x,i=e.y-t.y,a=Math.sqrt(n*n+i*i),s=2*Math.PI+Math.atan2(i,n);return 0>n&&0>i&&(s+=2*Math.PI),{angle:s,distance:a}},i.aliasPixel=function(t){return t%2==0?0:.5}),w=(i.splineCurve=function(t,e,n,i){var a=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),s=Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2)),o=i*a/(a+s),r=i*s/(a+s);return{inner:{x:e.x-o*(n.x-t.x),y:e.y-o*(n.y-t.y)},outer:{x:e.x+r*(n.x-t.x),y:e.y+r*(n.y-t.y)}}},i.calculateOrderOfMagnitude=function(t){return Math.floor(Math.log(t)/Math.LN10)}),S=(i.calculateScaleRange=function(t,e,n,i,s){var o=Math.floor(e/(1.5*n)),r=2>=o,l=[];a(t,function(t){null==t||l.push(t)});var c=m(l),u=p(l);u===c&&(u+=.5,c>=.5&&!i?c-=.5:u+=.5);for(var h=Math.abs(u-c),d=w(h),f=Math.ceil(u/(1*Math.pow(10,d)))*Math.pow(10,d),g=i?0:Math.floor(c/(1*Math.pow(10,d)))*Math.pow(10,d),y=f-g,v=Math.pow(10,d),b=Math.round(y/v);(b>o||o>2*b)&&!r;)if(b>o)v*=2,(b=Math.round(y/v))%1!=0&&(r=!0);else if(s&&d>=0){if(v/2%1!=0)break;v/=2,b=Math.round(y/v)}else v/=2,b=Math.round(y/v);return r&&(v=y/(b=2)),{steps:b,stepValue:v,min:g,max:g+b*v}},i.template=function(t,e){if(t instanceof Function)return t(e);var n={};return function(t,e){var i=/\W/.test(t)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+t.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):n[t]=n[t];return e?i(e):i}(t,e)}),C=(i.generateLabels=function(t,e,n,i){var s=new Array(e);return t&&a(s,function(e,a){s[a]=S(t,{value:n+i*(a+1)})}),s},i.easingEffects={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return-1*t*(t-2)},easeInOutQuad:function(t){return(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1)},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return 1*((t=t/1-1)*t*t+1)},easeInOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return-1*((t=t/1-1)*t*t*t-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},easeInQuint:function(t){return 1*(t/=1)*t*t*t*t},easeOutQuint:function(t){return 1*((t=t/1-1)*t*t*t*t+1)},easeInOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},easeInSine:function(t){return-1*Math.cos(t/1*(Math.PI/2))+1},easeOutSine:function(t){return 1*Math.sin(t/1*(Math.PI/2))},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t/1)-1)},easeInExpo:function(t){return 0===t?1:1*Math.pow(2,10*(t/1-1))},easeOutExpo:function(t){return 1===t?1:1*(1-Math.pow(2,-10*t/1))},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},easeInCirc:function(t){return t>=1?t:-1*(Math.sqrt(1-(t/=1)*t)-1)},easeOutCirc:function(t){return 1*Math.sqrt(1-(t=t/1-1)*t)},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInElastic:function(t){var e=1.70158,n=0,i=1;return 0===t?0:1==(t/=1)?1:(n||(n=.3),i<Math.abs(1)?(i=1,e=n/4):e=n/(2*Math.PI)*Math.asin(1/i),-i*Math.pow(2,10*(t-=1))*Math.sin((1*t-e)*(2*Math.PI)/n))},easeOutElastic:function(t){var e=1.70158,n=0,i=1;return 0===t?0:1==(t/=1)?1:(n||(n=.3),i<Math.abs(1)?(i=1,e=n/4):e=n/(2*Math.PI)*Math.asin(1/i),i*Math.pow(2,-10*t)*Math.sin((1*t-e)*(2*Math.PI)/n)+1)},easeInOutElastic:function(t){var e=1.70158,n=0,i=1;return 0===t?0:2==(t/=.5)?1:(n||(n=.3*1.5*1),i<Math.abs(1)?(i=1,e=n/4):e=n/(2*Math.PI)*Math.asin(1/i),1>t?i*Math.pow(2,10*(t-=1))*Math.sin((1*t-e)*(2*Math.PI)/n)*-.5:i*Math.pow(2,-10*(t-=1))*Math.sin((1*t-e)*(2*Math.PI)/n)*.5+1)},easeInBack:function(t){var e=1.70158;return 1*(t/=1)*t*((e+1)*t-e)},easeOutBack:function(t){var e=1.70158;return 1*((t=t/1-1)*t*((e+1)*t+e)+1)},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},easeInBounce:function(t){return 1-C.easeOutBounce(1-t)},easeOutBounce:function(t){return(t/=1)<1/2.75?7.5625*t*t*1:2/2.75>t?1*(7.5625*(t-=1.5/2.75)*t+.75):2.5/2.75>t?1*(7.5625*(t-=2.25/2.75)*t+.9375):1*(7.5625*(t-=2.625/2.75)*t+.984375)},easeInOutBounce:function(t){return.5>t?.5*C.easeInBounce(2*t):.5*C.easeOutBounce(2*t-1)+.5}}),x=i.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)},k=(i.cancelAnimFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(t){return window.clearTimeout(t,1e3/60)},i.animationLoop=function(t,e,n,i,a,s){var o=0,r=C[n]||C.linear,l=function(){var n=++o/e,c=r(n);t.call(s,c,n,o),i.call(s,c,n),e>o?s.animationFrame=x(l):a.apply(s)};x(l)},i.getRelativePosition=function(t){var e,n,i=t.originalEvent||t,a=(t.currentTarget||t.srcElement).getBoundingClientRect();return i.touches?(e=i.touches[0].clientX-a.left,n=i.touches[0].clientY-a.top):(e=i.clientX-a.left,n=i.clientY-a.top),{x:e,y:n}},i.addEvent=function(t,e,n){t.addEventListener?t.addEventListener(e,n):t.attachEvent?t.attachEvent("on"+e,n):t["on"+e]=n}),_=i.removeEvent=function(t,e,n){t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent?t.detachEvent("on"+e,n):t["on"+e]=u},D=(i.bindEvents=function(t,e,n){t.events||(t.events={}),a(e,function(e){t.events[e]=function(){n.apply(t,arguments)},k(t.chart.canvas,e,t.events[e])})},i.unbindEvents=function(t,e){a(e,function(e,n){_(t.chart.canvas,n,e)})}),P=i.getMaximumWidth=function(t){var e=t.parentNode,n=parseInt(F(e,"padding-left"))+parseInt(F(e,"padding-right"));return e?e.clientWidth-n:0},E=i.getMaximumHeight=function(t){var e=t.parentNode,n=parseInt(F(e,"padding-bottom"))+parseInt(F(e,"padding-top"));return e?e.clientHeight-n:0},F=i.getStyle=function(t,e){return t.currentStyle?t.currentStyle[e]:document.defaultView.getComputedStyle(t,null).getPropertyValue(e)},I=(i.getMaximumSize=i.getMaximumWidth,i.retinaScale=function(t){var e=t.ctx,n=t.canvas.width,i=t.canvas.height;window.devicePixelRatio&&(e.canvas.style.width=n+"px",e.canvas.style.height=i+"px",e.canvas.height=i*window.devicePixelRatio,e.canvas.width=n*window.devicePixelRatio,e.scale(window.devicePixelRatio,window.devicePixelRatio))}),L=i.clear=function(t){t.ctx.clearRect(0,0,t.width,t.height)},A=i.fontString=function(t,e,n){return e+" "+t+"px "+n},M=i.longestText=function(t,e,n){t.font=e;var i=0;return a(n,function(e){var n=t.measureText(e).width;i=n>i?n:i}),i},B=i.drawRoundedRectangle=function(t,e,n,i,a,s){t.beginPath(),t.moveTo(e+s,n),t.lineTo(e+i-s,n),t.quadraticCurveTo(e+i,n,e+i,n+s),t.lineTo(e+i,n+a-s),t.quadraticCurveTo(e+i,n+a,e+i-s,n+a),t.lineTo(e+s,n+a),t.quadraticCurveTo(e,n+a,e,n+a-s),t.lineTo(e,n+s),t.quadraticCurveTo(e,n,e+s,n),t.closePath()};n.instances={},n.Type=function(t,e,i){this.options=e,this.chart=i,this.id=h(),n.instances[this.id]=this,e.responsive&&this.resize(),this.initialize.call(this,t)},o(n.Type.prototype,{initialize:function(){return this},clear:function(){return L(this.chart),this},stop:function(){return n.animationService.cancelAnimation(this),this},resize:function(t){this.stop();var e=this.chart.canvas,n=P(this.chart.canvas),i=this.options.maintainAspectRatio?n/this.chart.aspectRatio:E(this.chart.canvas);return e.width=this.chart.width=n,e.height=this.chart.height=i,I(this.chart),"function"==typeof t&&t.apply(this,Array.prototype.slice.call(arguments,1)),this},reflow:u,render:function(t){if(t&&this.reflow(),this.options.animation&&!t){var e=new n.Animation;e.numSteps=this.options.animationSteps,e.easing=this.options.animationEasing,e.render=function(t,e){var n=i.easingEffects[e.easing],a=e.currentStep/e.numSteps,s=n(a);t.draw(s,a,e.currentStep)},e.onAnimationProgress=this.options.onAnimationProgress,e.onAnimationComplete=this.options.onAnimationComplete,n.animationService.addAnimation(this,e)}else this.draw(),this.options.onAnimationComplete.call(this);return this},generateLegend:function(){return i.template(this.options.legendTemplate,this)},destroy:function(){this.stop(),this.clear(),D(this,this.events);var t=this.chart.canvas;t.width=this.chart.width,t.height=this.chart.height,t.style.removeProperty?(t.style.removeProperty("width"),t.style.removeProperty("height")):(t.style.removeAttribute("width"),t.style.removeAttribute("height")),delete n.instances[this.id]},showTooltip:function(t,e){"undefined"==typeof this.activeElements&&(this.activeElements=[]);var s=function(t){var e=!1;return t.length!==this.activeElements.length?e=!0:(a(t,function(t,n){t!==this.activeElements[n]&&(e=!0)},this),e)}.call(this,t);if(s||e){if(this.activeElements=t,this.draw(),this.options.customTooltips&&this.options.customTooltips(!1),t.length>0)if(this.datasets&&this.datasets.length>1){for(var o,r,c=this.datasets.length-1;c>=0&&(o=this.datasets[c].points||this.datasets[c].bars||this.datasets[c].segments,-1===(r=l(o,t[0])));c--);var u=[],h=[],d=function(t){var e,n,a,s,o,l=[],c=[],d=[];return i.each(this.datasets,function(t){(e=t.points||t.bars||t.segments)[r]&&e[r].hasValue()&&l.push(e[r])}),i.each(l,function(t){c.push(t.x),d.push(t.y),u.push(i.template(this.options.multiTooltipTemplate,t)),h.push({fill:t._saved.fillColor||t.fillColor,stroke:t._saved.strokeColor||t.strokeColor})},this),o=m(d),a=p(d),s=m(c),n=p(c),{x:s>this.chart.width/2?s:n,y:(o+a)/2}}.call(this,r);new n.MultiTooltip({x:d.x,y:d.y,xPadding:this.options.tooltipXPadding,yPadding:this.options.tooltipYPadding,xOffset:this.options.tooltipXOffset,fillColor:this.options.tooltipFillColor,textColor:this.options.tooltipFontColor,fontFamily:this.options.tooltipFontFamily,fontStyle:this.options.tooltipFontStyle,fontSize:this.options.tooltipFontSize,titleTextColor:this.options.tooltipTitleFontColor,titleFontFamily:this.options.tooltipTitleFontFamily,titleFontStyle:this.options.tooltipTitleFontStyle,titleFontSize:this.options.tooltipTitleFontSize,cornerRadius:this.options.tooltipCornerRadius,labels:u,legendColors:h,legendColorBackground:this.options.multiTooltipKeyBackground,title:S(this.options.tooltipTitleTemplate,t[0]),chart:this.chart,ctx:this.chart.ctx,custom:this.options.customTooltips}).draw()}else a(t,function(t){var e=t.tooltipPosition();new n.Tooltip({x:Math.round(e.x),y:Math.round(e.y),xPadding:this.options.tooltipXPadding,yPadding:this.options.tooltipYPadding,fillColor:this.options.tooltipFillColor,textColor:this.options.tooltipFontColor,fontFamily:this.options.tooltipFontFamily,fontStyle:this.options.tooltipFontStyle,fontSize:this.options.tooltipFontSize,caretHeight:this.options.tooltipCaretSize,cornerRadius:this.options.tooltipCornerRadius,text:S(this.options.tooltipTemplate,t),chart:this.chart,custom:this.options.customTooltips}).draw()},this);return this}},toBase64Image:function(){return this.chart.canvas.toDataURL.apply(this.chart.canvas,arguments)}}),n.Type.extend=function(t){var e=this,i=function(){return e.apply(this,arguments)};if(i.prototype=s(e.prototype),o(i.prototype,t),i.extend=n.Type.extend,t.name||e.prototype.name){var a=t.name||e.prototype.name,l=n.defaults[e.prototype.name]?s(n.defaults[e.prototype.name]):{};n.defaults[a]=o(l,t.defaults),n.types[a]=i,n.prototype[a]=function(t,e){var s=r(n.defaults.global,n.defaults[a],e||{});return new i(t,s,this)}}else d("Name not provided for this chart, so it hasn't been registered");return e},n.Element=function(t){o(this,t),this.initialize.apply(this,arguments),this.save()},o(n.Element.prototype,{initialize:function(){},restore:function(t){return t?a(t,function(t){this[t]=this._saved[t]},this):o(this,this._saved),this},save:function(){return this._saved=s(this),delete this._saved._saved,this},update:function(t){return a(t,function(t,e){this._saved[e]=this[e],this[e]=t},this),this},transition:function(t,e){return a(t,function(t,n){this[n]=(t-this._saved[n])*e+this._saved[n]},this),this},tooltipPosition:function(){return{x:this.x,y:this.y}},hasValue:function(){return g(this.value)}}),n.Element.extend=c,n.Point=n.Element.extend({display:!0,inRange:function(t,e){var n=this.hitDetectionRadius+this.radius;return Math.pow(t-this.x,2)+Math.pow(e-this.y,2)<Math.pow(n,2)},draw:function(){if(this.display){var t=this.ctx;t.beginPath(),t.arc(this.x,this.y,this.radius,0,2*Math.PI),t.closePath(),t.strokeStyle=this.strokeColor,t.lineWidth=this.strokeWidth,t.fillStyle=this.fillColor,t.fill(),t.stroke()}}}),n.Arc=n.Element.extend({inRange:function(t,e){var n=i.getAngleFromPoint(this,{x:t,y:e}),a=n.angle%(2*Math.PI),s=(2*Math.PI+this.startAngle)%(2*Math.PI),o=(2*Math.PI+this.endAngle)%(2*Math.PI)||360,r=s>o?o>=a||a>=s:a>=s&&o>=a,l=n.distance>=this.innerRadius&&n.distance<=this.outerRadius;return r&&l},tooltipPosition:function(){var t=this.startAngle+(this.endAngle-this.startAngle)/2,e=(this.outerRadius-this.innerRadius)/2+this.innerRadius;return{x:this.x+Math.cos(t)*e,y:this.y+Math.sin(t)*e}},draw:function(t){var e=this.ctx;e.beginPath(),e.arc(this.x,this.y,this.outerRadius<0?0:this.outerRadius,this.startAngle,this.endAngle),e.arc(this.x,this.y,this.innerRadius<0?0:this.innerRadius,this.endAngle,this.startAngle,!0),e.closePath(),e.strokeStyle=this.strokeColor,e.lineWidth=this.strokeWidth,e.fillStyle=this.fillColor,e.fill(),e.lineJoin="bevel",this.showStroke&&e.stroke()}}),n.Rectangle=n.Element.extend({draw:function(){var t=this.ctx,e=this.width/2,n=this.x-e,i=this.x+e,a=this.base-(this.base-this.y),s=this.strokeWidth/2;this.showStroke&&(n+=s,i-=s,a+=s),t.beginPath(),t.fillStyle=this.fillColor,t.strokeStyle=this.strokeColor,t.lineWidth=this.strokeWidth,t.moveTo(n,this.base),t.lineTo(n,a),t.lineTo(i,a),t.lineTo(i,this.base),t.fill(),this.showStroke&&t.stroke()},height:function(){return this.base-this.y},inRange:function(t,e){return t>=this.x-this.width/2&&t<=this.x+this.width/2&&e>=this.y&&e<=this.base}}),n.Animation=n.Element.extend({currentStep:null,numSteps:60,easing:"",render:null,onAnimationProgress:null,onAnimationComplete:null}),n.Tooltip=n.Element.extend({draw:function(){var t=this.chart.ctx;t.font=A(this.fontSize,this.fontStyle,this.fontFamily),this.xAlign="center",this.yAlign="above";var e=this.caretPadding=2,n=t.measureText(this.text).width+2*this.xPadding,i=this.fontSize+2*this.yPadding,a=i+this.caretHeight+e;this.x+n/2>this.chart.width?this.xAlign="left":this.x-n/2<0&&(this.xAlign="right"),this.y-a<0&&(this.yAlign="below");var s=this.x-n/2,o=this.y-a;if(t.fillStyle=this.fillColor,this.custom)this.custom(this);else{switch(this.yAlign){case"above":t.beginPath(),t.moveTo(this.x,this.y-e),t.lineTo(this.x+this.caretHeight,this.y-(e+this.caretHeight)),t.lineTo(this.x-this.caretHeight,this.y-(e+this.caretHeight)),t.closePath(),t.fill();break;case"below":o=this.y+e+this.caretHeight,t.beginPath(),t.moveTo(this.x,this.y+e),t.lineTo(this.x+this.caretHeight,this.y+e+this.caretHeight),t.lineTo(this.x-this.caretHeight,this.y+e+this.caretHeight),t.closePath(),t.fill()}switch(this.xAlign){case"left":s=this.x-n+(this.cornerRadius+this.caretHeight);break;case"right":s=this.x-(this.cornerRadius+this.caretHeight)}B(t,s,o,n,i,this.cornerRadius),t.fill(),t.fillStyle=this.textColor,t.textAlign="center",t.textBaseline="middle",t.fillText(this.text,s+n/2,o+i/2)}}}),n.MultiTooltip=n.Element.extend({initialize:function(){this.font=A(this.fontSize,this.fontStyle,this.fontFamily),this.titleFont=A(this.titleFontSize,this.titleFontStyle,this.titleFontFamily),this.titleHeight=this.title?1.5*this.titleFontSize:0,this.height=this.labels.length*this.fontSize+(this.labels.length-1)*(this.fontSize/2)+2*this.yPadding+this.titleHeight,this.ctx.font=this.titleFont;var t=this.ctx.measureText(this.title).width,e=M(this.ctx,this.font,this.labels)+this.fontSize+3,n=p([e,t]);this.width=n+2*this.xPadding;var i=this.height/2;this.y-i<0?this.y=i:this.y+i>this.chart.height&&(this.y=this.chart.height-i),this.x>this.chart.width/2?this.x-=this.xOffset+this.width:this.x+=this.xOffset},getLineHeight:function(t){var e=this.y-this.height/2+this.yPadding,n=t-1;return 0===t?e+this.titleHeight/3:e+(1.5*this.fontSize*n+this.fontSize/2)+this.titleHeight},draw:function(){if(this.custom)this.custom(this);else{B(this.ctx,this.x,this.y-this.height/2,this.width,this.height,this.cornerRadius);var t=this.ctx;t.fillStyle=this.fillColor,t.fill(),t.closePath(),t.textAlign="left",t.textBaseline="middle",t.fillStyle=this.titleTextColor,t.font=this.titleFont,t.fillText(this.title,this.x+this.xPadding,this.getLineHeight(0)),t.font=this.font,i.each(this.labels,function(e,n){t.fillStyle=this.textColor,t.fillText(e,this.x+this.xPadding+this.fontSize+3,this.getLineHeight(n+1)),t.fillStyle=this.legendColorBackground,t.fillRect(this.x+this.xPadding,this.getLineHeight(n+1)-this.fontSize/2,this.fontSize,this.fontSize),t.fillStyle=this.legendColors[n].fill,t.fillRect(this.x+this.xPadding,this.getLineHeight(n+1)-this.fontSize/2,this.fontSize,this.fontSize)},this)}}}),n.Scale=n.Element.extend({initialize:function(){this.fit()},buildYLabels:function(){this.yLabels=[];for(var t=y(this.stepValue),e=0;e<=this.steps;e++)this.yLabels.push(S(this.templateString,{value:(this.min+e*this.stepValue).toFixed(t)}));this.yLabelWidth=this.display&&this.showLabels?M(this.ctx,this.font,this.yLabels)+10:0},addXLabel:function(t){this.xLabels.push(t),this.valuesCount++,this.fit()},removeXLabel:function(){this.xLabels.shift(),this.valuesCount--,this.fit()},fit:function(){this.startPoint=this.display?this.fontSize:0,this.endPoint=this.display?this.height-1.5*this.fontSize-5:this.height,this.startPoint+=this.padding,this.endPoint-=this.padding;var t,e=this.endPoint,n=this.endPoint-this.startPoint;for(this.calculateYRange(n),this.buildYLabels(),this.calculateXLabelRotation();n>this.endPoint-this.startPoint;)n=this.endPoint-this.startPoint,t=this.yLabelWidth,this.calculateYRange(n),this.buildYLabels(),t<this.yLabelWidth&&(this.endPoint=e,this.calculateXLabelRotation())},calculateXLabelRotation:function(){this.ctx.font=this.font;var t,e=this.ctx.measureText(this.xLabels[0]).width,n=this.ctx.measureText(this.xLabels[this.xLabels.length-1]).width;if(this.xScalePaddingRight=n/2+3,this.xScalePaddingLeft=e/2>this.yLabelWidth?e/2:this.yLabelWidth,this.xLabelRotation=0,this.display){var i,a=M(this.ctx,this.font,this.xLabels);this.xLabelWidth=a;for(var s=Math.floor(this.calculateX(1)-this.calculateX(0))-6;this.xLabelWidth>s&&0===this.xLabelRotation||this.xLabelWidth>s&&this.xLabelRotation<=90&&this.xLabelRotation>0;)(t=(i=Math.cos(v(this.xLabelRotation)))*e)+this.fontSize/2>this.yLabelWidth&&(this.xScalePaddingLeft=t+this.fontSize/2),this.xScalePaddingRight=this.fontSize/2,this.xLabelRotation++,this.xLabelWidth=i*a;this.xLabelRotation>0&&(this.endPoint-=Math.sin(v(this.xLabelRotation))*a+3)}else this.xLabelWidth=0,this.xScalePaddingRight=this.padding,this.xScalePaddingLeft=this.padding},calculateYRange:u,drawingArea:function(){return this.startPoint-this.endPoint},calculateY:function(t){var e=this.drawingArea()/(this.min-this.max);return this.endPoint-e*(t-this.min)},calculateX:function(t){var e=(this.xLabelRotation,(this.width-(this.xScalePaddingLeft+this.xScalePaddingRight))/Math.max(this.valuesCount-(this.offsetGridLines?0:1),1)),n=e*t+this.xScalePaddingLeft;return this.offsetGridLines&&(n+=e/2),Math.round(n)},update:function(t){i.extend(this,t),this.fit()},draw:function(){var t=this.ctx,e=(this.endPoint-this.startPoint)/this.steps,n=Math.round(this.xScalePaddingLeft);this.display&&(t.fillStyle=this.textColor,t.font=this.font,a(this.yLabels,function(a,s){var o=this.endPoint-e*s,r=Math.round(o),l=this.showHorizontalLines;t.textAlign="right",t.textBaseline="middle",this.showLabels&&t.fillText(a,n-10,o),0!==s||l||(l=!0),l&&t.beginPath(),s>0?(t.lineWidth=this.gridLineWidth,t.strokeStyle=this.gridLineColor):(t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor),r+=i.aliasPixel(t.lineWidth),l&&(t.moveTo(n,r),t.lineTo(this.width,r),t.stroke(),t.closePath()),t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor,t.beginPath(),t.moveTo(n-5,r),t.lineTo(n,r),t.stroke(),t.closePath()},this),a(this.xLabels,function(e,n){var i=this.calculateX(n)+b(this.lineWidth),a=this.calculateX(n-(this.offsetGridLines?.5:0))+b(this.lineWidth),s=this.xLabelRotation>0,o=this.showVerticalLines;0!==n||o||(o=!0),o&&t.beginPath(),n>0?(t.lineWidth=this.gridLineWidth,t.strokeStyle=this.gridLineColor):(t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor),o&&(t.moveTo(a,this.endPoint),t.lineTo(a,this.startPoint-3),t.stroke(),t.closePath()),t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor,t.beginPath(),t.moveTo(a,this.endPoint),t.lineTo(a,this.endPoint+5),t.stroke(),t.closePath(),t.save(),t.translate(i,s?this.endPoint+12:this.endPoint+8),t.rotate(-1*v(this.xLabelRotation)),t.font=this.font,t.textAlign=s?"right":"center",t.textBaseline=s?"middle":"top",t.fillText(e,0,0),t.restore()},this))}}),n.RadialScale=n.Element.extend({initialize:function(){this.size=m([this.height,this.width]),this.drawingArea=this.display?this.size/2-(this.fontSize/2+this.backdropPaddingY):this.size/2},calculateCenterOffset:function(t){var e=this.drawingArea/(this.max-this.min);return(t-this.min)*e},update:function(){this.lineArc?this.drawingArea=this.display?this.size/2-(this.fontSize/2+this.backdropPaddingY):this.size/2:this.setScaleSize(),this.buildYLabels()},buildYLabels:function(){this.yLabels=[];for(var t=y(this.stepValue),e=0;e<=this.steps;e++)this.yLabels.push(S(this.templateString,{value:(this.min+e*this.stepValue).toFixed(t)}))},getCircumference:function(){return 2*Math.PI/this.valuesCount},setScaleSize:function(){var t,e,n,i,a,s,o,r,l,c,u,h,d=m([this.height/2-this.pointLabelFontSize-5,this.width/2]),f=this.width,p=0;for(this.ctx.font=A(this.pointLabelFontSize,this.pointLabelFontStyle,this.pointLabelFontFamily),e=0;e<this.valuesCount;e++)t=this.getPointPosition(e,d),n=this.ctx.measureText(S(this.templateString,{value:this.labels[e]})).width+5,0===e||e===this.valuesCount/2?(i=n/2,t.x+i>f&&(f=t.x+i,a=e),t.x-i<p&&(p=t.x-i,o=e)):e<this.valuesCount/2?t.x+n>f&&(f=t.x+n,a=e):e>this.valuesCount/2&&t.x-n<p&&(p=t.x-n,o=e);l=p,c=Math.ceil(f-this.width),s=this.getIndexAngle(a),r=this.getIndexAngle(o),u=c/Math.sin(s+Math.PI/2),h=l/Math.sin(r+Math.PI/2),u=g(u)?u:0,h=g(h)?h:0,this.drawingArea=d-(h+u)/2,this.setCenterPoint(h,u)},setCenterPoint:function(t,e){var n=this.width-e-this.drawingArea,i=t+this.drawingArea;this.xCenter=(i+n)/2,this.yCenter=this.height/2},getIndexAngle:function(t){return t*(2*Math.PI/this.valuesCount)-Math.PI/2},getPointPosition:function(t,e){var n=this.getIndexAngle(t);return{x:Math.cos(n)*e+this.xCenter,y:Math.sin(n)*e+this.yCenter}},draw:function(){if(this.display){var t=this.ctx;if(a(this.yLabels,function(e,n){if(n>0){var i,a=n*(this.drawingArea/this.steps),s=this.yCenter-a;if(this.lineWidth>0)if(t.strokeStyle=this.lineColor,t.lineWidth=this.lineWidth,this.lineArc)t.beginPath(),t.arc(this.xCenter,this.yCenter,a,0,2*Math.PI),t.closePath(),t.stroke();else{t.beginPath();for(var o=0;o<this.valuesCount;o++)i=this.getPointPosition(o,this.calculateCenterOffset(this.min+n*this.stepValue)),0===o?t.moveTo(i.x,i.y):t.lineTo(i.x,i.y);t.closePath(),t.stroke()}if(this.showLabels){if(t.font=A(this.fontSize,this.fontStyle,this.fontFamily),this.showLabelBackdrop){var r=t.measureText(e).width;t.fillStyle=this.backdropColor,t.fillRect(this.xCenter-r/2-this.backdropPaddingX,s-this.fontSize/2-this.backdropPaddingY,r+2*this.backdropPaddingX,this.fontSize+2*this.backdropPaddingY)}t.textAlign="center",t.textBaseline="middle",t.fillStyle=this.fontColor,t.fillText(e,this.xCenter,s)}}},this),!this.lineArc){t.lineWidth=this.angleLineWidth,t.strokeStyle=this.angleLineColor;for(var e=this.valuesCount-1;e>=0;e--){var n=null,i=null;if(this.angleLineWidth>0&&e%this.angleLineInterval===0&&(n=this.calculateCenterOffset(this.max),i=this.getPointPosition(e,n),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(i.x,i.y),t.stroke(),t.closePath()),this.backgroundColors&&this.backgroundColors.length==this.valuesCount){null==n&&(n=this.calculateCenterOffset(this.max)),null==i&&(i=this.getPointPosition(e,n));var s=this.getPointPosition(0===e?this.valuesCount-1:e-1,n),o=this.getPointPosition(e===this.valuesCount-1?0:e+1,n),r={x:(s.x+i.x)/2,y:(s.y+i.y)/2},l={x:(i.x+o.x)/2,y:(i.y+o.y)/2};t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(r.x,r.y),t.lineTo(i.x,i.y),t.lineTo(l.x,l.y),t.fillStyle=this.backgroundColors[e],t.fill(),t.closePath()}var c=this.getPointPosition(e,this.calculateCenterOffset(this.max)+5);t.font=A(this.pointLabelFontSize,this.pointLabelFontStyle,this.pointLabelFontFamily),t.fillStyle=this.pointLabelFontColor;var u=this.labels.length,h=this.labels.length/2,d=h/2,f=d>e||e>u-d,g=e===d||e===u-d;t.textAlign=0===e||e===h?"center":h>e?"left":"right",t.textBaseline=g?"middle":f?"bottom":"top",t.fillText(this.labels[e],c.x,c.y)}}}}}),n.animationService={frameDuration:17,animations:[],dropFrames:0,addAnimation:function(t,e){for(var n=0;n<this.animations.length;++n)if(this.animations[n].chartInstance===t)return void(this.animations[n].animationObject=e);this.animations.push({chartInstance:t,animationObject:e}),1==this.animations.length&&i.requestAnimFrame.call(window,this.digestWrapper)},cancelAnimation:function(t){var e=i.findNextWhere(this.animations,function(e){return e.chartInstance===t});e&&this.animations.splice(e,1)},digestWrapper:function(){n.animationService.startDigest.call(n.animationService)},startDigest:function(){var t=Date.now(),e=0;this.dropFrames>1&&(e=Math.floor(this.dropFrames),this.dropFrames-=e);for(var n=0;n<this.animations.length;n++)null===this.animations[n].animationObject.currentStep&&(this.animations[n].animationObject.currentStep=0),this.animations[n].animationObject.currentStep+=1+e,this.animations[n].animationObject.currentStep>this.animations[n].animationObject.numSteps&&(this.animations[n].animationObject.currentStep=this.animations[n].animationObject.numSteps),this.animations[n].animationObject.render(this.animations[n].chartInstance,this.animations[n].animationObject),this.animations[n].animationObject.currentStep==this.animations[n].animationObject.numSteps&&(this.animations[n].animationObject.onAnimationComplete.call(this.animations[n].chartInstance),this.animations.splice(n,1),n--);var a=(Date.now()-t-this.frameDuration)/this.frameDuration;a>1&&(this.dropFrames+=a),this.animations.length>0&&i.requestAnimFrame.call(window,this.digestWrapper)}},i.addEvent(window,"resize",function(){var t;return function(){clearTimeout(t),t=setTimeout(function(){a(n.instances,function(t){t.options.responsive&&t.resize(t.render,!0)})},50)}}()),f?define("Chart",[],function(){return n}):"object"==typeof module&&module.exports&&(module.exports=n),t.Chart=n,n.noConflict=function(){return t.Chart=e,n}}.call(this),function(){"use strict";var t=this.Chart,e=t.helpers;t.Type.extend({name:"Bar",defaults:{scaleBeginAtZero:!0,scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,barShowStroke:!0,barStrokeWidth:2,barValueSpacing:5,barDatasetSpacing:1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span class="<%=name.toLowerCase()%>-legend-icon" style="background-color:<%=datasets[i].fillColor%>"></span><span class="<%=name.toLowerCase()%>-legend-text"><%if(datasets[i].label){%><%=datasets[i].label%><%}%></span></li><%}%></ul>'},initialize:function(n){var i=this.options;this.ScaleClass=t.Scale.extend({offsetGridLines:!0,calculateBarX:function(t,e,n){var a=this.calculateBaseWidth(),s=this.calculateX(n)-a/2,o=this.calculateBarWidth(t);return s+o*e+e*i.barDatasetSpacing+o/2},calculateBaseWidth:function(){return this.calculateX(1)-this.calculateX(0)-2*i.barValueSpacing},calculateBarWidth:function(t){return(this.calculateBaseWidth()-(t-1)*i.barDatasetSpacing)/t}}),this.datasets=[],this.options.showTooltips&&e.bindEvents(this,this.options.tooltipEvents,function(t){var n="mouseout"!==t.type?this.getBarsAtEvent(t):[];this.eachBars(function(t){t.restore(["fillColor","strokeColor"])}),e.each(n,function(t){t&&(t.fillColor=t.highlightFill,t.strokeColor=t.highlightStroke)}),this.showTooltip(n)}),this.BarClass=t.Rectangle.extend({strokeWidth:this.options.barStrokeWidth,showStroke:this.options.barShowStroke,ctx:this.chart.ctx}),e.each(n.datasets,function(t,i){var a={label:t.label||null,fillColor:t.fillColor,strokeColor:t.strokeColor,bars:[]};this.datasets.push(a),e.each(t.data,function(e,i){a.bars.push(new this.BarClass({value:e,label:n.labels[i],datasetLabel:t.label,strokeColor:"object"==typeof t.strokeColor?t.strokeColor[i]:t.strokeColor,fillColor:"object"==typeof t.fillColor?t.fillColor[i]:t.fillColor,highlightFill:t.highlightFill?"object"==typeof t.highlightFill?t.highlightFill[i]:t.highlightFill:"object"==typeof t.fillColor?t.fillColor[i]:t.fillColor,highlightStroke:t.highlightStroke?"object"==typeof t.highlightStroke?t.highlightStroke[i]:t.highlightStroke:"object"==typeof t.strokeColor?t.strokeColor[i]:t.strokeColor}))},this)},this),this.buildScale(n.labels),this.BarClass.prototype.base=this.scale.endPoint,this.eachBars(function(t,n,i){e.extend(t,{width:this.scale.calculateBarWidth(this.datasets.length),x:this.scale.calculateBarX(this.datasets.length,i,n),y:this.scale.endPoint}),t.save()},this),this.render()},update:function(){this.scale.update(),e.each(this.activeElements,function(t){t.restore(["fillColor","strokeColor"])}),this.eachBars(function(t){t.save()}),this.render()},eachBars:function(t){e.each(this.datasets,function(n,i){e.each(n.bars,t,this,i)},this)},getBarsAtEvent:function(t){for(var n,i=[],a=e.getRelativePosition(t),s=function(t){i.push(t.bars[n])},o=0;o<this.datasets.length;o++)for(n=0;n<this.datasets[o].bars.length;n++)if(this.datasets[o].bars[n].inRange(a.x,a.y))return e.each(this.datasets,s),i;return i},buildScale:function(t){var n=this,i=function(){var t=[];return n.eachBars(function(e){t.push(e.value)}),t},a={templateString:this.options.scaleLabel,height:this.chart.height,width:this.chart.width,ctx:this.chart.ctx,textColor:this.options.scaleFontColor,fontSize:this.options.scaleFontSize,fontStyle:this.options.scaleFontStyle,fontFamily:this.options.scaleFontFamily,valuesCount:t.length,beginAtZero:this.options.scaleBeginAtZero,integersOnly:this.options.scaleIntegersOnly,calculateYRange:function(t){var n=e.calculateScaleRange(i(),t,this.fontSize,this.beginAtZero,this.integersOnly);e.extend(this,n)},xLabels:t,font:e.fontString(this.options.scaleFontSize,this.options.scaleFontStyle,this.options.scaleFontFamily),lineWidth:this.options.scaleLineWidth,lineColor:this.options.scaleLineColor,showHorizontalLines:this.options.scaleShowHorizontalLines,showVerticalLines:this.options.scaleShowVerticalLines,gridLineWidth:this.options.scaleShowGridLines?this.options.scaleGridLineWidth:0,gridLineColor:this.options.scaleShowGridLines?this.options.scaleGridLineColor:"rgba(0,0,0,0)",padding:this.options.showScale?0:this.options.barShowStroke?this.options.barStrokeWidth:0,showLabels:this.options.scaleShowLabels,display:this.options.showScale};this.options.scaleOverride&&e.extend(a,{calculateYRange:e.noop,steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}),this.scale=new this.ScaleClass(a)},addData:function(t,n){e.each(t,function(t,e){this.datasets[e].bars.push(new this.BarClass({value:t,label:n,datasetLabel:this.datasets[e].label,x:this.scale.calculateBarX(this.datasets.length,e,this.scale.valuesCount+1),y:this.scale.endPoint,width:this.scale.calculateBarWidth(this.datasets.length),base:this.scale.endPoint,strokeColor:this.datasets[e].strokeColor,fillColor:this.datasets[e].fillColor}))},this),this.scale.addXLabel(n),this.update()},removeData:function(){this.scale.removeXLabel(),e.each(this.datasets,function(t){t.bars.shift()},this),this.update()},reflow:function(){e.extend(this.BarClass.prototype,{y:this.scale.endPoint,base:this.scale.endPoint});var t=e.extend({height:this.chart.height,width:this.chart.width});this.scale.update(t)},draw:function(t){var n=t||1;this.clear(),this.chart.ctx,this.scale.draw(n),e.each(this.datasets,function(t,i){e.each(t.bars,function(t,e){t.hasValue()&&(t.base=this.scale.endPoint,t.transition({x:this.scale.calculateBarX(this.datasets.length,i,e),y:this.scale.calculateY(t.value),width:this.scale.calculateBarWidth(this.datasets.length)},n).draw())},this)},this)}})}.call(this),function(){"use strict";var t=this.Chart,e=t.helpers,n={segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,percentageInnerCutout:50,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span class="<%=name.toLowerCase()%>-legend-icon" style="background-color:<%=segments[i].fillColor%>"></span><span class="<%=name.toLowerCase()%>-legend-text"><%if(segments[i].label){%><%=segments[i].label%><%}%></span></li><%}%></ul>'};t.Type.extend({name:"Doughnut",defaults:n,initialize:function(n){this.segments=[],this.outerRadius=(e.min([this.chart.width,this.chart.height])-this.options.segmentStrokeWidth/2)/2,this.SegmentArc=t.Arc.extend({ctx:this.chart.ctx,x:this.chart.width/2,y:this.chart.height/2}),this.options.showTooltips&&e.bindEvents(this,this.options.tooltipEvents,function(t){var n="mouseout"!==t.type?this.getSegmentsAtEvent(t):[];e.each(this.segments,function(t){t.restore(["fillColor"])}),e.each(n,function(t){t.fillColor=t.highlightColor}),this.showTooltip(n)}),this.calculateTotal(n),e.each(n,function(t,e){t.color||(t.color="hsl("+360*e/n.length+", 100%, 50%)"),this.addData(t,e,!0)},this),this.render()},getSegmentsAtEvent:function(t){var n=[],i=e.getRelativePosition(t);return e.each(this.segments,function(t){t.inRange(i.x,i.y)&&n.push(t)},this),n},addData:function(e,n,i){var a=void 0!==n?n:this.segments.length;"undefined"==typeof e.color&&(e.color=t.defaults.global.segmentColorDefault[a%t.defaults.global.segmentColorDefault.length],e.highlight=t.defaults.global.segmentHighlightColorDefaults[a%t.defaults.global.segmentHighlightColorDefaults.length]),this.segments.splice(a,0,new this.SegmentArc({value:e.value,outerRadius:this.options.animateScale?0:this.outerRadius,innerRadius:this.options.animateScale?0:this.outerRadius/100*this.options.percentageInnerCutout,fillColor:e.color,highlightColor:e.highlight||e.color,showStroke:this.options.segmentShowStroke,strokeWidth:this.options.segmentStrokeWidth,strokeColor:this.options.segmentStrokeColor,startAngle:1.5*Math.PI,circumference:this.options.animateRotate?0:this.calculateCircumference(e.value),label:e.label})),i||(this.reflow(),this.update())},calculateCircumference:function(t){return this.total>0?2*Math.PI*(t/this.total):0},calculateTotal:function(t){this.total=0,e.each(t,function(t){this.total+=Math.abs(t.value)},this)},update:function(){this.calculateTotal(this.segments),e.each(this.activeElements,function(t){t.restore(["fillColor"])}),e.each(this.segments,function(t){t.save()}),this.render()},removeData:function(t){var n=e.isNumber(t)?t:this.segments.length-1;this.segments.splice(n,1),this.reflow(),this.update()},reflow:function(){e.extend(this.SegmentArc.prototype,{x:this.chart.width/2,y:this.chart.height/2}),this.outerRadius=(e.min([this.chart.width,this.chart.height])-this.options.segmentStrokeWidth/2)/2,e.each(this.segments,function(t){t.update({outerRadius:this.outerRadius,innerRadius:this.outerRadius/100*this.options.percentageInnerCutout})},this)},draw:function(t){var n=t||1;this.clear(),e.each(this.segments,function(t,e){t.transition({circumference:this.calculateCircumference(t.value),outerRadius:this.outerRadius,innerRadius:this.outerRadius/100*this.options.percentageInnerCutout},n),t.endAngle=t.startAngle+t.circumference,t.draw(),0===e&&(t.startAngle=1.5*Math.PI),e<this.segments.length-1&&(this.segments[e+1].startAngle=t.endAngle)},this)}}),t.types.Doughnut.extend({name:"Pie",defaults:e.merge(n,{percentageInnerCutout:0})})}.call(this),function(){"use strict";var t=this.Chart,e=t.helpers;t.Type.extend({name:"Line",defaults:{scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,bezierCurve:!0,bezierCurveTension:.4,pointDot:!0,pointDotRadius:4,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!0,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span class="<%=name.toLowerCase()%>-legend-icon" style="background-color:<%=datasets[i].strokeColor%>"></span><span class="<%=name.toLowerCase()%>-legend-text"><%if(datasets[i].label){%><%=datasets[i].label%><%}%></span></li><%}%></ul>',offsetGridLines:!1},initialize:function(n){this.PointClass=t.Point.extend({offsetGridLines:this.options.offsetGridLines,strokeWidth:this.options.pointDotStrokeWidth,radius:this.options.pointDotRadius,display:this.options.pointDot,hitDetectionRadius:this.options.pointHitDetectionRadius,ctx:this.chart.ctx,inRange:function(t){return Math.pow(t-this.x,2)<Math.pow(this.radius+this.hitDetectionRadius,2)}}),this.datasets=[],this.options.showTooltips&&e.bindEvents(this,this.options.tooltipEvents,function(t){var n="mouseout"!==t.type?this.getPointsAtEvent(t):[];this.eachPoints(function(t){t.restore(["fillColor","strokeColor"])}),e.each(n,function(t){t.fillColor=t.highlightFill,t.strokeColor=t.highlightStroke}),this.showTooltip(n)}),e.each(n.datasets,function(t){var i={label:t.label||null,fillColor:t.fillColor,strokeColor:t.strokeColor,pointColor:t.pointColor,pointStrokeColor:t.pointStrokeColor,points:[]};this.datasets.push(i),e.each(t.data,function(e,a){i.points.push(new this.PointClass({value:e,label:n.labels[a],datasetLabel:t.label,strokeColor:t.pointStrokeColor,fillColor:t.pointColor,highlightFill:t.pointHighlightFill||t.pointColor,highlightStroke:t.pointHighlightStroke||t.pointStrokeColor}))},this),this.buildScale(n.labels),this.eachPoints(function(t,n){e.extend(t,{x:this.scale.calculateX(n),y:this.scale.endPoint}),t.save()},this)},this),this.render()},update:function(){this.scale.update(),e.each(this.activeElements,function(t){t.restore(["fillColor","strokeColor"])}),this.eachPoints(function(t){t.save()}),this.render()},eachPoints:function(t){e.each(this.datasets,function(n){e.each(n.points,t,this)},this)},getPointsAtEvent:function(t){var n=[],i=e.getRelativePosition(t);return e.each(this.datasets,function(t){e.each(t.points,function(t){t.inRange(i.x,i.y)&&n.push(t)})},this),n},buildScale:function(n){var i=this,a={templateString:this.options.scaleLabel,height:this.chart.height,width:this.chart.width,ctx:this.chart.ctx,textColor:this.options.scaleFontColor,offsetGridLines:this.options.offsetGridLines,fontSize:this.options.scaleFontSize,fontStyle:this.options.scaleFontStyle,fontFamily:this.options.scaleFontFamily,valuesCount:n.length,beginAtZero:this.options.scaleBeginAtZero,integersOnly:this.options.scaleIntegersOnly,calculateYRange:function(t){var n=e.calculateScaleRange(function(){var t=[];return i.eachPoints(function(e){t.push(e.value)}),t}(),t,this.fontSize,this.beginAtZero,this.integersOnly);e.extend(this,n)},xLabels:n,font:e.fontString(this.options.scaleFontSize,this.options.scaleFontStyle,this.options.scaleFontFamily),lineWidth:this.options.scaleLineWidth,lineColor:this.options.scaleLineColor,showHorizontalLines:this.options.scaleShowHorizontalLines,showVerticalLines:this.options.scaleShowVerticalLines,gridLineWidth:this.options.scaleShowGridLines?this.options.scaleGridLineWidth:0,gridLineColor:this.options.scaleShowGridLines?this.options.scaleGridLineColor:"rgba(0,0,0,0)",padding:this.options.showScale?0:this.options.pointDotRadius+this.options.pointDotStrokeWidth,showLabels:this.options.scaleShowLabels,display:this.options.showScale};this.options.scaleOverride&&e.extend(a,{calculateYRange:e.noop,steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}),this.scale=new t.Scale(a)},addData:function(t,n){e.each(t,function(t,e){this.datasets[e].points.push(new this.PointClass({value:t,label:n,datasetLabel:this.datasets[e].label,x:this.scale.calculateX(this.scale.valuesCount+1),y:this.scale.endPoint,strokeColor:this.datasets[e].pointStrokeColor,fillColor:this.datasets[e].pointColor}))},this),this.scale.addXLabel(n),this.update()},removeData:function(){this.scale.removeXLabel(),e.each(this.datasets,function(t){t.points.shift()},this),this.update()},reflow:function(){var t=e.extend({height:this.chart.height,width:this.chart.width});this.scale.update(t)},draw:function(t){var n=t||1;this.clear();var i=this.chart.ctx,a=function(t){return null!==t.value},s=function(t,n,i){return e.findPreviousWhere(n,a,i)||t};this.scale&&(this.scale.draw(n),e.each(this.datasets,function(t){var o=e.where(t.points,a);e.each(t.points,function(t,e){t.hasValue()&&t.transition({y:this.scale.calculateY(t.value),x:this.scale.calculateX(e)},n)},this),this.options.bezierCurve&&e.each(o,function(t,n){var i=n>0&&n<o.length-1?this.options.bezierCurveTension:0;t.controlPoints=e.splineCurve(s(t,o,n),t,function(t,n,i){return e.findNextWhere(n,a,i)||t}(t,o,n),i),t.controlPoints.outer.y>this.scale.endPoint?t.controlPoints.outer.y=this.scale.endPoint:t.controlPoints.outer.y<this.scale.startPoint&&(t.controlPoints.outer.y=this.scale.startPoint),t.controlPoints.inner.y>this.scale.endPoint?t.controlPoints.inner.y=this.scale.endPoint:t.controlPoints.inner.y<this.scale.startPoint&&(t.controlPoints.inner.y=this.scale.startPoint)},this),i.lineWidth=this.options.datasetStrokeWidth,i.strokeStyle=t.strokeColor,i.beginPath(),e.each(o,function(t,e){if(0===e)i.moveTo(t.x,t.y);else if(this.options.bezierCurve){var n=s(t,o,e);i.bezierCurveTo(n.controlPoints.outer.x,n.controlPoints.outer.y,t.controlPoints.inner.x,t.controlPoints.inner.y,t.x,t.y)}else i.lineTo(t.x,t.y)},this),this.options.datasetStroke&&i.stroke(),this.options.datasetFill&&o.length>0&&(i.lineTo(o[o.length-1].x,this.scale.endPoint),i.lineTo(o[0].x,this.scale.endPoint),i.fillStyle=t.fillColor,i.closePath(),i.fill()),e.each(o,function(t){t.draw()})},this))}})}.call(this),function(){"use strict";var t=this.Chart,e=t.helpers;t.Type.extend({name:"PolarArea",defaults:{scaleShowLabelBackdrop:!0,scaleBackdropColor:"rgba(255,255,255,0.75)",scaleBeginAtZero:!0,scaleBackdropPaddingY:2,scaleBackdropPaddingX:2,scaleShowLine:!0,segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span class="<%=name.toLowerCase()%>-legend-icon" style="background-color:<%=segments[i].fillColor%>"></span><span class="<%=name.toLowerCase()%>-legend-text"><%if(segments[i].label){%><%=segments[i].label%><%}%></span></li><%}%></ul>'},initialize:function(n){this.segments=[],this.SegmentArc=t.Arc.extend({showStroke:this.options.segmentShowStroke,strokeWidth:this.options.segmentStrokeWidth,strokeColor:this.options.segmentStrokeColor,ctx:this.chart.ctx,innerRadius:0,x:this.chart.width/2,y:this.chart.height/2}),this.scale=new t.RadialScale({display:this.options.showScale,fontStyle:this.options.scaleFontStyle,fontSize:this.options.scaleFontSize,fontFamily:this.options.scaleFontFamily,fontColor:this.options.scaleFontColor,showLabels:this.options.scaleShowLabels,showLabelBackdrop:this.options.scaleShowLabelBackdrop,backdropColor:this.options.scaleBackdropColor,backdropPaddingY:this.options.scaleBackdropPaddingY,backdropPaddingX:this.options.scaleBackdropPaddingX,lineWidth:this.options.scaleShowLine?this.options.scaleLineWidth:0,lineColor:this.options.scaleLineColor,lineArc:!0,width:this.chart.width,height:this.chart.height,xCenter:this.chart.width/2,yCenter:this.chart.height/2,ctx:this.chart.ctx,templateString:this.options.scaleLabel,valuesCount:n.length}),this.updateScaleRange(n),this.scale.update(),e.each(n,function(t,e){this.addData(t,e,!0)},this),this.options.showTooltips&&e.bindEvents(this,this.options.tooltipEvents,function(t){var n="mouseout"!==t.type?this.getSegmentsAtEvent(t):[];e.each(this.segments,function(t){t.restore(["fillColor"])}),e.each(n,function(t){t.fillColor=t.highlightColor}),this.showTooltip(n)}),this.render()},getSegmentsAtEvent:function(t){var n=[],i=e.getRelativePosition(t);return e.each(this.segments,function(t){t.inRange(i.x,i.y)&&n.push(t)},this),n},addData:function(t,e,n){var i=e||this.segments.length;this.segments.splice(i,0,new this.SegmentArc({fillColor:t.color,highlightColor:t.highlight||t.color,label:t.label,value:t.value,outerRadius:this.options.animateScale?0:this.scale.calculateCenterOffset(t.value),circumference:this.options.animateRotate?0:this.scale.getCircumference(),startAngle:1.5*Math.PI})),n||(this.reflow(),this.update())},removeData:function(t){var n=e.isNumber(t)?t:this.segments.length-1;this.segments.splice(n,1),this.reflow(),this.update()},calculateTotal:function(t){this.total=0,e.each(t,function(t){this.total+=t.value},this),this.scale.valuesCount=this.segments.length},updateScaleRange:function(t){var n=[];e.each(t,function(t){n.push(t.value)});var i=this.options.scaleOverride?{steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}:e.calculateScaleRange(n,e.min([this.chart.width,this.chart.height])/2,this.options.scaleFontSize,this.options.scaleBeginAtZero,this.options.scaleIntegersOnly);e.extend(this.scale,i,{size:e.min([this.chart.width,this.chart.height]),xCenter:this.chart.width/2,yCenter:this.chart.height/2})},update:function(){this.calculateTotal(this.segments),e.each(this.segments,function(t){t.save()}),this.reflow(),this.render()},reflow:function(){e.extend(this.SegmentArc.prototype,{x:this.chart.width/2,y:this.chart.height/2}),this.updateScaleRange(this.segments),this.scale.update(),e.extend(this.scale,{xCenter:this.chart.width/2,yCenter:this.chart.height/2}),e.each(this.segments,function(t){t.update({outerRadius:this.scale.calculateCenterOffset(t.value)})},this)},draw:function(t){var n=t||1;this.clear(),e.each(this.segments,function(t,e){t.transition({circumference:this.scale.getCircumference(),outerRadius:this.scale.calculateCenterOffset(t.value)},n),t.endAngle=t.startAngle+t.circumference,0===e&&(t.startAngle=1.5*Math.PI),e<this.segments.length-1&&(this.segments[e+1].startAngle=t.endAngle),t.draw()},this),this.scale.draw()}})}.call(this),function(){"use strict";var t=this.Chart,e=t.helpers;t.Type.extend({name:"Radar",defaults:{scaleShowLine:!0,angleShowLineOut:!0,scaleShowLabels:!1,scaleBeginAtZero:!0,angleLineColor:"rgba(0,0,0,.1)",angleLineWidth:1,angleLineInterval:1,pointLabelFontFamily:"'Arial'",pointLabelFontStyle:"normal",pointLabelFontSize:10,pointLabelFontColor:"#666",pointDot:!0,pointDotRadius:3,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!0,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span class="<%=name.toLowerCase()%>-legend-icon" style="background-color:<%=datasets[i].strokeColor%>"></span><span class="<%=name.toLowerCase()%>-legend-text"><%if(datasets[i].label){%><%=datasets[i].label%><%}%></span></li><%}%></ul>'},initialize:function(n){this.PointClass=t.Point.extend({strokeWidth:this.options.pointDotStrokeWidth,radius:this.options.pointDotRadius,display:this.options.pointDot,hitDetectionRadius:this.options.pointHitDetectionRadius,ctx:this.chart.ctx}),this.datasets=[],this.buildScale(n),this.options.showTooltips&&e.bindEvents(this,this.options.tooltipEvents,function(t){var n="mouseout"!==t.type?this.getPointsAtEvent(t):[];this.eachPoints(function(t){t.restore(["fillColor","strokeColor"])}),e.each(n,function(t){t.fillColor=t.highlightFill,t.strokeColor=t.highlightStroke}),this.showTooltip(n)}),e.each(n.datasets,function(t){var i={label:t.label||null,fillColor:t.fillColor,strokeColor:t.strokeColor,pointColor:t.pointColor,pointStrokeColor:t.pointStrokeColor,points:[]};this.datasets.push(i),e.each(t.data,function(e,a){var s;this.scale.animation||(s=this.scale.getPointPosition(a,this.scale.calculateCenterOffset(e))),i.points.push(new this.PointClass({value:e,label:n.labels[a],datasetLabel:t.label,x:this.options.animation?this.scale.xCenter:s.x,y:this.options.animation?this.scale.yCenter:s.y,strokeColor:t.pointStrokeColor,fillColor:t.pointColor,highlightFill:t.pointHighlightFill||t.pointColor,highlightStroke:t.pointHighlightStroke||t.pointStrokeColor}))},this)},this),this.render()},eachPoints:function(t){e.each(this.datasets,function(n){e.each(n.points,t,this)},this)},getPointsAtEvent:function(t){var n=e.getRelativePosition(t),i=e.getAngleFromPoint({x:this.scale.xCenter,y:this.scale.yCenter},n),a=2*Math.PI/this.scale.valuesCount,s=Math.round((i.angle-1.5*Math.PI)/a),o=[];return(s>=this.scale.valuesCount||0>s)&&(s=0),i.distance<=this.scale.drawingArea&&e.each(this.datasets,function(t){o.push(t.points[s])}),o},buildScale:function(e){this.scale=new t.RadialScale({display:this.options.showScale,fontStyle:this.options.scaleFontStyle,fontSize:this.options.scaleFontSize,fontFamily:this.options.scaleFontFamily,fontColor:this.options.scaleFontColor,showLabels:this.options.scaleShowLabels,showLabelBackdrop:this.options.scaleShowLabelBackdrop,backdropColor:this.options.scaleBackdropColor,backgroundColors:this.options.scaleBackgroundColors,backdropPaddingY:this.options.scaleBackdropPaddingY,backdropPaddingX:this.options.scaleBackdropPaddingX,lineWidth:this.options.scaleShowLine?this.options.scaleLineWidth:0,lineColor:this.options.scaleLineColor,angleLineColor:this.options.angleLineColor,angleLineWidth:this.options.angleShowLineOut?this.options.angleLineWidth:0,angleLineInterval:this.options.angleLineInterval?this.options.angleLineInterval:1,pointLabelFontColor:this.options.pointLabelFontColor,pointLabelFontSize:this.options.pointLabelFontSize,pointLabelFontFamily:this.options.pointLabelFontFamily,pointLabelFontStyle:this.options.pointLabelFontStyle,height:this.chart.height,width:this.chart.width,xCenter:this.chart.width/2,yCenter:this.chart.height/2,ctx:this.chart.ctx,templateString:this.options.scaleLabel,labels:e.labels,valuesCount:e.datasets[0].data.length}),this.scale.setScaleSize(),this.updateScaleRange(e.datasets),this.scale.buildYLabels()},updateScaleRange:function(t){var n=function(){var n=[];return e.each(t,function(t){t.data?n=n.concat(t.data):e.each(t.points,function(t){n.push(t.value)})}),n}(),i=this.options.scaleOverride?{steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}:e.calculateScaleRange(n,e.min([this.chart.width,this.chart.height])/2,this.options.scaleFontSize,this.options.scaleBeginAtZero,this.options.scaleIntegersOnly);e.extend(this.scale,i)},addData:function(t,n){this.scale.valuesCount++,e.each(t,function(t,e){var i=this.scale.getPointPosition(this.scale.valuesCount,this.scale.calculateCenterOffset(t));this.datasets[e].points.push(new this.PointClass({value:t,label:n,datasetLabel:this.datasets[e].label,x:i.x,y:i.y,strokeColor:this.datasets[e].pointStrokeColor,fillColor:this.datasets[e].pointColor}))},this),this.scale.labels.push(n),this.reflow(),this.update()},removeData:function(){this.scale.valuesCount--,this.scale.labels.shift(),e.each(this.datasets,function(t){t.points.shift()},this),this.reflow(),this.update()},update:function(){this.eachPoints(function(t){t.save()}),this.reflow(),this.render()},reflow:function(){e.extend(this.scale,{width:this.chart.width,height:this.chart.height,size:e.min([this.chart.width,this.chart.height]),xCenter:this.chart.width/2,yCenter:this.chart.height/2}),this.updateScaleRange(this.datasets),this.scale.setScaleSize(),this.scale.buildYLabels()},draw:function(t){var n=t||1,i=this.chart.ctx;this.clear(),this.scale.draw(),e.each(this.datasets,function(t){e.each(t.points,function(t,e){t.hasValue()&&t.transition(this.scale.getPointPosition(e,this.scale.calculateCenterOffset(t.value)),n)},this),i.lineWidth=this.options.datasetStrokeWidth,i.strokeStyle=t.strokeColor,i.beginPath(),e.each(t.points,function(t,e){0===e?i.moveTo(t.x,t.y):i.lineTo(t.x,t.y)},this),i.closePath(),i.stroke(),i.fillStyle=t.fillColor,this.options.datasetFill&&i.fill(),e.each(t.points,function(t){t.hasValue()&&t.draw()})},this)}})}.call(this),window.currentUserData={},function(context){var layout='<div id="panel-box">  <div id="panel-dragbar"></div>  <div id="panel-header">  <span style="padding-left: 5px; font-weight: 700; color: #555;">Console</span>    <span id="panel-menu-close" style="float: right; margin-right: 8px; cursor: pointer; color: grey;" onclick="htaConsole.toggle();">&#10006;</span>    <span id="panel-menu-minimize" style="float: right; margin-top:1px;margin-right: 10px; cursor: pointer; color: grey;" onclick="htaConsole.minimize()">&#9660;</span>  </div>  <div style="background:#fff">    <div id="panel-console"></div>    <span style="padding-left:4px; font-weight:700; font-size:16px; color:#62adea">&#62;</i></span><input id="commandline">  </div>  <div id="panel-navigation">    <span style="cursor: pointer" onclick="htaConsole.clear()">&#10680;</span>    <span id="panel-menu-transparent" style="cursor: pointer" onclick="htaConsole.transparent()">&#9680;</span>  </div></div>',css={panelBox:{width:"100%",color:"#000","font-family":"Consolas, Courier","font-size":"14px",padding:"3px 0px 3px 0px",position:"fixed",bottom:"-4px",left:"0px",opacity:"1.0",display:"none","z-index":"10000"},panelDragbar:{"border-top":"3px solid #ededed","border-bottom":"1px solid #ccc",width:"100%",cursor:"row-resize"},panelHeader:{height:"24px",background:"#ededed","border-top":"1px solid #fff","border-bottom":"1px solid #cacaca","text-align":"left","font-family":"Arial"},panelConsole:{overflow:"auto",height:"150px",padding:" 0 5px 0 5px","text-align":"left",display:"block",background:"#fff"},panelNavigation:{height:"21px",width:"100%","padding-left":"4px","line-height":"1","font-size":"18px","font-weight":"700",background:"#ededed","border-top":"1px solid #cacaca","font-family":"Arial",color:"grey"},commandline:{width:"97%",border:"none","padding-left":"6px","outline-width":"0px"}},cmdHistory=[],cmdHistoryPosition=0,camelCase=function(t){return t.toLowerCase().replace(/-(.)/g,function(t,e){return e.toUpperCase()})},hyphen=function(t){return t.replace(/([a-z][A-Z])/g,function(t){return t[0]+"-"+t[1].toLowerCase()})},censor=function(t){var e=0;return function(n,i){return 0!==e&&"object"==typeof t&&"object"==typeof i&&t==i?"[Circular]":e>=29?"[Unknown]":(++e,i)}},htaConsole={init:function(){var container=document.createElement("div");for(var cssClass in container.innerHTML=layout,document.body.appendChild(container),css)for(var cssProp in css[cssClass])document.getElementById(hyphen(cssClass)).style[camelCase(cssProp)]=css[cssClass][cssProp];var dragHandler=function(t){var e="innerHeight"in window?window.innerHeight:document.documentElement.offsetHeight;document.getElementById("panel-console").style.height=e-86-t.clientY+"px"};document.getElementById("panel-dragbar").addEventListener("mousedown",function(t){t.preventDefault(),document.addEventListener("mousemove",dragHandler)}),document.addEventListener("mouseup",function(t){document.removeEventListener("mousemove",dragHandler)}),document.addEventListener("keydown",function(t){123===t.keyCode&&htaConsole.toggle()},!0),document.getElementById("panel-console").addEventListener("click",function(t){document.getElementById("commandline").focus()}),document.getElementById("commandline").addEventListener("keypress",function(evt){if(13===evt.keyCode){var sCmd=this.value;if("clear"===sCmd)htaConsole.clear(),this.value="";else if("history"===sCmd){for(var x=0;x<cmdHistory.length;x++)console.log(cmdHistory[x]);this.value=""}else if(sCmd){htaConsole.log('<span style="color:#777"; font-weight:700">&#62;</span> <span>'+sCmd+"</span>"),cmdHistory.push(sCmd);try{var evalCmd=eval(sCmd);if("object"==typeof evalCmd)try{console.log(JSON.stringify(evalCmd))}catch(e){try{console.log(JSON.stringify(evalCmd,censor(evalCmd)))}catch(e){throw e}}else console.log(evalCmd);this.value=""}catch(e){throw this.value="",e}}cmdHistoryPosition=cmdHistory.length}}),document.getElementById("commandline").addEventListener("keydown",function(t){if(38===t.keyCode){if(--cmdHistoryPosition<0&&(cmdHistoryPosition=0),cmdHistory[cmdHistoryPosition]!==undefined&&""!==cmdHistory[cmdHistoryPosition])return this.value=cmdHistory[cmdHistoryPosition],!1;if(cmdHistoryPosition===cmdHistory.length)return this.value="",!1}if(40===t.keyCode){if(++cmdHistoryPosition>=cmdHistory.length&&(cmdHistoryPosition=cmdHistory.length),cmdHistory[cmdHistoryPosition]!==undefined&&""!==cmdHistory[cmdHistoryPosition])return this.value=cmdHistory[cmdHistoryPosition],!1;if(cmdHistoryPosition===cmdHistory.length)return this.value="",!1}}),console=window||window.console;for(var method=["log","info","warn","onerror","debug","trace","dir","group","groupCollapsed","groupEnd","time","timeEnd","profile","profileEnd","dirxml","assert","count","markTimeline","timeStamp","clear","cmd"],i=0;i<method.length;i++)window.console[method[i]]||("onerror"===method[i]?console[method[i]]=function(){var t=arguments[1],e=t.split("/")[t.split("/").length-1];return htaConsole.log('<span style="color:red">&otimes;  <span>'+arguments[0]+'</span>  <span class="pull-right" style="cursor:pointer; color:blue" onclick="htaConsole.showModal(\''+t+"')\">"+e+":"+arguments[2]+"</span></span>"),!0}:console[method[i]]=function(){return!0});console={clear:function(){htaConsole.clear()},cmd:function(t){htaConsole.log('<span style="color:#777"; font-weight:700">&#62;</span> <span>'+t+"</span>")},info:function(t){htaConsole.log('<span style="color: RoyalBlue">&#9432;</span> <span>'+t+"</span>")},log:function(t){htaConsole.log('<span style="padding-left: 2px;">'+t+"</span>")},warn:function(t){htaConsole.log('<span style="color: orange">&#9888;</span> <span>'+t+"</span>")},error:function(t){throw t}}},log:function(t){var e=document.createElement("div");e.innerHTML=t+"<br>",document.getElementById("panel-console").appendChild(e),this.consoleresize()},consoleresize:function(){var t=document.getElementById("panel-console");t.scrollTop=t.scrollHeight},clear:function(){document.getElementById("panel-console").innerHTML=""},transparent:function(){var t=document.getElementById("panel-box"),e=document.getElementById("panel-menu-transparent");"0.5"===t.style.opacity?(t.style.opacity="1.0",e.innerHTML="&#9680;"):(t.style.opacity="0.5",e.innerHTML="&#9899;")},minimize:function(){var t=document.getElementById("panel-console"),e=document.getElementById("panel-menu-minimize");"block"===t.style.display?(this.panelConsoleHeight=t.style.height,t.style.height="0px",t.style.display="none",e.innerHTML="&#9650;"):(t.style.height=this.panelConsoleHeight,t.style.display="block",e.innerHTML="&#9660;",this.consoleresize())},toggle:function(){var t=document.getElementById("panel-box");"block"===t.style.display?t.style.display="none":(t.style.display="block",this.consoleresize())},showModal:function(t){window.open(t)}};return context.htaConsole=htaConsole}(window).init();var currentUserSettings={},settingsUpdateTimeout=null,SETTINGS_SAVE_DELAY=2e3,PRODUCT_FIELDS_MAP={general:["sampleSelection","shiftNumber","brigadeInfo"],"I драна":["drama_sample1","drama_mass1","drama_sample2","drama_mass2"],"В/С":["vs_bunker","vs_sample1","vs_mass1","vs_sample2","vs_mass2","vs_residue","vs_metal","vs_color","vs_crunch"],"1/С":["first_bunker","first_sample1","first_mass1","first_sample2","first_mass2","first_residue","first_passage","first_metal","first_color","first_crunch"],"Висівки":["bran_bunker","bran_sample1","bran_mass1","bran_sample2","bran_mass2","bran_passage","bran_metal","bran_color"],"Подача":["feed_bunker","feed_sample1","feed_mass1","feed_sample2","feed_mass2","feed_color","feed_infection"],"I Замочка":["soak_bunker","soak_sample1","soak_mass1","soak_sample2","soak_mass2"]};function ybh(){if(window.currentUserData&&"Guest"!==window.currentUserData.role)try{var t=ybf(window.currentUserData.id);if(t&&""!==t){var e=yag(t,window.currentUserData.xorkey),n=e.indexOf("|");if(-1!==n){var i=parseInt(e.substring(0,n)),a=e.substring(n+1,n+1+i);try{currentUserSettings=JSON.parse(a)}catch(o){currentUserSettings=createDefaultSettings()}}else{var s=e.trim().replace(/\0/g,"").replace(/[\x00-\x1F\x7F]/g,"");try{currentUserSettings=JSON.parse(s)}catch(o){currentUserSettings=createDefaultSettings()}}}else currentUserSettings=createDefaultSettings();applySettingsToForm()}catch(r){currentUserSettings=createDefaultSettings()}}function createDefaultSettings(){return{general:{},products:{}}}function applySettingsToForm(){try{if(currentUserSettings.general)for(var t=0;t<PRODUCT_FIELDS_MAP.general.length;t++){var e=PRODUCT_FIELDS_MAP.general[t];(o=currentUserSettings.general[e])!==undefined&&setElementValue(e,o)}if(currentUserSettings.products)for(var n in PRODUCT_FIELDS_MAP)if("general"!==n){var i=currentUserSettings.products[n];if(i)for(var a=PRODUCT_FIELDS_MAP[n],s=0;s<a.length;s++){var o;(o=i[e=a[s]])!==undefined&&setElementValue(e,o)}}}catch(r){}}function saveCurrentSettings(){if(window.currentUserData&&"Guest"!==window.currentUserData.role)try{currentUserSettings.general={};for(var t=0;t<PRODUCT_FIELDS_MAP.general.length;t++){var e=PRODUCT_FIELDS_MAP.general[t];(l=getElementValue(e))&&(currentUserSettings.general[e]=l)}for(var n in currentUserSettings.products||(currentUserSettings.products={}),PRODUCT_FIELDS_MAP)if("general"!==n){var i=ycj(n);if(void 0!==productToggleStates&&productToggleStates[i]){for(var a={},s=PRODUCT_FIELDS_MAP[n],o=!1,r=0;r<s.length;r++){var l;e=s[r],(l=getElementValue(e))&&(a[e]=l,o=!0)}o?currentUserSettings.products[n]=a:delete currentUserSettings.products[n]}}var c=JSON.stringify(currentUserSettings),u=yaf(c.length+"|"+c,window.currentUserData.xorkey);ybg(window.currentUserData.id,u),console.log("Налаштування збережено для користувача: "+window.currentUserData.username)}catch(h){console.log("Помилка збереження налаштувань: "+h.message)}}function getElementValue(t){var e=document.getElementById(t);return e?e.value:""}function setElementValue(t,e){var n=document.getElementById(t);n&&e!==undefined&&null!==e&&(n.value=e)}function ybe(){}function ybq(){}function saveProductStatesQuick(){}function ybc(){ybh()}function ybd(){saveCurrentSettings()}var ycf={currentDate:new Date,selectedDate:new Date,isOpen:!1,targetInput:null,activeDates:null,init:function(){this.createDatePicker(),this.attachEvents()},createDatePicker:function(){document.body.insertAdjacentHTML("beforeend",'<div id="datepicker" class="datepicker" style="display: none;"><div class="datepicker-header"><button type="button" class="datepicker-btn" id="prevMonth">&lt;</button><span class="datepicker-title" id="monthYear"></span><button type="button" class="datepicker-btn" id="nextMonth">&gt;</button></div><div class="datepicker-calendar"><div class="datepicker-weekdays"><span>Пн</span><span>Вт</span><span>Ср</span><span>Чт</span><span>Пт</span><span>Сб</span><span>Нд</span></div><div class="datepicker-days" id="calendarDays"></div></div><div class="datepicker-footer"><button type="button" class="datepicker-btn" id="todayBtn">Сьогодні</button><button type="button" class="datepicker-btn" id="closeBtn">Закрити</button></div></div>')},attachEvents:function(){var t=this;document.getElementById("prevMonth").onclick=function(){t.previousMonth()},document.getElementById("nextMonth").onclick=function(){t.nextMonth()},document.getElementById("todayBtn").onclick=function(){t.selectToday()},document.getElementById("closeBtn").onclick=function(){t.close()},document.getElementById("calendarDays").onclick=function(e){for(var n=e.target||e.srcElement;n&&n!==this;){if(n.className.indexOf("datepicker-day")>-1)return void(-1===n.className.indexOf("disabled")&&t.selectDate(n.getAttribute("data-date")));n=n.parentNode}},document.onclick=function(e){var n=document.getElementById("datepicker"),i=e.target||e.srcElement;t.isOpen&&!t.isChildOf(i,n)&&i!==t.targetInput&&t.close()},document.onkeydown=function(e){if(t.isOpen){var n=e.keyCode||e.which;return 27===n?(t.close(),t.targetInput.focus(),e.preventDefault?e.preventDefault():e.returnValue=!1,!1):13===n?(t.selectToday(),e.preventDefault?e.preventDefault():e.returnValue=!1,!1):37===n?(t.previousMonth(),e.preventDefault?e.preventDefault():e.returnValue=!1,!1):39===n?(t.nextMonth(),e.preventDefault?e.preventDefault():e.returnValue=!1,!1):void 0}}},isChildOf:function(t,e){if(!t||!e)return!1;for(;t&&t!==e;)t=t.parentNode;return t===e},loadActiveDates:function(t,e){var n=this;n.activeDates=null;var i="";if("summary"===t?i="PFUpdatedDate":"moisture"===t&&(i="VPFUpdatedDate"),""!==i)try{var a=ybt(i);a&&-1===a.indexOf("Error:")?n.activeDates=a.split(","):n.activeDates=[]}catch(s){console.log("Помилка VBScript ybt: "+s.message),n.activeDates=[]}e()},show:function(t){var e=this;this.targetInput=t;var n="";"summaryWorkJournalDate"===t.id?n="summary":"moistureJournalDate"!==t.id&&"qualityControlJournalDate"!==t.id||(n="moisture");var i=t.value;if(i){var a=i.split("-");this.selectedDate=new Date(a[0],a[1]-1,a[2]),this.currentDate=new Date(this.selectedDate)}else this.selectedDate=new Date,this.currentDate=new Date;this.loadActiveDates(n,function(){e.isOpen=!0,e.render(),e.position(t),document.getElementById("datepicker").style.display="block"})},position:function(t){var e=document.getElementById("datepicker"),n=t.getBoundingClientRect(),i=n.bottom+window.pageYOffset+5,a=n.left+window.pageXOffset;a+280>window.innerWidth&&(a=window.innerWidth-280-10),i+350>window.innerHeight+window.pageYOffset&&(i=n.top+window.pageYOffset-350-5),e.style.top=i+"px",e.style.left=a+"px"},render:function(){this.renderHeader(),this.renderDays()},renderHeader:function(){var t=["Січень","Лютий","Березень","Квітень","Травень","Червень","Липень","Серпень","Вересень","Жовтень","Листопад","Грудень"][this.currentDate.getMonth()]+" "+this.currentDate.getFullYear();document.getElementById("monthYear").textContent=t},renderDays:function(){var t=document.getElementById("calendarDays");t.innerHTML="";for(var e=this.currentDate.getFullYear(),n=this.currentDate.getMonth(),i=new Date(e,n,1),a=new Date(e,n+1,0),s=(i.getDay()+6)%7,o=new Date(e,n,0),r="",l=0,c=s-1;c>=0;c--)r+='<div class="datepicker-day other-month disabled">'+(o.getDate()-c)+"</div>",l++;for(var u=1;u<=a.getDate();u++){var h=e+"-"+(n+1<10?"0":"")+(n+1)+"-"+(u<10?"0":"")+u,d=e+"-"+(n+1)+"-"+u,f="datepicker-day";null!==this.activeDates&&-1===this.activeDates.indexOf(h)&&(f+=" disabled");var g=new Date;e===g.getFullYear()&&n===g.getMonth()&&u===g.getDate()&&(f+=" today"),this.selectedDate&&e===this.selectedDate.getFullYear()&&n===this.selectedDate.getMonth()&&u===this.selectedDate.getDate()&&(f+=" selected"),r+='<div class="'+f+'" data-date="'+d+'">'+u+"</div>",l++}var p=42-l;for(u=1;u<=p;u++)r+='<div class="datepicker-day other-month disabled">'+u+"</div>";t.innerHTML=r},selectDate:function(t){var e=t.split("-"),n=parseInt(e[0]),i=parseInt(e[1])-1,a=parseInt(e[2]);this.selectedDate=new Date(n,i,a);var s=n+"-"+(i+1<10?"0":"")+(i+1)+"-"+(a<10?"0":"")+a;this.targetInput.value=s,this.targetInput.onchange&&this.targetInput.onchange(),this.close()},selectToday:function(){var t=new Date,e=t.getFullYear(),n=t.getMonth(),i=t.getDate();this.selectDate(e+"-"+(n+1)+"-"+i)},previousMonth:function(){this.currentDate.setMonth(this.currentDate.getMonth()-1),this.render()},nextMonth:function(){this.currentDate.setMonth(this.currentDate.getMonth()+1),this.render()},close:function(){this.isOpen=!1,document.getElementById("datepicker").style.display="none"}};function ycg(t){var e=document.getElementById(t);e&&(e.parentNode.className+=" datepicker-input",e.onclick=function(){ycf.show(e)},e.onkeydown=function(t){var n=t.keyCode||t.which;return 9===n||(27===n&&ycf.isOpen&&ycf.close(),13!==n&&32!==n||ycf.show(e),t.preventDefault?t.preventDefault():t.returnValue=!1,!1)})}function ych(){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){ycf.init()}):ycf.init()}var productToggleStates={drama:!0,vs:!0,first:!0,bran:!0,feed:!0,soak:!0};function yby(t,e){e=e?"_"+e:"";try{var n=parseFloat(getElementValue(t+"_mass1"+e))||0,i=parseFloat(getElementValue(t+"_dried1"+e))||0,a=parseFloat(getElementValue(t+"_mass2"+e))||0,s=parseFloat(getElementValue(t+"_dried2"+e))||0,o=0,r=0,l="";i>0&&n>0&&(o=(n-i)/5,o=Math.round(10*o)/10),s>0&&a>0&&(r=(a-s)/5,r=Math.round(10*r)/10),i&&s&&(l=(n-i+(a-s))/10,((l=Math.round(10*l)/10)<=0||l>=100)&&(l=""));var c=document.getElementById(t+"_moisture"+e);if(c){var u=c.parentNode;u.style.position="relative";var h=u.querySelector(".moisture-1");h||((h=document.createElement("span")).className="moisture-single moisture-1",u.appendChild(h));var d=u.querySelector(".moisture-2");d||((d=document.createElement("span")).className="moisture-single moisture-2",u.appendChild(d)),h.textContent=o>0?o.toFixed(1):"",c.textContent=l.toString(),d.textContent=r>0?r.toFixed(1):""}return l}catch(f){return 0}}function ybz(){for(var t=["drama","vs","first","bran","feed","soak"],e=0;e<t.length;e++)yby(t[e])}function yca(t){yby(t)}function ycb(){for(var t=["drama","vs","first","bran","feed","soak"],e=0;e<t.length;e++)for(var n=t[e],i=["_mass1","_dried1","_mass2","_dried2"],a=0;a<i.length;a++){var s=n+i[a],o=document.getElementById(s);o&&function(t){o.addEventListener?(o.addEventListener("input",function(){yca(t)},!1),o.addEventListener("change",function(){yca(t)},!1)):o.attachEvent&&(o.attachEvent("oninput",function(){yca(t)}),o.attachEvent("onchange",function(){yca(t)}))}(n)}ybz()}function ycc(){var t=new Date,e=t.getFullYear(),n=t.getMonth()+1,i=t.getDate(),a=e+"-"+(n<10?"0"+n:n.toString())+"-"+(i<10?"0"+i:i.toString()),s=document.getElementById("journalDate");s&&!s.value&&(s.value=a)}function getElementValue(t){var e=document.getElementById(t);return e?e.value:""}function initializeMassFieldsNavigation(){for(var t=["drama","vs","first","bran","feed","soak"],e=["_mass1","_mass2","_dried1","_dried2"],n=0;n<t.length;n++)for(var i=t[n],a=0;a<e.length;a++){var s=i+e[a],o=document.getElementById(s);o&&function(t,e){t.addEventListener?t.addEventListener("keydown",function(n){handleMassFieldKeydown(n,t,e)},!1):t.attachEvent&&t.attachEvent("onkeydown",function(n){handleMassFieldKeydown(n||window.event,t,e)})}(o,i)}}function handleMassFieldKeydown(t,e,n){var i=t.keyCode||t.which;if(38===i||40===i){t.preventDefault?t.preventDefault():t.returnValue=!1;var a,s=parseFloat(e.value)||0;return a=38===i?s+1:Math.max(0,s-1),e.value=a,yby(n),!1}}function toggleProductRow(t){try{productToggleStates[t]=!productToggleStates[t];var e=productToggleStates[t],n=document.querySelectorAll('tr[data-product="'+t+'"]');if(!n||0===n.length)return;for(var i=document.querySelector('button[onclick*="'+t+'"]'),a=[],s=[],o=document.querySelectorAll('input[id^="'+t+'_"], select[id^="'+t+'_"]'),r=0;r<o.length;r++)"input"===o[r].tagName.toLowerCase()?a.push(o[r]):"select"===o[r].tagName.toLowerCase()&&s.push(o[r]);if(e){for(var l=0;l<n.length;l++)n[l].className=n[l].className.replace(/ inactive/g,"");for(var c=0;c<a.length;c++)a[c].disabled=!1,a[c].style.backgroundColor="",a[c].style.color="",a[c].style.borderColor="",a[c].style.cursor="";for(var u=0;u<s.length;u++)s[u].disabled=!1,s[u].style.backgroundColor="",s[u].style.color="",s[u].style.borderColor="",s[u].style.cursor="";i&&(i.className=i.className.replace(/ inactive/g,""),i.textContent="−",i.title="Деактивувати продукцію")}else{for(var h=0;h<n.length;h++)-1===n[h].className.indexOf("inactive")&&(n[h].className+=" inactive");for(var d=0;d<a.length;d++)a[d].disabled=!0;for(var f=0;f<s.length;f++)s[f].disabled=!0;i&&(-1===i.className.indexOf("inactive")&&(i.className+=" inactive"),i.textContent="+",i.title="Активувати продукцію")}e&&setTimeout(function(){yby(t)},100),handleProductToggleChange()}catch(g){}}function initializeProductToggleStates(){try{for(var t=["drama","vs","first","bran","feed","soak"],e=0;e<t.length;e++){var n=t[e];productToggleStates[n]=!0;var i=document.querySelector('button[onclick*="'+n+'"]');i&&(i.textContent="−",i.title="Деактивувати продукцію")}}catch(a){}}function loadProductToggleStates(){if(window.currentUserData&&"Guest"!==window.currentUserData.role)try{if(currentUserSettings&&currentUserSettings.productStates){var t=currentUserSettings.productStates;for(var e in t)if(productToggleStates.hasOwnProperty(e)){var n=t[e];productToggleStates[e]=n,applyProductRowState(e,n)}}}catch(i){}}function applyProductRowState(t,e){try{var n=document.querySelectorAll('tr[data-product="'+t+'"]');if(!n||0===n.length)return;var i=document.querySelector('button[onclick*="'+t+'"]'),a=document.querySelectorAll('input[id^="'+t+'_"], select[id^="'+t+'_"]');if(e){for(var s=0;s<n.length;s++)n[s].className=n[s].className.replace(/ inactive/g,"");for(var o=0;o<a.length;o++)a[o].disabled=!1,a[o].style.backgroundColor="",a[o].style.color="",a[o].style.borderColor="",a[o].style.cursor="";i&&(i.className=i.className.replace(/ inactive/g,""),i.textContent="−",i.title="Деактивувати продукцію")}else{for(var r=0;r<n.length;r++)-1===n[r].className.indexOf("inactive")&&(n[r].className+=" inactive");for(var l=0;l<a.length;l++)a[l].disabled=!0;i&&(-1===i.className.indexOf("inactive")&&(i.className+=" inactive"),i.textContent="+",i.title="Активувати продукцію")}}catch(c){}}function ycd(){ycc(),initializeProductToggleStates(),ycb(),initializeMassFieldsNavigation(),ycq(),setTimeout(function(){ych(),ycg("journalDate")},100)}function ybc(){ybh(),ybq(),setTimeout(function(){loadProductToggleStates(),"function"==typeof ycl&&(ycl(),console.log("ProductionFlow дані завантажено"))},500)}function handleProductToggleChange(){}function yce(){if(window.currentUserData&&"Guest"!==window.currentUserData.role){var t=getElementValue("journalDate"),e=getElementValue("shiftNumber")||"1",n=getElementValue("sampleSelection")||"1";if(t){if(confirm("Ви впевнені,\n що хочете видалити дані для відбору №"+n+" \nза "+t+" (Зміна: "+e+" )?\nЦя дія незворотна."))try{var i=ybi(t,e);if(!i||""===i)return void alert("Немає даних для видалення.");var a,s=yag(i,window.currentUserData.xorkey),o=s.indexOf("|");if(-1!==o){var r=parseInt(s.substring(0,o));a=s.substring(o+1,o+1+r)}else a=s.trim().replace(/\0/g,"").replace(/[\x00-\x1F\x7F]/g,"");var l=JSON.parse(a),c={},u=!1,h=!0;for(var d in l)if(l.hasOwnProperty(d)&&l[d]&&l[d][e]){var f=l[d][e],g={},p=!1;for(var m in f)f.hasOwnProperty(m)&&(m!==n?(g[m]=f[m],"brigade"===m||isNaN(parseInt(m))||(p=!0)):u=!0);p&&(c[d]||(c[d]={}),c[d][e]=g,h=!1)}if(!u)return void alert("Дані для відбору №"+n+" не знайдено.");var y="";if(!h){var v=JSON.stringify(c);y=yaf(v.length+"|"+v,window.currentUserData.xorkey)}var b=(new Date).toISOString();ybp(t,y,b,window.currentUserData.id,e),alert("Дані для відбору №"+n+" успішно видалено."),clearAllProductFields(),ycl()}catch(w){alert("Сталася помилка під час видалення: "+w.message),console.log("Помилка видалення відбору: "+w.message)}}else alert("Будь ласка, оберіть дату.")}else alert("Недостатньо прав для видалення.")}var PRODUCTION_FLOW_FIELDS_MAP={"I драна":["drama_sample1","drama_mass1","drama_dried1","drama_sample2","drama_mass2","drama_dried2","drama_moisture"],"В/С":["vs_bunker","vs_sample1","vs_mass1","vs_dried1","vs_sample2","vs_mass2","vs_dried2","vs_moisture","vs_whiteness","vs_gluten_quantity","vs_gluten_idk","vs_falling_number","vs_residue","vs_metal","vs_color","vs_crunch"],"1/С":["first_bunker","first_sample1","first_mass1","first_dried1","first_sample2","first_mass2","first_dried2","first_moisture","first_whiteness","first_gluten_quantity","first_gluten_idk","first_falling_number","first_residue","first_passage","first_metal","first_color","first_crunch"],"Висівки":["bran_bunker","bran_sample1","bran_mass1","bran_dried1","bran_sample2","bran_mass2","bran_dried2","bran_moisture","bran_passage","bran_metal","bran_color"],"Подача":["feed_bunker","feed_sample1","feed_mass1","feed_dried1","feed_sample2","feed_mass2","feed_dried2","feed_moisture","feed_gluten_quantity","feed_gluten_idk","feed_falling_number","feed_color","feed_infection"],"I Замочка":["soak_bunker","soak_sample1","soak_mass1","soak_dried1","soak_sample2","soak_mass2","soak_dried2","soak_moisture"]};function yci(){try{var t={},e=getElementValue("shiftNumber")||"1",n=getElementValue("brigadeInfo")||"",i=getElementValue("sampleSelection")||"1";for(var a in PRODUCTION_FLOW_FIELDS_MAP){var s=ycj(a);if(productToggleStates[s]){for(var o={},r=!1,l=PRODUCTION_FLOW_FIELDS_MAP[a],c=0;c<l.length;c++){var u=l[c],h="",d=document.getElementById(u);d&&(h=-1!==u.indexOf("_moisture")&&"span"===d.tagName.toLowerCase()?d.textContent||d.innerText:d.value),h&&""!==h.trim()&&(o[u]=h.trim(),r=!0)}r&&(t[a]||(t[a]={}),t[a][e]||(t[a][e]={}),t[a][e][i]=o,t[a][e].brigade=n)}}return t}catch(f){return{}}}function ycj(t){return{"I драна":"drama","В/С":"vs","1/С":"first","Висівки":"bran","Подача":"feed","I Замочка":"soak"}[t]||""}function yck(){if(window.currentUserData&&"Guest"!==window.currentUserData.role)try{var t=yci(),e=getElementValue("journalDate");if(!e)return void alert("Будь ласка, вкажіть дату аналізу!");var n=getElementValue("shiftNumber")||"1",i=getElementValue("sampleSelection")||"1",a={},s=ybi(e,n);if(s&&""!==s)try{var o,r=yag(s,window.currentUserData.xorkey),l=r.indexOf("|");if(-1!==l){var c=parseInt(r.substring(0,l));o=r.substring(l+1,l+1+c)}else o=r.trim().replace(/\0/g,"").replace(/[\x00-\x1F\x7F]/g,"");a=JSON.parse(o)}catch(y){console.log("Помилка завантаження існуючих даних: "+y.message),a={}}var u=a;for(var h in u)u.hasOwnProperty(h)&&u[h]&&u[h][n]&&u[h][n][i]&&delete u[h][n][i];for(var h in t)if(t.hasOwnProperty(h)){u[h]||(u[h]={}),u[h][n]||(u[h][n]={});var d=t[h][n];for(var f in d)d.hasOwnProperty(f)&&(u[h][n][f]=d[f])}var g=JSON.stringify(u),p=yaf(g.length+"|"+g,window.currentUserData.xorkey),m=(new Date).toISOString();ybp(e,p,m,window.currentUserData.id,n)}catch(y){console.log("Помилка збереження ProductionFlow: "+y.message),alert("Помилка збереження даних: "+y.message)}}function ycl(){clearAllProductFields();var t=document.getElementById("deleteSampleBtn");t&&(t.style.display="none");var e=getElementValue("shiftNumber")||"1";if(window.currentUserData&&window.currentUserData.xorkey)try{var n=document.getElementById("verifiedDataMessage"),i=document.getElementById("qualityTable"),a=document.querySelector("#workspace .journal-footer"),s=getElementValue("journalDate");if(!s)return void ycn();e=getElementValue("shiftNumber")||"1";var o=ybi(s,e);if(o&&""!==o){var r,l=yag(o,window.currentUserData.xorkey),c=l.indexOf("|");if(-1!==c){var u=parseInt(l.substring(0,c));r=l.substring(c+1,c+1+u)}else r=l.trim().replace(/\0/g,"").replace(/[\x00-\x1F\x7F]/g,"");var h=JSON.parse(r),d=getElementValue("sampleSelection")||"1";ycm(h,e,d);var f=!1;for(var g in h)if(h[g]&&h[g][e]&&h[g][e][d]&&Object.keys(h[g][e][d]).length>0){f=!0;break}f&&t&&(t.style.display="block")}else ycn();ybx(s,e)?(n&&(n.style.display="block"),i&&(i.style.display="none"),a&&(a.style.display="none"),console.log("Дані для "+s+" верифіковано. Редагування заблоковано.")):(n&&(n.style.display="none"),i&&(i.style.display="table"),a&&(a.style.display="block"))}catch(p){console.log("Помилка завантаження ProductionFlow: "+p.message),ycn()}else ycn()}function ycm(t,e,n){try{var i=0,a="";for(var s in PRODUCTION_FLOW_FIELDS_MAP)if(t[s]&&t[s][e]&&t[s][e][n]){var o=t[s][e][n],r=PRODUCTION_FLOW_FIELDS_MAP[s];!a&&t[s][e].brigade&&(a=t[s][e].brigade);for(var l=0;l<r.length;l++){var c=r[l];if(-1===c.indexOf("_moisture")&&o.hasOwnProperty(c)){var u=o[c],h=document.getElementById(c);h&&(h.value=u,i++)}}}a&&setElementValue("brigadeInfo",a),i>0?setTimeout(function(){ybz()},100):ycn()}catch(d){ycn()}}function ycn(){try{var t=getElementValue("shiftNumber"),e=getElementValue("sampleSelection"),n=getElementValue("brigadeInfo"),i=getElementValue("journalDate");if(void 0!==currentUserSettings&&currentUserSettings.products)for(var a in currentUserSettings.products)if(currentUserSettings.products.hasOwnProperty(a)){var s=currentUserSettings.products[a];for(var o in s)if(s.hasOwnProperty(o)){var r=document.getElementById(o);r&&(r.value=s[o])}}t&&setElementValue("shiftNumber",t),e&&setElementValue("sampleSelection",e),n&&setElementValue("brigadeInfo",n),i&&setElementValue("journalDate",i),setTimeout(function(){ybz()},50)}catch(l){}}function clearAllProductFields(){for(var t in PRODUCTION_FLOW_FIELDS_MAP)for(var e=PRODUCTION_FLOW_FIELDS_MAP[t],n=0;n<e.length;n++){var i=e[n];if(-1===i.indexOf("_moisture")){var a=document.getElementById(i);a&&("input"!==a.tagName.toLowerCase()&&"select"!==a.tagName.toLowerCase()||(a.value=""))}}}function yco(){for(var t=["journalDate","shiftNumber","sampleSelection","brigadeInfo"],e=0;e<t.length;e++){var n=document.getElementById(t[e]);n&&function(t,e){var n=function(){ycl()};t.addEventListener?(t.addEventListener("change",n,!1),"journalDate"===e&&t.addEventListener("blur",n,!1)):t.attachEvent&&(t.attachEvent("onchange",n),"journalDate"===e&&t.attachEvent("onblur",n))}(n,t[e])}if(void 0!==ycf&&ycf.selectDate){var i=ycf.selectDate;ycf.selectDate=function(t){i.call(this,t),setTimeout(function(){ycl()},100)}}}function ycp(){ybz(),yck(),"function"==typeof saveCurrentSettings&&saveCurrentSettings();var t=parseInt(getElementValue("sampleSelection"))||1;if(t<6){var e=t+1;setElementValue("sampleSelection",e.toString()),alert("Дані збережено! Переходимо до відбору "+e),setTimeout(function(){ycl()},500)}else alert("Дані збережено! Всі відбори завершено."),setTimeout(function(){yt()},1e3)}function ycq(){var t=document.getElementById("journalDate"),e=document.getElementById("shiftNumber");t&&e?(yco(),ycl()):setTimeout(function(){ycq()},100)}function setSummaryWorkCurrentDate(){var t=new Date,e=t.getFullYear(),n=t.getMonth()+1,i=t.getDate(),a=e+"-"+(n<10?"0"+n:n.toString())+"-"+(i<10?"0"+i:i.toString()),s=document.getElementById("summaryWorkJournalDate");s&&!s.value&&(s.value=a)}function displayUnverifiedShifts(){var t=document.getElementById("unverifiedShiftsList"),e=document.getElementById("unverifiedShiftsContainer");if(t&&e)try{var n=ybu();if(t.innerHTML="",n&&""!==n){e.className="unverified-shifts-container";for(var i=n.split("|"),a=0;a<i.length;a++){var s=document.createElement("li");s.textContent=i[a],t.appendChild(s)}}else e.className="unverified-shifts-container all-verified",t.innerHTML="<li>Немає неверифікованих змін.</li>"}catch(o){e.className="unverified-shifts-container error",t.innerHTML="<li>Помилка завантаження списку.</li>",console.log("Помилка при отриманні неверифікованих змін: "+o.message)}}function initializeSummaryWorkDataLoading(){for(var t=["summaryWorkJournalDate","summaryWorkShiftNumber"],e=0;e<t.length;e++){var n=document.getElementById(t[e]);n&&function(t){var e=function(){loadSummaryWorkProductionFlowData()};t.addEventListener?t.addEventListener("change",e,!1):t.attachEvent&&t.attachEvent("onchange",e)}(n)}loadSummaryWorkProductionFlowData()}function loadSummaryWorkProductionFlowData(){if(window.currentUserData&&("User"===window.currentUserData.role||"Moderator"===window.currentUserData.role))try{var t=document.getElementById("summaryWorkJournalDate").value;if(!t)return void clearSummaryWorkTables();var e=document.getElementById("summaryWorkShiftNumber").value||"1",n=ybx(t,e),i=document.getElementById("verificationMessage"),a=document.querySelector("#summaryWorkFooter .save-btn");n?(i.textContent="Дані вже було верифіковано",i.className="verified",a&&(a.textContent="Підтвердити повторно",a.style.display="block")):(i.textContent="Перевірте дані та підтвердіть їх правильність",i.className="",a&&(a.textContent="Підтвердити",a.style.display="block"));var s=ybi(t,e);if(!s||""===s)return void clearSummaryWorkTables();var o,r=yag(s,window.currentUserData.xorkey),l=r.indexOf("|");if(-1!==l){var c=parseInt(r.substring(0,l));o=r.substring(l+1,l+1+c)}else o=r.trim().replace(/\0/g,"").replace(/[\x00-\x1F\x7F]/g,"");renderSummaryWorkTables(JSON.parse(o))}catch(u){console.log("Помилка завантаження зведених даних: "+u.message),clearSummaryWorkTables()}}function clearSummaryWorkTables(){var t=document.getElementById("summaryWorkTablesContainer"),e=document.querySelector("#summaryWorkspace .journal-footer");t&&(t.innerHTML="<p>Дані відсутні для вибраної дати та зміни</p>"),e&&(e.style.display="none")}function renderSummaryWorkTables(t){var e=document.getElementById("summaryWorkTablesContainer"),n=document.getElementById("summaryWorkShiftNumber").value||"1",i=document.querySelector("#summaryWorkspace .journal-footer");e.innerHTML="";for(var a=!1,s=["I драна","В/С","1/С","Висівки","Подача","I Замочка"],o=0;o<s.length;o++){var r=s[o];if(t[r]&&t[r][n]){var l=t[r][n],c=[];for(var u in l)"brigade"===u||isNaN(parseInt(u))||c.push(parseInt(u));if(c.length>0){if(a=!0,c.sort(function(t,e){return t-e}),l.brigade){var h=document.getElementById("summaryWorkBrigadeInfo");h&&(h.value=l.brigade)}var d=createSummaryWorkTableForProduct(r,l,c);e.innerHTML+=d}}}e.innerHTML+='<div class="journal-notes sieve"><strong>* Залишок на ситі №43 для В/С та №35 для 1/С</strong><br /> <strong>** Прохід через сито №43 для 1/С та №27 для Висівок</strong></div>',a?(i&&window.currentUserData&&"Moderator"===window.currentUserData.role&&(i.style.display="block"),initializeSummaryMoistureCalculation(),initializeAverageCalculations()):clearSummaryWorkTables()}function createSummaryWorkTableForProduct(t,e,n){var i=ycj(t),a=getProductColumnConfig(t),s='<div class="product-summary-table" style="margin-bottom: 24px;">';s+='<h3 style="margin-bottom: 16px; color: #334155;">'+t+"</h3>",s+='<table class="journal-table summary-table">',s+="<thead><tr>",s+='<th rowspan="2" class="col-table col-product">Відбір</th>',a.bunker&&(s+='<th rowspan="2" class="col-table col-bunker">Бункер/<br/>Силос/<br/>Яма</th>'),a.moisture&&(s+='<th colspan="4">Воло&shy;гість</th>'),a.whiteness&&(s+='<th rowspan="2" class="col-table col-whiteness">Білість,<br/>од.</th>'),a.gluten&&(s+='<th colspan="'+(a.falling_number?3:2)+'">Сира клейко&shy;вина</th>'),a.residue&&(s+='<th rowspan="2" class="col-table col-residue">Зали&shy;шок на ситі *, %</th>'),a.passage&&(s+='<th rowspan="2" class="col-table col-passage">Прохо&shy;дження<br/>через сито **, %</th>'),a.metal&&(s+='<th rowspan="2" class="col-table col-metal">Метало&shy;доміш&shy;ки,<br/>мг</th>'),a.color&&(s+='<th rowspan="2" class="col-table col-color">Колір, запах,<br/>смак</th>'),a.crunch&&(s+='<th rowspan="2" class="col-table col-crust">Хруст&shy;кість</th>'),a.infection&&(s+='<th rowspan="2" class="col-table col-infection">Зараже&shy;ність<br/>шкідни&shy;ками</th>'),s+="</tr><tr>",a.moisture&&(s+='<th class="col-table col-sample">№ бюкси</th>',s+='<th class="col-table col-mass">Маса бюкси з<br/>наваж&shy;кою 500г, мг</th>',s+='<th class="col-table col-moisture">Маса бюкси з<br/>наваж&shy;кою після<br/>сушиль&shy;ної шафи, мг</th>',s+='<th class="col-table col-avg-moisture">Середня<br/>воло&shy;гість, %</th>'),a.gluten&&(s+='<th class="col-table col-quantity">Кіль&shy;кість, %</th>',s+='<th class="col-table col-idk">ІДК, од.</th>',a.falling_number&&(s+='<th class="col-table col-falling-number">ЧП,с</th>')),s+="</tr></thead>",s+="<tbody>";for(var o=0;o<n.length;o++){var r=n[o],l=e[r]||{};s+='<tr class="product-group-'+getProductGroupClass(t)+' product-row">';var c=a.moisture?' rowspan="2"':"";s+="<td"+c+' class="product-name" style="text-align: center; font-weight: bold;">'+r+"</td>",a.bunker&&(s+="<td"+c+">"+createSummarySelectField(i+"_bunker_"+r,l[i+"_bunker"]||"",getBunkerOptions(t))+"</td>"),a.moisture&&(s+="<td>"+createSummarySelectField(i+"_sample1_"+r,l[i+"_sample1"]||"",getSampleOptions())+"</td>",s+="<td>"+createSummaryInputField(i+"_mass1_"+r,l[i+"_mass1"]||"","number")+"</td>",s+="<td>"+createSummaryInputField(i+"_dried1_"+r,l[i+"_dried1"]||"","number")+"</td>",s+="<td"+c+' style="text-align: center; font-weight: bold;"><span class="table-text number" id="summary_'+i+"_moisture_"+r+'"></span></td>'),a.whiteness&&(s+="<td"+c+">"+createSummaryInputField(i+"_whiteness_"+r,l[i+"_whiteness"]||"","number")+"</td>"),a.gluten&&(s+="<td"+c+">"+createSummaryInputField(i+"_gluten_quantity_"+r,l[i+"_gluten_quantity"]||"","number","0.1")+"</td>",s+="<td"+c+">"+createSummaryInputField(i+"_gluten_idk_"+r,l[i+"_gluten_idk"]||"","number")+"</td>"),a.falling_number&&(s+="<td"+c+">"+createSummaryInputField(i+"_falling_number_"+r,l[i+"_falling_number"]||"","number")+"</td>"),a.residue&&(s+="<td"+c+">"+createSummaryInputField(i+"_residue_"+r,l[i+"_residue"]||"","number","0.1")+"</td>"),a.passage&&(s+="<td"+c+">"+createSummaryInputField(i+"_passage_"+r,l[i+"_passage"]||"","number","0.1")+"</td>"),a.metal&&(s+="<td"+c+">"+createSummaryInputField(i+"_metal_"+r,l[i+"_metal"]||"","text")+"</td>"),a.color&&(s+="<td"+c+">"+createSummaryInputField(i+"_color_"+r,l[i+"_color"]||"","text")+"</td>"),a.crunch&&(s+="<td"+c+">"+createSummaryInputField(i+"_crunch_"+r,l[i+"_crunch"]||"","text")+"</td>"),a.infection&&(s+="<td"+c+">"+createSummaryInputField(i+"_infection_"+r,l[i+"_infection"]||"","text")+"</td>"),s+="</tr>",a.moisture&&(s+='<tr class="product-group-'+getProductGroupClass(t)+' product-row">',s+="<td>"+createSummarySelectField(i+"_sample2_"+r,l[i+"_sample2"]||"",getSampleOptions())+"</td>",s+="<td>"+createSummaryInputField(i+"_mass2_"+r,l[i+"_mass2"]||"","number")+"</td>",s+="<td>"+createSummaryInputField(i+"_dried2_"+r,l[i+"_dried2"]||"","number")+"</td>",s+="</tr>")}return s+="</tbody>",s+="<tfoot><tr>",s+='<td colspan="'+(1+(a.bunker?1:0)+(a.moisture?3:0))+'" class="footer-title">Середньозмінне значення:</td>',a.moisture&&(s+='<td class="footer-value"><span class="table-text number" id="summary_'+i+'_avg_moisture"></span></td>'),a.whiteness&&(s+='<td class="footer-value"><span class="table-text number" id="summary_'+i+'_avg_whiteness"></span></td>'),a.gluten&&(s+='<td class="footer-value"><span class="table-text number" id="summary_'+i+'_avg_gluten_quantity"></span></td>',s+='<td class="footer-value"><span class="table-text number" id="summary_'+i+'_avg_gluten_idk"></span></td>'),a.falling_number&&(s+='<td class="footer-value"><span class="table-text number" id="summary_'+i+'_avg_falling_number"></span></td>'),a.residue&&(s+='<td class="footer-value"><span class="table-text number" id="summary_'+i+'_avg_residue"></span></td>'),a.passage&&(s+='<td class="footer-value"><span class="table-text number" id="summary_'+i+'_avg_passage"></span></td>'),a.metal&&(s+='<td class="footer-value"></td>'),a.color&&(s+='<td class="footer-value"></td>'),a.crunch&&(s+='<td class="footer-value"></td>'),a.infection&&(s+='<td class="footer-value"></td>'),(s+="</tr></tfoot>")+"</table></div>"}function calculateAndDisplayShiftAverages(t){var e=ycj(t),n={moisture:"_moisture_",whiteness:"_whiteness_",gluten_quantity:"_gluten_quantity_",gluten_idk:"_gluten_idk_",falling_number:"_falling_number_",residue:"_residue_",passage:"_passage_"};for(var i in n){for(var a=[],s='[id^="summary_'+e+n[i]+'"]',o=document.querySelectorAll(s),r=0;r<o.length;r++){var l="span"===o[r].tagName.toLowerCase()?o[r].textContent||o[r].innerText:o[r].value;a.push(l)}var c=ycx(a,"whiteness"===i||"gluten_idk"===i||"falling_number"===i?0:1,!1),u=document.getElementById("summary_"+e+"_avg_"+i);u&&(u.textContent=c)}}function initializeAverageCalculations(){setTimeout(function(){for(var t=["I драна","В/С","1/С","Висівки","Подача","I Замочка"],e=["_whiteness_","_gluten_quantity_","_gluten_idk_","_falling_number_","_residue_","_passage_"],n=0;n<t.length;n++){var i=t[n],a=ycj(i);calculateAndDisplayShiftAverages(i);for(var s=0;s<e.length;s++)for(var o='input[id^="summary_'+a+e[s]+'"]',r=document.querySelectorAll(o),l=0;l<r.length;l++)(function(t){var e=function(){calculateAndDisplayShiftAverages(t)};r[l].addEventListener?(r[l].addEventListener("input",e,!1),r[l].addEventListener("change",e,!1)):r[l].attachEvent&&(r[l].attachEvent("oninput",e),r[l].attachEvent("onchange",e))})(i)}},250)}function createSummaryInputField(t,e,n,i){return'<input type="'+n+'" class="table-input '+n+'" id="summary_'+t+'" value="'+e+'"'+(i?' step="'+i+'"':"")+" />"}function calculateSummaryMoisture(t,e){return yby("summary_"+t,e)}function initializeSummaryMoistureCalculation(){setTimeout(function(){for(var t=["drama","vs","first","bran","feed","soak"],e={drama:"I драна",vs:"В/С",first:"1/С",bran:"Висівки",feed:"Подача",soak:"I Замочка"},n=0;n<t.length;n++)for(var i=t[n],a=e[i],s=1;s<=6;s++){calculateSummaryMoisture(i,s);for(var o=["_mass1_","_dried1_","_mass2_","_dried2_"],r=0;r<o.length;r++){var l="summary_"+i+o[r]+s,c=document.getElementById(l);c&&function(t,e,n){var i=function(){calculateSummaryMoisture(t,e),calculateAndDisplayShiftAverages(n)};c.addEventListener?(c.addEventListener("input",i,!1),c.addEventListener("change",i,!1)):c.attachEvent&&(c.attachEvent("oninput",i),c.attachEvent("onchange",i))}(i,s,a)}}},200)}function createSummarySelectField(t,e,n){var i='<select class="table-select" id="summary_'+t+'">';i+='<option value=""></option>';for(var a=0;a<n.length;a++){var s=e===n[a]?" selected":"";i+='<option value="'+n[a]+'"'+s+">"+n[a]+"</option>"}return i+"</select>"}function getProductColumnConfig(t){return{"I драна":{moisture:!0,bunker:!1,whiteness:!1,gluten:!1,falling_number:!1,residue:!1,passage:!1,metal:!1,color:!1,crunch:!1,infection:!1},"В/С":{moisture:!0,bunker:!0,whiteness:!0,gluten:!0,falling_number:!0,residue:!0,passage:!1,metal:!0,color:!0,crunch:!0,infection:!1},"1/С":{moisture:!0,bunker:!0,whiteness:!0,gluten:!0,falling_number:!0,residue:!0,passage:!0,metal:!0,color:!0,crunch:!0,infection:!1},"Висівки":{moisture:!0,bunker:!0,whiteness:!1,gluten:!1,falling_number:!1,residue:!1,passage:!0,metal:!0,color:!0,crunch:!1,infection:!1},"Подача":{moisture:!0,bunker:!0,whiteness:!1,gluten:!0,falling_number:!0,residue:!1,passage:!1,metal:!1,color:!0,crunch:!1,infection:!0},"I Замочка":{moisture:!0,bunker:!0,whiteness:!1,gluten:!1,falling_number:!1,residue:!1,passage:!1,metal:!1,color:!1,crunch:!1,infection:!1}}[t]||{}}function getProductGroupClass(t){return{"I драна":"1","В/С":"2","1/С":"3","Висівки":"2","Подача":"3","I Замочка":"2"}[t]||"1"}function getBunkerOptions(t){return{"В/С":["1","2","3","4","5","6","7","8","9","10"],"1/С":["1","2","3","4","5","6","7","8","9","10"],"Висівки":["11","12","13","14"],"Подача":["1","2","3"],"I Замочка":["1","2","3","4","5","6","1а","2а","3а","4а","5а","6а"]}[t]||[]}function getSampleOptions(){return["1","4a","10a","18a","1a","2a","8","9","21","22","5","6"]}function verifySummaryWorkData(){if(window.currentUserData&&"Moderator"===window.currentUserData.role)try{var t=document.getElementById("summaryWorkJournalDate").value;if(!t)return void alert("Будь ласка, вкажіть дату аналізу!");var e=collectSummaryWorkData();if(!e)return void alert("Немає даних для підтвердження!");var n=window.currentUserData.xorkey.substring(0,8),i=JSON.stringify(e),a=i.length+"|"+i,s=document.getElementById("summaryWorkShiftNumber").value||"1",o=yaf(a,n);ybo(t,o,(new Date).toISOString(),window.currentUserData.id,s),alert("Дані успішно підтверджено та збережено!"),loadSummaryWorkProductionFlowData(),displayUnverifiedShifts()}catch(r){console.log("Помилка підтвердження даних: "+r.message),alert("Помилка підтвердження: "+r.message)}else alert("Недостатньо прав доступу!")}function collectSummaryWorkData(){try{for(var t={},e=document.getElementById("summaryWorkShiftNumber").value||"1",n=document.getElementById("summaryWorkBrigadeInfo").value||"",i=["I драна","В/С","1/С","Висівки","Подача","I Замочка"],a=0;a<i.length;a++){var s=i[a],o=ycj(s),r=!1,l=document.querySelectorAll('input[id^="summary_'+o+'_"],select[id^="summary_'+o+'_"],span[id^="summary_'+o+'_moisture_"]');if(0!==l.length){for(var c={},u=0;u<l.length;u++){var h=l[u],d="";if((d="span"===h.tagName.toLowerCase()?h.textContent||h.innerText:h.value)&&""!==d.trim()){var f=h.id.split("_");if(f.length>=4){var g=f[f.length-1],p=h.id.replace("summary_","").replace("_"+g,"");c[g]||(c[g]={}),c[g][p]=d.trim(),r=!0}}}if(r){for(var g in t[s]||(t[s]={}),t[s][e]||(t[s][e]={}),c)t[s][e][g]=c[g];n&&(t[s][e].brigade=n)}}}return Object.keys(t).length>0?t:null}catch(m){return console.log("Помилка збору зведених даних: "+m.message),null}}function loadSummaryWorkSettings(){if(window.currentUserData&&"Moderator"===window.currentUserData.role)try{if(void 0!==currentUserSettings&&currentUserSettings.general){var t=currentUserSettings.general.shiftNumber;if(t){var e=document.getElementById("summaryWorkShiftNumber");e&&(e.value=t)}var n=currentUserSettings.general.brigadeInfo;if(n){var i=document.getElementById("summaryWorkBrigadeInfo");i&&!i.value&&(i.value=n)}}}catch(a){console.log("Помилка завантаження налаштувань зведеного журналу: "+a.message)}}function saveSummaryWorkSettings(){if(window.currentUserData&&"Moderator"===window.currentUserData.role)try{if(void 0!==currentUserSettings){currentUserSettings.general||(currentUserSettings.general={});var t=document.getElementById("summaryWorkShiftNumber").value,e=document.getElementById("summaryWorkBrigadeInfo").value;t&&(currentUserSettings.general.shiftNumber=t),e&&(currentUserSettings.general.brigadeInfo=e),"function"==typeof saveCurrentSettings&&saveCurrentSettings()}}catch(n){console.log("Помилка збереження налаштувань зведеного журналу: "+n.message)}}function handleSummaryWorkSettingsChange(){window.currentUserData&&"Moderator"===window.currentUserData.role&&setTimeout(function(){saveSummaryWorkSettings()},1e3)}function initializeSummaryWorkSettingsEventListeners(){if(window.currentUserData&&"Moderator"===window.currentUserData.role)for(var t=["summaryWorkShiftNumber","summaryWorkBrigadeInfo"],e=0;e<t.length;e++){var n=document.getElementById(t[e]);n&&(n.addEventListener?n.addEventListener("change",handleSummaryWorkSettingsChange,!1):n.attachEvent&&n.attachEvent("onchange",handleSummaryWorkSettingsChange))}}function initializeSummaryWorkJournal(){setSummaryWorkCurrentDate();var t=document.getElementById("summaryWorkFooter"),e=document.getElementById("unverifiedShiftsContainer");window.currentUserData&&"Moderator"===window.currentUserData.role?(t&&(t.style.display="block"),e&&(e.style.display="block"),displayUnverifiedShifts()):(t&&(t.style.display="none"),e&&(e.style.display="none")),setTimeout(function(){if(ych(),ycg("summaryWorkJournalDate"),initializeSummaryWorkDataLoading(),initializeSummaryWorkSettingsEventListeners(),void 0!==ycf&&ycf.selectDate){var t=ycf.selectDate;ycf.selectDate=function(e){t.apply(this,arguments),setTimeout(function(){loadSummaryWorkProductionFlowData()},100)}}},100)}window.yck=yck,window.ycl=ycl,window.ycp=ycp,window.ycq=ycq;var qualityJournalDisplayDate=new Date;function initializeQualityJournal(){qualityJournalDisplayDate=new Date,loadAndRenderQualityJournalData(),ydh(),initializeBunkerDetailsModal()}function changeQualityJournalMonth(t){qualityJournalDisplayDate.setMonth(qualityJournalDisplayDate.getMonth()+t),loadAndRenderQualityJournalData()}function loadAndRenderQualityJournalData(){var t=document.getElementById("quality-journal-body"),e=document.getElementById("quality-journal-table"),n=document.getElementById("quality-journal-no-data"),i=document.getElementById("qualityJournalMonthDisplay"),a=document.getElementById("quality-journal-footer"),s=document.getElementById("openChartBtn");i.textContent=["Січень","Лютий","Березень","Квітень","Травень","Червень","Липень","Серпень","Вересень","Жовтень","Листопад","Грудень"][qualityJournalDisplayDate.getMonth()]+" "+qualityJournalDisplayDate.getFullYear(),t.innerHTML='<tr><td colspan="22">Завантаження даних...</td></tr>';try{var o=ybl();if(!o)return e.style.display="none",a&&(a.style.display="none"),s&&(s.style.display="none"),n.style.display="block",void(t.innerHTML="");var r=window.currentUserData.xorkey,l=o.split("|||ROW|||"),c=[],u=[],h=qualityJournalDisplayDate.getFullYear(),d=qualityJournalDisplayDate.getMonth(),f=new Date,g=new Date;g.setHours(0,0,0,0);for(var p=0;p<l.length;p++)if(!((w=l[p].split("|||")).length<3)){(C=new Date(w[0])).setHours(0,0,0,0);var m=C.getTime()===g.getTime(),y=C<g,v=m&&f.getHours()>=15;C.getFullYear()===h&&C.getMonth()===d&&(y||v)&&c.push(l[p])}if(0===c.length)return e.style.display="none",a&&(a.style.display="none"),s&&(s.style.display="none"),n.style.display="block",void(t.innerHTML="");e.style.display="table",a&&(a.style.display="table-footer-group"),s&&(s.style.display="block"),n.style.display="none",c.sort(function(t,e){return new Date(t.split("|||")[0])-new Date(e.split("|||")[0])});var b="";for(p=0;p<c.length;p++){var w,S,C=(w=c[p].split("|||"))[0],x=w[1],k=yag(w[2],r),_=k.indexOf("|");if(-1!==_){var D=parseInt(k.substring(0,_));S=k.substring(_+1,_+1+D)}else S=k.trim().replace(/\0/g,"").replace(/[\x00-\x1F\x7F]/g,"");var P=JSON.parse(S),E="-";for(var F in P)if(P[F][x]&&P[F][x].brigade){E=P[F][x].brigade;break}var I={date:new Date(C).toLocaleDateString("uk-UA")+" (зм. "+x+")",brigade:E,feed_moisture:ydc(P["Подача"]?P["Подача"][x]:null,"feed_moisture",1),feed_gluten:ydc(P["Подача"]?P["Подача"][x]:null,"feed_gluten_quantity",1),feed_idk:ydc(P["Подача"]?P["Подача"][x]:null,"feed_gluten_idk",0),feed_falling_number:ydc(P["Подача"]?P["Подача"][x]:null,"feed_falling_number",0),drana_moisture:ydc(P["I драна"]?P["I драна"][x]:null,"drama_moisture",1),vs_moisture:ydc(P["В/С"]?P["В/С"][x]:null,"vs_moisture",1),vs_whiteness:ydc(P["В/С"]?P["В/С"][x]:null,"vs_whiteness",0),vs_residue:ydc(P["В/С"]?P["В/С"][x]:null,"vs_residue",1),vs_gluten:ydc(P["В/С"]?P["В/С"][x]:null,"vs_gluten_quantity",1),vs_idk:ydc(P["В/С"]?P["В/С"][x]:null,"vs_gluten_idk",0),vs_falling_number:ydc(P["В/С"]?P["В/С"][x]:null,"vs_falling_number",0),first_moisture:ydc(P["1/С"]?P["1/С"][x]:null,"first_moisture",1),first_whiteness:ydc(P["1/С"]?P["1/С"][x]:null,"first_whiteness",0),first_residue:ydc(P["1/С"]?P["1/С"][x]:null,"first_residue",1),first_passage:ydc(P["1/С"]?P["1/С"][x]:null,"first_passage",1),first_gluten:ydc(P["1/С"]?P["1/С"][x]:null,"first_gluten_quantity",1),first_idk:ydc(P["1/С"]?P["1/С"][x]:null,"first_gluten_idk",0),first_falling_number:ydc(P["1/С"]?P["1/С"][x]:null,"first_falling_number",0),bran_moisture:ydc(P["Висівки"]?P["Висівки"][x]:null,"bran_moisture",1),bran_passage:ydc(P["Висівки"]?P["Висівки"][x]:null,"bran_passage",1)};u.push(I),b+="<tr style='cursor: pointer;' onclick=\"showBunkerDetails('"+C+"', '"+x+"')\"><td>"+I.date+"</td><td>"+I.brigade+"</td><td>"+I.feed_moisture+"</td><td>"+I.feed_gluten+"</td><td>"+I.feed_idk+"</td><td>"+I.feed_falling_number+"</td><td>"+I.drana_moisture+"</td><td>"+I.vs_moisture+"</td><td>"+I.vs_whiteness+"</td><td>"+I.vs_gluten+"</td><td>"+I.vs_idk+"</td><td>"+I.vs_falling_number+"</td><td>"+I.vs_residue+"</td><td>"+I.first_moisture+"</td><td>"+I.first_whiteness+"</td><td>"+I.first_gluten+"</td><td>"+I.first_idk+"</td><td>"+I.first_falling_number+"</td><td>"+I.first_residue+"</td><td>"+I.first_passage+"</td><td>"+I.bran_moisture+"</td><td>"+I.bran_passage+"</td></tr>"}t.innerHTML=b;for(var L=Object.keys(u[0]).filter(function(t){return"date"!==t&&"brigade"!==t}),A=0;A<L.length;A++){var M=L[A],B=ycx(u.map(function(t){return t[M]}),M.indexOf("whiteness")>-1||M.indexOf("idk")>-1||M.indexOf("falling_number")>-1?0:1),T=document.getElementById("avg-"+M);T&&(T.textContent=B)}}catch(O){console.log("Помилка при обробці даних журналу якості: "+O.message),e.style.display="none",a&&(a.style.display="none"),s&&(s.style.display="none"),n.style.display="block",n.textContent="Помилка завантаження даних.",t.innerHTML=""}}function initializeBunkerDetailsModal(){var t=document.getElementById("bunkerDetailsModal");t&&(t.onclick=function(e){e.target===t&&closeBunkerDetailsModal()})}function closeBunkerDetailsModal(){var t=document.getElementById("bunkerDetailsModal");t&&(t.style.display="none")}function showBunkerDetails(t,e){var n=document.getElementById("bunkerDetailsModal"),i=document.getElementById("bunkerDetailsModalBody"),a=document.getElementById("bunkerDetailsModalTitle");if(n&&i&&a){n.style.display="block",i.innerHTML="<p>Завантаження даних...</p>",a.textContent="Середні показники по бункерах за "+new Date(t).toLocaleDateString("uk-UA")+" (Зміна "+e+")";try{var s=ybi(t,e);if(!s)return void(i.innerHTML="<p>Не вдалося завантажити дані для цієї зміни.</p>");var o,r=yag(s,window.currentUserData.xorkey),l=r.indexOf("|");if(-1!==l){var c=parseInt(r.substring(0,l));o=r.substring(l+1,l+1+c)}else o=r.trim().replace(/\0/g,"").replace(/[\x00-\x1F\x7F]/g,"");var u=generateBunkerTablesHTML(calculateBunkerAverages(JSON.parse(o),e));i.innerHTML=u||"<p>Немає даних по бункерах для цієї зміни.</p>"}catch(h){i.innerHTML="<p>Помилка при обробці даних: "+h.message+"</p>",console.log("Помилка в showBunkerDetails: "+h.message)}}}function calculateBunkerAverages(t,e){var n={"В/С":{},"1/С":{}},i={"В/С":"vs","1/С":"first"},a=["moisture","whiteness","gluten_quantity","gluten_idk","falling_number","residue","passage"];for(var s in i){var o=i[s],r=t[s]?t[s][e]:null;if(r)for(var l=1;l<=6;l++){var c=r[l];if(c&&c[o+"_bunker"]){var u=c[o+"_bunker"];if(!n[s][u]){n[s][u]={};for(var h=0;h<a.length;h++)n[s][u][a[h]]=[]}for(var d=0;d<a.length;d++){var f=a[d],g=c[o+"_"+f];g!==undefined&&""!==g&&n[s][u][f].push(g)}}}}for(var p in n)for(var m in n[p])for(var y in n[p][m]){var v="whiteness"===y||"gluten_idk"===y||"falling_number"===y?0:1;n[p][m][y]=ycx(n[p][m][y],v)}return n}function generateBunkerTablesHTML(t){var e="",n={moisture:"Воло&shy;гість, %",whiteness:"Бі&shy;лі&shy;сть, од.",gluten_quantity:"Сирої клей&shy;ко&shy;ви&shy;ни, %",gluten_idk:"ІДК, од.",falling_number:"Чис&shy;ло па&shy;дін&shy;ня, с",residue:"За&shy;ли&shy;шок на ситі*, %",passage:"Про&shy;ход&shy;ження че&shy;рез си&shy;то**, %"};for(var i in t){var a=Object.keys(t[i]).sort(function(t,e){return parseInt(t,10)-parseInt(e,10)});if(a.length>0){var s={};for(var o in n){var r=a.some(function(e){return t[i][e][o]&&"-"!==t[i][e][o]});r&&(s[o]=n[o])}var l=Object.keys(s);if(l.length>0){e+="<h3>"+i+"</h3>",e+='<table class="journal-table bunker-details-table">',e+="<thead><tr><th>Бункер</th>";for(var c=0;c<l.length;c++)e+="<th>"+s[l[c]]+"</th>";e+="</tr></thead><tbody>";for(var u=0;u<a.length;u++){var h=a[u];e+="<tr>",e+="<td class='bunker-label'>"+h+"</td>";for(var d=0;d<l.length;d++){var f=l[d];e+="<td>"+(t[i][h][f]||"-")+"</td>"}e+="</tr>"}e+="</tbody></table>"}}}return e}var qualityChart=null;function ydd(){var t=document.getElementById("qualityChartModal");t&&(t.style.display="block",ydf())}function yde(){var t=document.getElementById("qualityChartModal");t&&(t.style.display="none")}function ydf(){var t=document.getElementById("qualityLineChart").getContext("2d"),e=document.getElementById("chartMetricSelect").value,n=ydg(e);qualityChart&&qualityChart.destroy(),qualityChart=new Chart(t).Line(n,{responsive:!0,maintainAspectRatio:!1,legend:{position:"bottom"},scales:{xAxes:[{scaleLabel:{display:!0,labelString:"Дата (Зміна)"}}],yAxes:[{scaleLabel:{display:!0,labelString:e},ticks:{beginAtZero:!1}}]}})}function ydg(t){var e=document.getElementById("quality-journal-body");if(!e)return{labels:[],datasets:[]};var n=e.getElementsByTagName("tr"),i=[],a={},s={"Зерно":{"Вологість, %":2,"Сирої клейковини, %":3,"ІДК, од.":4,"Число падіння, с":5},"I драна":{"Вологість, %":6},"Борошно В/С":{"Вологість, %":7,"Білість, од.":8,"Сирої клейковини, %":9,"ІДК, од.":10,"Число падіння, с":11,"Залишок на ситі*, %":12},"Борошно 1/С":{"Вологість, %":13,"Білість, од.":14,"Сирої клейковини, %":15,"ІДК, од.":16,"Число падіння, с":17,"Залишок на ситі*, %":18,"Проходження через сито**, %":19},"Висівки":{"Вологість, %":20,"Проходження через сито**, %":21}},o={"Зерно":"rgba(255, 99, 132, 1)","I драна":"rgba(54, 162, 235, 1)","Борошно В/С":"rgba(255, 206, 86, 1)","Борошно 1/С":"rgba(75, 192, 124, 1)","Висівки":"rgba(153, 102, 255, 1)"};for(var r in s)s[r][t]&&(a[r]={label:r,data:[],borderColor:o[r]||"rgba(0, 0, 0, 1)",fillColor:"rgba(0,0,0,0)",strokeColor:o[r]||"rgba(0, 0, 0, 1)",pointColor:o[r]||"rgba(0, 0, 0, 1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:o[r]||"rgba(0, 0, 0, 1)"});for(var l=0;l<n.length;l++){var c=n[l].getElementsByTagName("td"),u=c[0].textContent.trim(),h=u.split(".")[0],d=u.indexOf("(зм. 1)")>-1?"I":"II";for(var r in i.push(h+"("+d+")"),a){var f=s[r][t],g=c[f]?parseFloat(c[f].textContent):null;a[r].data.push(isNaN(g)?null:g)}}var p=[];for(var m in a)p.push(a[m]);return{labels:i,datasets:p}}function ydh(){var t=document.getElementById("chartMetricSelect");t&&(t.addEventListener?t.addEventListener("change",ydf,!1):t.attachEvent("onchange",ydf));var e=document.getElementById("qualityChartModal");e&&(e.onclick=function(t){t.target===e&&yde()})}var userMap={};function initializeMoistureJournal(){loadUserListForJournal(),setMoistureJournalCurrentDate(),initializeMoistureJournalEventListeners(),setTimeout(function(){if(ych(),ycg("moistureJournalDate"),void 0!==ycf&&ycf.selectDate){var t=ycf.selectDate;ycf.selectDate=function(e){t.apply(this,arguments),setTimeout(function(){loadMoistureJournalData()},150)}}loadMoistureJournalData()},150)}function setMoistureJournalCurrentDate(){var t=new Date,e=t.getFullYear(),n=t.getMonth()+1,i=t.getDate(),a=e+"-"+(n<10?"0"+n:n)+"-"+(i<10?"0":"")+i,s=document.getElementById("moistureJournalDate");s&&!s.value&&(s.value=a)}function loadUserListForJournal(){var t=yar();if(t)for(var e=t.split("|"),n=0;n<e.length;n++){var i=e[n].split(",");i.length>=2&&(userMap[i[0]]=i[1])}}function initializeMoistureJournalEventListeners(){var t=document.getElementById("moistureJournalShiftNumber");if(t){var e=function(){loadMoistureJournalData()};t.addEventListener?t.addEventListener("change",e,!1):t.attachEvent&&t.attachEvent("onchange",e)}}function loadMoistureJournalData(){if(window.currentUserData&&window.currentUserData.xorkey)try{var t=document.getElementById("moistureJournalDate").value;if(!t)return void renderMoistureJournalTables(null,null);var e=document.getElementById("moistureJournalShiftNumber").value||"1",n=ybn(t,e);if(!n||-1===n.indexOf("|||"))return void renderMoistureJournalTables(null,null);var i=n.split("|||"),a=i[0],s=i[1];if(!a)return void renderMoistureJournalTables(null,null);var o,r=yag(a,window.currentUserData.xorkey.substring(0,8)),l=r.indexOf("|");if(-1!==l){var c=parseInt(r.substring(0,l));o=r.substring(l+1,l+1+c)}else o=r.trim().replace(/\0/g,"").replace(/[\x00-\x1F\x7F]/g,"");renderMoistureJournalTables(JSON.parse(o),s)}catch(u){console.log("Помилка завантаження даних журналу вологості: "+u.message),renderMoistureJournalTables(null,null)}}function getProductGroupClass(t){return{"I драна":"1","В/С":"2","1/С":"3","Висівки":"2","Подача":"3","I Замочка":"2"}[t]||"1"}function renderMoistureJournalTables(t,e){var n=document.getElementById("moistureJournalTablesContainer"),i=document.querySelector(".journal-info-bar"),a=document.querySelector("#moistureJournal .journal-footer"),s=document.getElementById("moistureJournalShiftNumber").value||"1",o=!1,r="";if(t)for(var l=["I драна","В/С","1/С","Висівки","Подача","I Замочка"],c=0;c<l.length;c++){var u=l[c];if(t[u]&&t[u][s]){var h=t[u][s],d=Object.keys(h).filter(function(t){return!isNaN(parseInt(t))});d.length>0&&(o=!0,d.sort(function(t,e){return parseInt(t)-parseInt(e)}),r+=createMoistureTableForProduct(u,h,d))}}if(o){var f;i&&(i.style.display="flex"),a&&(a.style.display="block"),n.innerHTML=r,document.getElementById("moistureJournalLabTechnicianInfo").textContent=userMap[e]||e||"-";for(var g=0;g<l.length;g++)if(t[l[g]]&&t[l[g]][s]){f=l[g];break}document.getElementById("moistureJournalBrigadeInfo").textContent=f&&t[f][s].brigade||"-"}else i&&(i.style.display="none"),a&&(a.style.display="none"),n.innerHTML="<p>Дані відсутні для вибраної дати та зміни.</p>"}function createMoistureTableForProduct(t,e,n){var i=ycj(t),a=0,s=0,o='<div class="product-summary-table"><h3>'+t+"</h3>";o+='<table class="journal-table summary-table moisture-table">',o+='<thead><tr><th rowspan="2">Відбір</th><th>№ бюкси</th><th>Маса порож. бюкси, мг</th><th>Маса бюкси з наваж&shy;кою, мг</th><th>Маса бюкси після сушки, мг</th><th>Різниця маси, мг</th><th>Воло&shy;гість, %</th><th rowspan="2">Середня воло&shy;гість, %</th></tr></thead><tbody>';for(var r=0;r<n.length;r++){var l=n[r],c=e[l]||{},u='class="product-group-'+getProductGroupClass(t)+'"',h=parseFloat(c[i+"_mass1"])||0,d=parseFloat(c[i+"_dried1"])||0,f=parseFloat(c[i+"_mass2"])||0,g=parseFloat(c[i+"_dried2"])||0,p=h>0?h-500:"-",m=h>0&&d>0?h-d:"-",y="-"!==m?(m/5).toFixed(1):"-",v=f>0?f-500:"-",b=f>0&&g>0?f-g:"-",w="-"!==b?(b/5).toFixed(1):"-",S=parseFloat(c[i+"_moisture"])||0;S>0&&(a+=S,s++),o+="<tr "+u+'><td rowspan="2"><span>'+l+"</span></td><td><span>"+(c[i+"_sample1"]||"-")+"</span></td><td><span>"+p+"</span></td><td><span>"+(h||"-")+"</span></td><td><span>"+(d||"-")+"</span></td><td><span>"+m+"</span></td><td><span>"+y+'</span></td><td rowspan="2"><span>'+(S>0?S.toFixed(1):"-")+"</span></td></tr>",o+="<tr "+u+"><td><span>"+(c[i+"_sample2"]||"-")+"</span></td><td><span>"+v+"</span></td><td><span>"+(f||"-")+"</span></td><td><span>"+(g||"-")+"</span></td><td><span>"+b+"</span></td><td><span>"+w+"</span></td></tr>"}return(o+='</tbody><tfoot><tr><td colspan="7" class="footer-title">Середньозмінне значення:</td><td class="footer-value"><span>'+(s>0?(a/s).toFixed(1):"-")+"</span></td></tr></tfoot>")+"</table></div>"}var userMap={};function ycr(){loadUserListForJournal(),ycu(),ycv(),setTimeout(function(){if(ych(),ycg("qualityControlJournalDate"),void 0!==ycf&&ycf.selectDate){var t=ycf.selectDate;ycf.selectDate=function(e){t.apply(this,arguments),setTimeout(function(){yct()},150)}}yct()},150)}function loadUserListForJournal(){var t=yar();if(t)for(var e=t.split("|"),n=0;n<e.length;n++){var i=e[n].split(",");i.length>=2&&(userMap[i[0]]=i[1])}}function ycu(){var t=new Date,e=t.getFullYear()+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getDate()).slice(-2),n=document.getElementById("qualityControlJournalDate");n&&!n.value&&(n.value=e)}function ycv(){for(var t=["qualityControlJournalDate","qualityControlShiftNumber"],e=0;e<t.length;e++){var n=document.getElementById(t[e]);if(n){var i=function(){yct()};n.addEventListener?n.addEventListener("change",i,!1):n.attachEvent&&n.attachEvent("onchange",i)}}}function yct(){if(window.currentUserData&&window.currentUserData.xorkey)try{var t=document.getElementById("qualityControlJournalDate").value,e=document.getElementById("qualityControlShiftNumber").value;if(!t)return void ycw(null,e,null);e=document.getElementById("qualityControlShiftNumber").value;var n=ybn(t,e);if(!n||-1===n.indexOf("|||"))return void ycw(null,e,null);var i=n.split("|||"),a=i[0],s=i[1];if(!a)return void ycw(null,e,null);var o,r=yag(a,window.currentUserData.xorkey.substring(0,8)),l=r.indexOf("|");if(-1!==l){var c=parseInt(r.substring(0,l));o=r.substring(l+1,l+1+c)}else o=r.trim().replace(/\0/g,"").replace(/[\x00-\x1F\x7F]/g,"");ycw(JSON.parse(o),e,s)}catch(u){console.log("Помилка завантаження даних для ОКЖ: "+u.message),ycw(null,null,null)}}function ycy(t,e){var n=document.getElementById(t);n&&(n.innerHTML=e)}function ycw(t,e,n){for(var i=document.querySelectorAll("#qualityControlTablesContainer .qc-section"),a=document.getElementById("qc-no-data-message"),s=document.querySelector("#qualityControlJournal .journal-info-bar"),o=document.querySelectorAll(".qc-table tbody td[id]"),r=0;r<o.length;r++)o[r].innerHTML="-";if(!t){for(r=0;r<i.length;r++)i[r].style.display="none";return a.style.display="block",void(s&&(s.style.display="none"))}for(r=0;r<i.length;r++)i[r].style.display="block";a.style.display="none",s&&(s.style.display="flex");var l={moisture:{key:"_moisture",precision:1},gluten_quantity:{key:"_gluten_quantity",precision:1},gluten_idk:{key:"_gluten_idk",precision:0},falling_number:{key:"_falling_number",precision:0},whiteness:{key:"_whiteness",precision:0},residue:{key:"_residue",precision:1},passage:{key:"_passage",precision:1},infection:{key:"_infection",isMixed:!0},color:{key:"_color",isMixed:!0},crunch:{key:"_crunch",isMixed:!0},metal:{key:"_metal",isMixed:!0,precision:2}},c={feed:{prefix:"feed",tableId:"qc_grain_feed"},drama:{prefix:"drama",tableId:"qc_grain_drana"},vs:{prefix:"vs",tableId:"qc_prod_vs"},first:{prefix:"first",tableId:"qc_prod_first"},bran:{prefix:"bran",tableId:"qc_prod_bran"}},u={},h="-",d=!1;for(var f in c){var g=c[f];u[f]={};var p=t[ycz(f)];if(p&&p[e])for(var m in d=!0,p[e].brigade&&(h=p[e].brigade),l){for(var y=l[m],v=[],b=1;b<=6;b++)if(p[e][b]){var w=p[e][b][g.prefix+y.key];v.push(w)}var S=ycx(v,y.precision,y.isMixed),C=v.map(function(t){return null===t||t===undefined||""===t||isNaN(parseFloat(t.toString().replace(",",".")))||y.precision===undefined?t:parseFloat(t.toString().replace(",",".")).toFixed(y.precision)});u[f][m]={prelim:C.filter(function(t){return t!==undefined&&""!==t}).join("<br>"),avg:S}}}if(d){for(var x in document.getElementById("qualityControlBrigadeInfo").textContent=h,document.getElementById("qualityControlLabTechnicianInfo").textContent=userMap[n]||n||"-",u)for(var k in u[x])ycy(c[x].tableId+"_"+k+"_prelim",u[x][k]&&u[x][k].prelim||"-"),ycy(c[x].tableId+"_"+k+"_avg",u[x][k]?u[x][k].avg:"-");var _=["gluten_quantity","gluten_idk","falling_number","infection","color"];for(r=0;r<_.length;r++){y=_[r];var D=u.feed&&u.feed[y]?u.feed[y].avg:"-";ycy("qc_grain_drana_"+y+"_avg",D)}}else ycw(null,e,null)}function ycz(t){return{feed:"Подача",drama:"I драна",vs:"В/С",first:"1/С",bran:"Висівки",soak:"I Замочка"}[t]}var currentDisplayDate=new Date;function yda(){currentDisplayDate=new Date,ydb()}function changeMonth(t){currentDisplayDate.setMonth(currentDisplayDate.getMonth()+t),ydb()}function ydb(){var t=document.getElementById("consolidated-journal-body"),e=document.getElementById("consolidated-table"),n=document.getElementById("consolidated-no-data");document.getElementById("currentMonthDisplay").textContent=["Січень","Лютий","Березень","Квітень","Травень","Червень","Липень","Серпень","Вересень","Жовтень","Листопад","Грудень"][currentDisplayDate.getMonth()]+" "+currentDisplayDate.getFullYear(),t.innerHTML='<tr><td colspan="18">Завантаження даних...</td></tr>';try{var i=ybm();if(!i)return e.style.display="none",n.style.display="block",void(t.innerHTML="");for(var a=window.currentUserData.xorkey.substring(0,8),s=i.split("|||ROW|||"),o=[],r=currentDisplayDate.getFullYear(),l=currentDisplayDate.getMonth(),c=0;c<s.length;c++)(h=s[c].split("|||")).length<2||(f=new Date(h[0])).getFullYear()===r&&f.getMonth()===l&&o.push(s[c]);if(0===o.length)return e.style.display="none",n.style.display="block",void(t.innerHTML="");e.style.display="table",n.style.display="none",o.sort(function(t,e){return new Date(t.split("|||")[0])-new Date(e.split("|||")[0])});var u="";for(c=0;c<o.length;c++){var h,d,f=(h=o[c].split("|||"))[0],g=yag(h[1],a),p=g.indexOf("|");if(-1!==p){var m=parseInt(g.substring(0,p));d=g.substring(p+1,p+1+m)}else d=g.trim().replace(/\0/g,"").replace(/[\x00-\x1F\x7F]/g,"");for(var y=JSON.parse(d),v=1;v<=2;v++){var b=v.toString(),w=Object.keys(y).some(function(t){return y[t]&&y[t][b]});if(w){var S="-";for(var C in y)if(y[C][b]&&y[C][b].brigade){S=y[C][b].brigade;break}var x=function(t,e,n){var i=y[t];if(i&&i[b])for(var a=1;a<=6;a++)if(i[b][a]&&i[b][a][e])return i[b][a][e];return n},k={date:new Date(f).toLocaleDateString("uk-UA"),brigade:S,drana_moisture:ydc(y["I драна"]?y["I драна"][b]:null,"drama_moisture",1),vs_moisture:ydc(y["В/С"]?y["В/С"][b]:null,"vs_moisture",1),vs_whiteness:ydc(y["В/С"]?y["В/С"][b]:null,"vs_whiteness",0),vs_metal:x("В/С","vs_metal","сл"),vs_residue:ydc(y["В/С"]?y["В/С"][b]:null,"vs_residue",1),vs_gluten:ydc(y["В/С"]?y["В/С"][b]:null,"vs_gluten_quantity",1),vs_idk:ydc(y["В/С"]?y["В/С"][b]:null,"vs_gluten_idk",0),first_moisture:ydc(y["1/С"]?y["1/С"][b]:null,"first_moisture",1),first_whiteness:ydc(y["1/С"]?y["1/С"][b]:null,"first_whiteness",0),first_metal:x("1/С","first_metal","сл"),first_residue:ydc(y["1/С"]?y["1/С"][b]:null,"first_residue",1),first_passage:ydc(y["1/С"]?y["1/С"][b]:null,"first_passage",1),first_gluten:ydc(y["1/С"]?y["1/С"][b]:null,"first_gluten_quantity",1),first_idk:ydc(y["1/С"]?y["1/С"][b]:null,"first_gluten_idk",0),bran_moisture:ydc(y["Висівки"]?y["Висівки"][b]:null,"bran_moisture",1),bran_metal:x("Висівки","bran_metal","сл")};u+="<tr><td>"+k.date+" (зм. "+b+")</td><td>"+k.brigade+"</td><td>"+k.drana_moisture+"</td><td>"+k.vs_moisture+"</td><td>"+k.vs_whiteness+"</td><td>"+k.vs_metal+"</td><td>"+k.vs_residue+"</td><td>"+k.vs_gluten+"</td><td>"+k.vs_idk+"</td><td>"+k.first_moisture+"</td><td>"+k.first_whiteness+"</td><td>"+k.first_metal+"</td><td>"+k.first_residue+"</td><td>"+k.first_passage+"</td><td>"+k.first_gluten+"</td><td>"+k.first_idk+"</td><td>"+k.bran_moisture+"</td><td>"+k.bran_metal+"</td></tr>"}}}console.log(u),t.innerHTML=u}catch(_){console.log("Помилка при обробці зведених даних: "+_.message),e.style.display="none",n.style.display="block",n.textContent="Помилка завантаження даних.",t.innerHTML=""}}function ydj(t){return t.replace(/^\uFEFF/g,"").replace(/\s*data-integrity="[^"]*"/g,"").replace(/<!--[\s\S]*?-->/g,"").replace(/\r\n/g,"\n").replace(/\r/g,"\n").replace(/>\s+</g,"><").replace(/[\t\s]{2,}/g," ").replace(/^\s+|\s+$/gm,"").replace(/\n\s*\n/g,"\n")}function ydk(t){return yab(ydj(t).toLowerCase())}function ydi(){try{var t=document.documentElement.getAttribute("data-integrity"),e=ydk(yaw());return!(!t||e!==t)||(alert("УВАГА: Файл було змінено!\nПрограма буде закрита з міркувань безпеки. "),window.close(),!1)}catch(n){return alert("Критична помилка перевірки цілісності: "+n.message),window.close(),!1}}
</script>

</html>