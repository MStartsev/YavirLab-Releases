<!DOCTYPE html>
<html data-integrity="">
<head>
<title>YavirLab</title>
<meta http-equiv="X-UA-Compatible" content="IE=10">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<HTA:APPLICATION 
    ID="YavirLabApp"
    APPLICATIONNAME="YavirLab"
    BORDER="thin"
    BORDERSTYLE="normal"
    CAPTION="yes"
    ICON=""
    SHOWINTASKBAR="yes"
    SINGLEINSTANCE="yes"
    SYSMENU="yes"
    VERSION="1.0"
    WINDOWSTATE="normal"
    SCROLL="auto">

<script language="JavaScript">
function crypto_sha256(e){function t(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function r(e,t){return e>>>t|e<<32-t}function n(e,t){return e>>>t}function a(e,t,r){return e&t^~e&r}function o(e,t,r){return e&t^e&r^t&r}function i(e){return r(e,2)^r(e,13)^r(e,22)}function s(e){return r(e,6)^r(e,11)^r(e,25)}function l(e){return r(e,7)^r(e,18)^n(e,3)}function u(e){return r(e,17)^r(e,19)^n(e,10)}return function(e){for(var t="0123456789abcdef",r="",n=0;n<4*e.length;n++)r+=t.charAt(e[n>>2]>>8*(3-n%4)+4&15)+t.charAt(e[n>>2]>>8*(3-n%4)&15);return r}(function(e,r){var n,d,c,m,g,f,p,y,h,v,w,_,b=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],D=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],S=new Array(64);for(e[r>>5]|=128<<24-r%32,e[15+(r+64>>9<<4)]=r,h=0;h<e.length;h+=16){for(n=D[0],d=D[1],c=D[2],m=D[3],g=D[4],f=D[5],p=D[6],y=D[7],v=0;v<64;v++)S[v]=v<16?e[v+h]:t(t(t(u(S[v-2]),S[v-7]),l(S[v-15])),S[v-16]),w=t(t(t(t(y,s(g)),a(g,f,p)),b[v]),S[v]),_=t(i(n),o(n,d,c)),y=p,p=f,f=g,g=t(m,w),m=c,c=d,d=n,n=t(w,_);D[0]=t(n,D[0]),D[1]=t(d,D[1]),D[2]=t(c,D[2]),D[3]=t(m,D[3]),D[4]=t(g,D[4]),D[5]=t(f,D[5]),D[6]=t(p,D[6]),D[7]=t(y,D[7])}return D}(function(e){for(var t=Array(),r=0;r<8*e.length;r+=8)t[r>>5]|=(255&e.charCodeAt(r/8))<<24-r%32;return t}(e),8*e.length))}function generateSalt(){for(var e="",t=0;t<16;t++)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return e}function hashPassword(e,t){return crypto_sha256(t+e+t)}function checkPasswordStrength(e){var t=0;return e.length>=8&&t++,/[a-z]/.test(e)&&t++,/[A-Z]/.test(e)&&t++,/[0-9]/.test(e)&&t++,/[^A-Za-z0-9]/.test(e)&&t++,t}function xorEncrypt(e,t){if(!e||!t)throw new Error("Plaintext and key are required");for(var r=stringToUTF8Bytes(e),n=stringToUTF8Bytes(t),a=[],o=0;o<r.length;o++){var i=n[o%n.length];a.push(r[o]^i)}for(var s="",l=0;l<a.length;l++)s+=String.fromCharCode(a[l]);return base64Encode(s)}function xorDecrypt(e,t){if(!e||!t)throw new Error("Encrypted data and key are required");try{for(var r=base64Decode(e),n=[],a=0;a<r.length;a++)n.push(r.charCodeAt(a));for(var o=stringToUTF8Bytes(t),i=[],s=0;s<n.length;s++){var l=o[s%o.length];i.push(n[s]^l)}return utf8BytesToString(i)}catch(u){throw new Error("Decryption failed: "+u.message)}}function generateXORKey(e){e=e||32;for(var t="",r=0;r<e;r++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*".charAt(Math.floor(70*Math.random()));return t}function base64Encode(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r="",n=0;n<e.length;){var a=e.charCodeAt(n++)<<16|(n<e.length?e.charCodeAt(n++):0)<<8|(n<e.length?e.charCodeAt(n++):0);r+=t.charAt(a>>18&63),r+=t.charAt(a>>12&63),r+=n-2<e.length?t.charAt(a>>6&63):"=",r+=n-1<e.length?t.charAt(63&a):"="}return r}function base64Decode(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r="",n=0;for(e=e.replace(/[^A-Za-z0-9+/]/g,"");n<e.length;){var a=t.indexOf(e.charAt(n++)),o=t.indexOf(e.charAt(n++)),i=t.indexOf(e.charAt(n++)),s=t.indexOf(e.charAt(n++)),l=a<<18|o<<12|i<<6|s;r+=String.fromCharCode(l>>16&255),64!==i&&(r+=String.fromCharCode(l>>8&255)),64!==s&&(r+=String.fromCharCode(255&l))}return r}function stringToUTF8Bytes(e){for(var t=[],r=0;r<e.length;r++){var n=e.charCodeAt(r);n<128?t.push(n):n<2048?(t.push(192|n>>6),t.push(128|63&n)):(t.push(224|n>>12),t.push(128|n>>6&63),t.push(128|63&n))}return t}function utf8BytesToString(e){for(var t="",r=0;r<e.length;){var n=e[r++];if(n<128)t+=String.fromCharCode(n);else if(192==(224&n)){var a=e[r++];t+=String.fromCharCode((31&n)<<6|63&a)}else if(224==(240&n)){a=e[r++];var o=e[r++];t+=String.fromCharCode((15&n)<<12|(63&a)<<6|63&o)}}return t}function trimString(e){return e.replace(/^\s+|\s+$/g,"")}function registerAdmin(){var e=document.getElementById("adminPassword").value,t=document.getElementById("adminXORKey").value;if(e&&t)if(checkPasswordStrength(e)<3)alert("Пароль занадто слабкий! Використовуйте принаймні 8 символів, включаючи великі та малі літери, цифри.");else if(t.length<16)alert("XOR ключ повинен містити мінімум 16 символів!");else if("undefined"!=typeof saveUser)try{var r=generateSalt(),n=hashPassword(e,r),a=xorEncrypt(t,e);saveUser("YavirLab",n,r,"Administrator",a),alert("Адміністратор успішно створений!\nВикористовуйте ім'я користувача 'YavirLab' та вказаний пароль для входу."),showLoginForm()}catch(o){alert("Помилка при створенні адміністратора: "+o.message)}else alert("ПОМИЛКА: VBScript функція saveUser недоступна!");else alert("Будь ласка, заповніть усі поля!")}function loginUser(){var e=trimString(document.getElementById("username").value),t=document.getElementById("password").value;if(e&&t){var r=getUserDataString(e);if(r){var n=r.split(","),a=n[0],o=n[1],i=n[2],s=n[3],l=n[4];if(hashPassword(t,i)===o){var u="";if(l&&""!==l)try{u=xorDecrypt(l,t)}catch(d){u=null}window.currentUserData={id:parseInt(a),username:e,role:s,xorkey:u},updateLastLogin(e),showSecureContent(e,s),console.log("Успішний вхід")}else alert("Невірне ім'я користувача або пароль")}else alert("Невірне ім'я користувача або пароль")}else alert("Будь ласка, заповніть усі поля!")}function logout(){console.log("Користувач виходить із системи"),window.currentUserData={},document.getElementById("username").value="",document.getElementById("password").value="",showLoginForm()}function changePassword(){var e=document.getElementById("currentPassword").value,t=document.getElementById("newPassword").value,r=document.getElementById("confirmPassword").value;if(e&&t&&r)if(t===r)if(checkPasswordStrength(t)<3)alert("Новий пароль занадто слабкий!");else{var n=window.currentUserData.username,a=getUserDataString(n);if(a){var o=a.split(","),i=o[1],s=o[2],l=o[4];if(hashPassword(e,s)===i)try{var u="";if(l&&""!==l&&"-"!==l)try{u=xorDecrypt(l,e)}catch(g){return void alert("Помилка розшифрування XOR ключа: "+g.message)}var d=generateSalt(),c=hashPassword(t,d),m="";if(""!==u)try{m=xorEncrypt(u,t)}catch(g){return void alert("Помилка шифрування XOR ключа новим паролем: "+g.message)}else m=l;changeUserPassword(n,c,d,m),alert("Пароль успішно змінено!"),document.getElementById("currentPassword").value="",document.getElementById("newPassword").value="",document.getElementById("confirmPassword").value=""}catch(g){alert("Помилка при зміні паролю: "+g.message)}else alert("Невірний поточний пароль!")}else alert("Помилка доступу до даних користувача")}else alert("Нові паролі не співпадають!");else alert("Будь ласка, заповніть усі поля!")}function createNewUser(){var e=trimString(document.getElementById("newUserName").value),t=document.getElementById("newUserPassword").value,r=document.getElementById("newUserRole").value;if(e&&t&&r)if(checkPasswordStrength(t)<2)alert("Пароль занадто слабкий! Використовуйте принаймні 6 символів.");else if(userExistsCheck(e))alert("Користувач з таким іменем вже існує!");else try{var n=generateSalt(),a=hashPassword(t,n),o="";"Guest"===r?o=window.currentUserData.xorkey?window.currentUserData.xorkey.substring(0,8):"":"User"!==r&&"Moderator"!==r||(o=window.currentUserData.xorkey||"");var i="";o&&(i=xorEncrypt(o,t)),saveUser(e,a,n,r,i),alert("Користувача "+e+" ("+r+") успішно створено!"),document.getElementById("newUserName").value="",document.getElementById("newUserPassword").value="",document.getElementById("newUserRole").selectedIndex=0}catch(s){alert("Помилка при створенні користувача: "+s.message)}else alert("Будь ласка, заповніть усі поля!")}function deleteUserById(){var e=document.getElementById("deleteUserID").value;e&&"1"!==e?confirm("Ви впевнені, що хочете видалити користувача з ID: "+e+"?")&&(deleteUser(e),alert("Користувача видалено!"),document.getElementById("deleteUserID").value="",showUsersList()):alert("Неможливо видалити адміністратора або невірний ID!")}function showUsersList(){var e=getAllUsers(),t=document.getElementById("usersList");if(e){var r=e.split("|"),n="<table border='1' style='width:100%; border-collapse:collapse; margin-bottom:16px;'>";n+="<tr><th>ID</th><th>Ім'я</th><th>Роль</th><th>Останній вхід</th></tr>";for(var a=0;a<r.length;a++)if(r[a]){var o=r[a].split(",");n+="<tr>",n+="<td>"+o[0]+"</td>",n+="<td>"+o[1]+"</td>",n+="<td>"+o[2]+"</td>",n+="<td>"+o[3]+"</td>",n+="</tr>"}n+="</table>",t.innerHTML=n}else t.innerHTML="<p>Користувачів не знайдено</p>"}function decryptAndShowXORKey(){var e=document.getElementById("decryptPassword").value;if(e){var t=getUserDataString(window.currentUserData.username);if(t){var r=t.split(","),n=r[1],a=r[2],o=r[4];if(hashPassword(e,a)!==n)return alert("Невірний пароль!"),void(document.getElementById("decryptPassword").value="");try{if(!o||""===o)return void alert("XOR ключ не знайдено в базі даних");var i=xorDecrypt(o,e);document.getElementById("xorKeyValue").value=i,document.getElementById("xorKeyGet").style.display="none",document.getElementById("xorKeyDisplay").style.display="block",document.getElementById("decryptPassword").value=""}catch(s){alert("Помилка розшифрування XOR ключа: "+s.message),document.getElementById("decryptPassword").value=""}}else alert("Помилка доступу до даних користувача")}else alert("Введіть ваш пароль!")}function copyXORKeyToClipboard(){var e=document.getElementById("xorKeyValue");try{e.select(),e.setSelectionRange(0,99999),document.execCommand("copy")?alert("XOR ключ скопійовано в буфер обміну!"):alert("Не вдалося скопіювати. Виділіть текст вручну та скопіюйте (Ctrl+C).")}catch(t){alert("Помилка копіювання: "+t.message+"\nВиділіть текст вручну та скопіюйте (Ctrl+C).")}window.getSelection&&window.getSelection().removeAllRanges()}function showAdminSetup(){hideAllForms(),document.getElementById("adminSetupForm").style.display="block"}function showSecureContent(e,t){hideAllForms(),document.getElementById("secureContent").style.display="block",document.getElementById("welcomeUser").innerText=e,document.getElementById("adminMenu").style.display="none",document.getElementById("workspaceMenu").style.display="none","Administrator"===t?document.getElementById("adminMenu").style.display="block":(document.getElementById("workspaceMenu").style.display="block",document.getElementById("workJournalLink").style.display="User"===t||"Moderator"===t?"block":"none","Moderator"===t?(document.getElementById("summaryWorkJournalLink").style.display="block",document.getElementById("workJournalLink").textContent="Робочий журнал"):document.getElementById("summaryWorkJournalLink").style.display="none")}function showLoginForm(){hideAllForms(),document.getElementById("loginForm").style.display="block",document.getElementById("username").focus(),document.getElementById("promoBoxFooter").style.display="block"}function showCreateUserForm(){window.currentUserData&&"Administrator"===window.currentUserData.role?(hideAllForms(),document.getElementById("createUserForm").style.display="block",document.getElementById("newUserName").focus()):alert("Недостатньо прав доступу!")}function showDeleteUserForm(){window.currentUserData&&"Administrator"===window.currentUserData.role?(hideAllForms(),document.getElementById("deleteUserForm").style.display="block",document.getElementById("deleteUserID").focus()):alert("Недостатньо прав доступу!")}function showUsersListForm(){window.currentUserData&&"Administrator"===window.currentUserData.role?(hideAllForms(),document.getElementById("usersListForm").style.display="block",showUsersList()):alert("Недостатньо прав доступу!")}function showChangePasswordForm(){hideAllForms(),document.getElementById("changePasswordForm").style.display="block",document.getElementById("currentPassword").focus()}function showMyXORKeyForm(){window.currentUserData&&"Administrator"===window.currentUserData.role?(hideAllForms(),document.getElementById("myXORKeyForm").style.display="block",document.getElementById("decryptPassword").focus(),document.getElementById("xorKeyDisplay").style.display="none",document.getElementById("decryptPassword").value=""):alert("Недостатньо прав доступу!")}function showWorkJournal(){hideAllForms(),document.getElementById("workspace").style.display="block",setTimeout(function(){document.getElementById("qualityTableBody")&&0===document.getElementById("qualityTableBody").children.length&&(setCurrentDate(),initializeTable())},100),initializeWorkJournal(),loadUserSettings()}function showSummaryWorkJournal(){window.currentUserData&&"Moderator"===window.currentUserData.role?(hideAllForms(),document.getElementById("summaryWorkspace").style.display="block",initializeSummaryWorkJournal(),loadSummaryWorkSettings()):alert("Недостатньо прав доступу!")}function showMoistureJournal(){window.currentUserData&&"Administrator"!==window.currentUserData.role?(hideAllForms(),document.getElementById("moistureJournal").style.display="block",initializeMoistureJournal()):alert("Доступ заборонено для вашої ролі.")}function showQualityControlJournal(){window.currentUserData&&"Administrator"!==window.currentUserData.role&&(hideAllForms(),document.getElementById("qualityControlJournal").style.display="block",initializeQualityControlJournal())}function showConsolidatedJournal(){window.currentUserData&&"Administrator"!==window.currentUserData.role?(hideAllForms(),document.getElementById("consolidatedJournal").style.display="block",initializeConsolidatedJournal()):alert("Доступ заборонено для вашої ролі.")}function returnToMainMenu(){if(window.currentUserData&&window.currentUserData.id){var e=window.currentUserData;document.getElementById("xorKeyDisplay").style.display="none",document.getElementById("xorKeyGet").style.display="block",showSecureContent(e.username,e.role)}else showLoginForm()}function hideAllForms(){for(var e=["loginForm","promoBoxFooter","adminSetupForm","secureContent","createUserForm","deleteUserForm","usersListForm","changePasswordForm","myXORKeyForm","workspace","summaryWorkspace","moistureJournal","qualityControlJournal","consolidatedJournal"],t=0;t<e.length;t++){var r=document.getElementById(e[t]);r&&(r.style.display="none")}}function togglePasswordVisibility(e,t){var r=document.getElementById(e);r&&t&&("password"===r.type?(r.type="text",t.textContent="🔒"):(r.type="password",t.textContent="👁️"))}String.prototype.padStart||(String.prototype.padStart=function(e,t){return e|=0,t=String(void 0!==t?t:" "),this.length>e?String(this):((e-=this.length)>t.length&&(t+=t.repeat(e/t.length)),t.slice(0,e)+String(this))}),String.prototype.padEnd||(String.prototype.padEnd=function(e,t){return e|=0,t=String(void 0!==t?t:" "),this.length>e?String(this):((e-=this.length)>t.length&&(t+=t.repeat(e/t.length)),String(this)+t.slice(0,e))}),String.prototype.repeat||(String.prototype.repeat=function(e){"use strict";if(null==this)throw new TypeError("can't convert "+this+" to object");var t=""+this;if((e=+e)!=e&&(e=0),e<0)throw new RangeError("repeat count must be non-negative");if(e==Infinity)throw new RangeError("repeat count must be less than infinity");if(e=Math.floor(e),0==t.length||0==e)return"";if(t.length*e>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");for(var r="",n=0;n<e;n++)r+=t;return r}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),r=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var n=arguments[1],a=0;a<r;){var o=t[a];if(e.call(n,o,a,t))return o;a++}return undefined}}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var r=Object(this),n=parseInt(r.length)||0;if(0===n)return-1;var a,o=parseInt(t)||0;if(o>=n)return-1;for(a=Math.max(o>=0?o:n-Math.abs(o),0);a<n;a++)if(a in r&&r[a]===e)return a;return-1}),Object.keys||(Object.keys=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t}),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var r,n;if(null==this)throw new TypeError("this is null or not defined");var a=Object(this),o=parseInt(a.length)||0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(r=t),n=0;n<o;){var i;n in a&&(i=a[n],e.call(r,i,n,a)),n++}}),Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),r=this,n=function(){},a=function(){return r.apply(this instanceof n?this:e,t.concat(Array.prototype.slice.call(arguments)))};return this.prototype&&(n.prototype=this.prototype),a.prototype=new n,a}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),window.currentUserData={},function(context){var layout='<div id="panel-box">  <div id="panel-dragbar"></div>  <div id="panel-header">  <span style="padding-left: 5px; font-weight: 700; color: #555;">Console</span>    <span id="panel-menu-close" style="float: right; margin-right: 8px; cursor: pointer; color: grey;" onclick="htaConsole.toggle();">&#10006;</span>    <span id="panel-menu-minimize" style="float: right; margin-top:1px;margin-right: 10px; cursor: pointer; color: grey;" onclick="htaConsole.minimize()">&#9660;</span>  </div>  <div style="background:#fff">    <div id="panel-console"></div>    <span style="padding-left:4px; font-weight:700; font-size:16px; color:#62adea">&#62;</i></span><input id="commandline">  </div>  <div id="panel-navigation">    <span style="cursor: pointer" onclick="htaConsole.clear()">&#10680;</span>    <span id="panel-menu-transparent" style="cursor: pointer" onclick="htaConsole.transparent()">&#9680;</span>  </div></div>',css={panelBox:{width:"100%",color:"#000","font-family":"Consolas, Courier","font-size":"14px",padding:"3px 0px 3px 0px",position:"fixed",bottom:"-4px",left:"0px",opacity:"1.0",display:"none","z-index":"10000"},panelDragbar:{"border-top":"3px solid #ededed","border-bottom":"1px solid #ccc",width:"100%",cursor:"row-resize"},panelHeader:{height:"24px",background:"#ededed","border-top":"1px solid #fff","border-bottom":"1px solid #cacaca","text-align":"left","font-family":"Arial"},panelConsole:{overflow:"auto",height:"150px",padding:" 0 5px 0 5px","text-align":"left",display:"block",background:"#fff"},panelNavigation:{height:"21px",width:"100%","padding-left":"4px","line-height":"1","font-size":"18px","font-weight":"700",background:"#ededed","border-top":"1px solid #cacaca","font-family":"Arial",color:"grey"},commandline:{width:"97%",border:"none","padding-left":"6px","outline-width":"0px"}},cmdHistory=[],cmdHistoryPosition=0,camelCase=function(e){return e.toLowerCase().replace(/-(.)/g,function(e,t){return t.toUpperCase()})},hyphen=function(e){return e.replace(/([a-z][A-Z])/g,function(e){return e[0]+"-"+e[1].toLowerCase()})},censor=function(e){var t=0;return function(r,n){return 0!==t&&"object"==typeof e&&"object"==typeof n&&e==n?"[Circular]":t>=29?"[Unknown]":(++t,n)}},htaConsole={init:function(){var container=document.createElement("div");for(var cssClass in container.innerHTML=layout,document.body.appendChild(container),css)for(var cssProp in css[cssClass])document.getElementById(hyphen(cssClass)).style[camelCase(cssProp)]=css[cssClass][cssProp];var dragHandler=function(e){var t="innerHeight"in window?window.innerHeight:document.documentElement.offsetHeight;document.getElementById("panel-console").style.height=t-86-e.clientY+"px"};document.getElementById("panel-dragbar").addEventListener("mousedown",function(e){e.preventDefault(),document.addEventListener("mousemove",dragHandler)}),document.addEventListener("mouseup",function(e){document.removeEventListener("mousemove",dragHandler)}),document.addEventListener("keydown",function(e){123===e.keyCode&&htaConsole.toggle()},!0),document.getElementById("panel-console").addEventListener("click",function(e){document.getElementById("commandline").focus()}),document.getElementById("commandline").addEventListener("keypress",function(evt){if(13===evt.keyCode){var sCmd=this.value;if("clear"===sCmd)htaConsole.clear(),this.value="";else if("history"===sCmd){for(var x=0;x<cmdHistory.length;x++)console.log(cmdHistory[x]);this.value=""}else if(sCmd){htaConsole.log('<span style="color:#777"; font-weight:700">&#62;</span> <span>'+sCmd+"</span>"),cmdHistory.push(sCmd);try{var evalCmd=eval(sCmd);if("object"==typeof evalCmd)try{console.log(JSON.stringify(evalCmd))}catch(e){try{console.log(JSON.stringify(evalCmd,censor(evalCmd)))}catch(e){throw e}}else console.log(evalCmd);this.value=""}catch(e){throw this.value="",e}}cmdHistoryPosition=cmdHistory.length}}),document.getElementById("commandline").addEventListener("keydown",function(e){if(38===e.keyCode){if(--cmdHistoryPosition<0&&(cmdHistoryPosition=0),cmdHistory[cmdHistoryPosition]!==undefined&&""!==cmdHistory[cmdHistoryPosition])return this.value=cmdHistory[cmdHistoryPosition],!1;if(cmdHistoryPosition===cmdHistory.length)return this.value="",!1}if(40===e.keyCode){if(++cmdHistoryPosition>=cmdHistory.length&&(cmdHistoryPosition=cmdHistory.length),cmdHistory[cmdHistoryPosition]!==undefined&&""!==cmdHistory[cmdHistoryPosition])return this.value=cmdHistory[cmdHistoryPosition],!1;if(cmdHistoryPosition===cmdHistory.length)return this.value="",!1}}),console=window||window.console;for(var method=["log","info","warn","onerror","debug","trace","dir","group","groupCollapsed","groupEnd","time","timeEnd","profile","profileEnd","dirxml","assert","count","markTimeline","timeStamp","clear","cmd"],i=0;i<method.length;i++)window.console[method[i]]||("onerror"===method[i]?console[method[i]]=function(){var e=arguments[1],t=e.split("/")[e.split("/").length-1];return htaConsole.log('<span style="color:red">&otimes;  <span>'+arguments[0]+'</span>  <span class="pull-right" style="cursor:pointer; color:blue" onclick="htaConsole.showModal(\''+e+"')\">"+t+":"+arguments[2]+"</span></span>"),!0}:console[method[i]]=function(){return!0});console={clear:function(){htaConsole.clear()},cmd:function(e){htaConsole.log('<span style="color:#777"; font-weight:700">&#62;</span> <span>'+e+"</span>")},info:function(e){htaConsole.log('<span style="color: RoyalBlue">&#9432;</span> <span>'+e+"</span>")},log:function(e){htaConsole.log('<span style="padding-left: 2px;">'+e+"</span>")},warn:function(e){htaConsole.log('<span style="color: orange">&#9888;</span> <span>'+e+"</span>")},error:function(e){throw e}}},log:function(e){var t=document.createElement("div");t.innerHTML=e+"<br>",document.getElementById("panel-console").appendChild(t),this.consoleresize()},consoleresize:function(){var e=document.getElementById("panel-console");e.scrollTop=e.scrollHeight},clear:function(){document.getElementById("panel-console").innerHTML=""},transparent:function(){var e=document.getElementById("panel-box"),t=document.getElementById("panel-menu-transparent");"0.5"===e.style.opacity?(e.style.opacity="1.0",t.innerHTML="&#9680;"):(e.style.opacity="0.5",t.innerHTML="&#9899;")},minimize:function(){var e=document.getElementById("panel-console"),t=document.getElementById("panel-menu-minimize");"block"===e.style.display?(this.panelConsoleHeight=e.style.height,e.style.height="0px",e.style.display="none",t.innerHTML="&#9650;"):(e.style.height=this.panelConsoleHeight,e.style.display="block",t.innerHTML="&#9660;",this.consoleresize())},toggle:function(){var e=document.getElementById("panel-box");"block"===e.style.display?e.style.display="none":(e.style.display="block",this.consoleresize())},showModal:function(e){window.open(e)}};return context.htaConsole=htaConsole}(window).init();var currentUserSettings={},settingsUpdateTimeout=null,SETTINGS_SAVE_DELAY=2e3,PRODUCT_FIELDS_MAP={general:["sampleSelection","shiftNumber","brigadeInfo"],"I драна":["drama_sample1","drama_mass1","drama_sample2","drama_mass2"],"В/С":["vs_bunker","vs_sample1","vs_mass1","vs_sample2","vs_mass2","vs_residue","vs_metal","vs_color","vs_crunch"],"1/С":["first_bunker","first_sample1","first_mass1","first_sample2","first_mass2","first_residue","first_passage","first_metal","first_color","first_crunch"],"Висівки":["bran_bunker","bran_sample1","bran_mass1","bran_sample2","bran_mass2","bran_passage","bran_metal","bran_color"],"Подача":["feed_bunker","feed_sample1","feed_mass1","feed_sample2","feed_mass2","feed_color","feed_infection"],"I Замочка":["soak_bunker","soak_sample1","soak_mass1","soak_sample2","soak_mass2"]};function initializeUserSettings(){if(window.currentUserData&&"Guest"!==window.currentUserData.role)try{var e=GetUserSettings(window.currentUserData.id);if(e&&""!==e){var t=xorDecrypt(e,window.currentUserData.xorkey),r=t.indexOf("|");if(-1!==r){var n=parseInt(t.substring(0,r)),a=t.substring(r+1,r+1+n);try{currentUserSettings=JSON.parse(a)}catch(i){currentUserSettings=createDefaultSettings()}}else{var o=t.trim().replace(/\0/g,"").replace(/[\x00-\x1F\x7F]/g,"");try{currentUserSettings=JSON.parse(o)}catch(i){currentUserSettings=createDefaultSettings()}}}else currentUserSettings=createDefaultSettings();applySettingsToForm()}catch(s){currentUserSettings=createDefaultSettings()}}function createDefaultSettings(){return{general:{},products:{},productStates:{drama:!0,vs:!0,first:!0,bran:!0,feed:!0,soak:!0}}}function applySettingsToForm(){try{if(currentUserSettings.general)for(var e=0;e<PRODUCT_FIELDS_MAP.general.length;e++){var t=PRODUCT_FIELDS_MAP.general[e];(i=currentUserSettings.general[t])!==undefined&&setElementValue(t,i)}if(currentUserSettings.products)for(var r in PRODUCT_FIELDS_MAP)if("general"!==r){var n=currentUserSettings.products[r];if(n)for(var a=PRODUCT_FIELDS_MAP[r],o=0;o<a.length;o++){var i;(i=n[t=a[o]])!==undefined&&setElementValue(t,i)}}if(currentUserSettings.productStates&&void 0!==productToggleStates)for(var s in currentUserSettings.productStates)productToggleStates.hasOwnProperty(s)&&(productToggleStates[s]=currentUserSettings.productStates[s])}catch(l){}}function saveCurrentSettings(){if(window.currentUserData&&"Guest"!==window.currentUserData.role)try{currentUserSettings.general={};for(var e=0;e<PRODUCT_FIELDS_MAP.general.length;e++){var t=PRODUCT_FIELDS_MAP.general[e];(s=getElementValue(t))&&(currentUserSettings.general[t]=s)}for(var r in currentUserSettings.products={},PRODUCT_FIELDS_MAP)if("general"!==r){for(var n={},a=PRODUCT_FIELDS_MAP[r],o=!1,i=0;i<a.length;i++){var s;t=a[i],(s=getElementValue(t))&&(n[t]=s,o=!0)}o&&(currentUserSettings.products[r]=n)}if(void 0!==productToggleStates)for(var l in currentUserSettings.productStates={},productToggleStates)currentUserSettings.productStates[l]=productToggleStates[l];var u=JSON.stringify(currentUserSettings);try{JSON.parse(u);var d=xorEncrypt(u.length+"|"+u,window.currentUserData.xorkey);SaveUserSettings(window.currentUserData.id,d),console.log("Налаштування збережено для користувача: "+window.currentUserData.username)}catch(c){return}}catch(m){}}function getElementValue(e){var t=document.getElementById(e);return t?t.value:""}function setElementValue(e,t){var r=document.getElementById(e);r&&t!==undefined&&null!==t&&(r.value=t)}function handleSettingsChange(){window.currentUserData&&"Guest"!==window.currentUserData.role&&(settingsUpdateTimeout&&clearTimeout(settingsUpdateTimeout),settingsUpdateTimeout=setTimeout(function(){saveCurrentSettings()},SETTINGS_SAVE_DELAY))}function initializeSettingsEventListeners(){if(window.currentUserData&&"Guest"!==window.currentUserData.role){var e=[];for(var t in e=e.concat(PRODUCT_FIELDS_MAP.general),PRODUCT_FIELDS_MAP)"general"!==t&&(e=e.concat(PRODUCT_FIELDS_MAP[t]));for(var r=0;r<e.length;r++){var n=document.getElementById(e[r]);n&&(n.addEventListener?(n.addEventListener("change",handleSettingsChange,!1),n.addEventListener("input",handleSettingsChange,!1)):n.attachEvent&&(n.attachEvent("onchange",handleSettingsChange),n.attachEvent("oninput",handleSettingsChange)))}}}function saveProductStatesQuick(){if(window.currentUserData&&"Guest"!==window.currentUserData.role)try{if(void 0!==productToggleStates){for(var e in currentUserSettings.productStates||(currentUserSettings.productStates={}),productToggleStates)currentUserSettings.productStates[e]=productToggleStates[e];saveCurrentSettings()}}catch(t){}}function loadUserSettings(){initializeUserSettings(),initializeSettingsEventListeners()}function saveUserSettingsManually(){saveCurrentSettings()}var DatePicker={currentDate:new Date,selectedDate:new Date,isOpen:!1,targetInput:null,activeDates:null,init:function(){this.createDatePicker(),this.attachEvents()},createDatePicker:function(){document.body.insertAdjacentHTML("beforeend",'<div id="datepicker" class="datepicker" style="display: none;"><div class="datepicker-header"><button type="button" class="datepicker-btn" id="prevMonth">&lt;</button><span class="datepicker-title" id="monthYear"></span><button type="button" class="datepicker-btn" id="nextMonth">&gt;</button></div><div class="datepicker-calendar"><div class="datepicker-weekdays"><span>Пн</span><span>Вт</span><span>Ср</span><span>Чт</span><span>Пт</span><span>Сб</span><span>Нд</span></div><div class="datepicker-days" id="calendarDays"></div></div><div class="datepicker-footer"><button type="button" class="datepicker-btn" id="todayBtn">Сьогодні</button><button type="button" class="datepicker-btn" id="closeBtn">Закрити</button></div></div>')},attachEvents:function(){var e=this;document.getElementById("prevMonth").onclick=function(){e.previousMonth()},document.getElementById("nextMonth").onclick=function(){e.nextMonth()},document.getElementById("todayBtn").onclick=function(){e.selectToday()},document.getElementById("closeBtn").onclick=function(){e.close()},document.getElementById("calendarDays").onclick=function(t){for(var r=t.target||t.srcElement;r&&r!==this;){if(r.className.indexOf("datepicker-day")>-1)return void(-1===r.className.indexOf("disabled")&&e.selectDate(r.getAttribute("data-date")));r=r.parentNode}},document.onclick=function(t){var r=document.getElementById("datepicker"),n=t.target||t.srcElement;e.isOpen&&!e.isChildOf(n,r)&&n!==e.targetInput&&e.close()},document.onkeydown=function(t){if(e.isOpen){var r=t.keyCode||t.which;return 27===r?(e.close(),e.targetInput.focus(),t.preventDefault?t.preventDefault():t.returnValue=!1,!1):13===r?(e.selectToday(),t.preventDefault?t.preventDefault():t.returnValue=!1,!1):37===r?(e.previousMonth(),t.preventDefault?t.preventDefault():t.returnValue=!1,!1):39===r?(e.nextMonth(),t.preventDefault?t.preventDefault():t.returnValue=!1,!1):void 0}}},isChildOf:function(e,t){if(!e||!t)return!1;for(;e&&e!==t;)e=e.parentNode;return e===t},loadActiveDates:function(e,t){var r=this;r.activeDates=null;var n="";if("summary"===e?n="PFUpdatedDate":"moisture"===e&&(n="VPFUpdatedDate"),""!==n)try{var a=GetDatesWithData(n);a&&-1===a.indexOf("Error:")?r.activeDates=a.split(","):r.activeDates=[]}catch(o){console.log("Помилка VBScript GetDatesWithData: "+o.message),r.activeDates=[]}t()},show:function(e){var t=this;this.targetInput=e;var r="";"summaryWorkJournalDate"===e.id?r="summary":"moistureJournalDate"!==e.id&&"qualityControlJournalDate"!==e.id||(r="moisture");var n=e.value;if(n){var a=n.split("-");this.selectedDate=new Date(a[0],a[1]-1,a[2]),this.currentDate=new Date(this.selectedDate)}else this.selectedDate=new Date,this.currentDate=new Date;this.loadActiveDates(r,function(){t.isOpen=!0,t.render(),t.position(e),document.getElementById("datepicker").style.display="block"})},position:function(e){var t=document.getElementById("datepicker"),r=e.getBoundingClientRect(),n=r.bottom+window.pageYOffset+5,a=r.left+window.pageXOffset;a+280>window.innerWidth&&(a=window.innerWidth-280-10),n+350>window.innerHeight+window.pageYOffset&&(n=r.top+window.pageYOffset-350-5),t.style.top=n+"px",t.style.left=a+"px"},render:function(){this.renderHeader(),this.renderDays()},renderHeader:function(){var e=["Січень","Лютий","Березень","Квітень","Травень","Червень","Липень","Серпень","Вересень","Жовтень","Листопад","Грудень"][this.currentDate.getMonth()]+" "+this.currentDate.getFullYear();document.getElementById("monthYear").textContent=e},renderDays:function(){var e=document.getElementById("calendarDays");e.innerHTML="";for(var t=this.currentDate.getFullYear(),r=this.currentDate.getMonth(),n=new Date(t,r,1),a=new Date(t,r+1,0),o=(n.getDay()+6)%7,i=new Date(t,r,0),s="",l=0,u=o-1;u>=0;u--)s+='<div class="datepicker-day other-month disabled">'+(i.getDate()-u)+"</div>",l++;for(var d=1;d<=a.getDate();d++){var c=t+"-"+(r+1<10?"0":"")+(r+1)+"-"+(d<10?"0":"")+d,m=t+"-"+(r+1)+"-"+d,g="datepicker-day";null!==this.activeDates&&-1===this.activeDates.indexOf(c)&&(g+=" disabled");var f=new Date;t===f.getFullYear()&&r===f.getMonth()&&d===f.getDate()&&(g+=" today"),this.selectedDate&&t===this.selectedDate.getFullYear()&&r===this.selectedDate.getMonth()&&d===this.selectedDate.getDate()&&(g+=" selected"),s+='<div class="'+g+'" data-date="'+m+'">'+d+"</div>",l++}var p=42-l;for(d=1;d<=p;d++)s+='<div class="datepicker-day other-month disabled">'+d+"</div>";e.innerHTML=s},selectDate:function(e){var t=e.split("-"),r=parseInt(t[0]),n=parseInt(t[1])-1,a=parseInt(t[2]);this.selectedDate=new Date(r,n,a);var o=r+"-"+(n+1<10?"0":"")+(n+1)+"-"+(a<10?"0":"")+a;this.targetInput.value=o,this.targetInput.onchange&&this.targetInput.onchange(),this.close()},selectToday:function(){var e=new Date,t=e.getFullYear(),r=e.getMonth(),n=e.getDate();this.selectDate(t+"-"+(r+1)+"-"+n)},previousMonth:function(){this.currentDate.setMonth(this.currentDate.getMonth()-1),this.render()},nextMonth:function(){this.currentDate.setMonth(this.currentDate.getMonth()+1),this.render()},close:function(){this.isOpen=!1,document.getElementById("datepicker").style.display="none"}};function attachDatePicker(e){var t=document.getElementById(e);t&&(t.parentNode.className+=" datepicker-input",t.onclick=function(){DatePicker.show(t)},t.onkeydown=function(e){var r=e.keyCode||e.which;return 9===r||(27===r&&DatePicker.isOpen&&DatePicker.close(),13!==r&&32!==r||DatePicker.show(t),e.preventDefault?e.preventDefault():e.returnValue=!1,!1)})}function initializeDatePicker(){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){DatePicker.init()}):DatePicker.init()}var productToggleStates={drama:!0,vs:!0,first:!0,bran:!0,feed:!0,soak:!0};function calculateMoisture(e,t){t=t?"_"+t:"";try{var r=parseFloat(getElementValue(e+"_mass1"+t))||0,n=parseFloat(getElementValue(e+"_dried1"+t))||0,a=parseFloat(getElementValue(e+"_mass2"+t))||0,o=parseFloat(getElementValue(e+"_dried2"+t))||0,i=0,s=0,l="";n>0&&r>0&&(i=(r-n)/5,i=Math.round(10*i)/10),o>0&&a>0&&(s=(a-o)/5,s=Math.round(10*s)/10),n&&o&&(l=(r-n+(a-o))/10,((l=Math.round(10*l)/10)<=0||l>=100)&&(l=""));var u=document.getElementById(e+"_moisture"+t);if(u){var d=u.parentNode;d.style.position="relative";var c=d.querySelector(".moisture-1");c||((c=document.createElement("span")).className="moisture-single moisture-1",d.appendChild(c));var m=d.querySelector(".moisture-2");m||((m=document.createElement("span")).className="moisture-single moisture-2",d.appendChild(m)),c.textContent=i>0?i.toFixed(1):"",u.textContent=l.toString(),m.textContent=s>0?s.toFixed(1):""}return l}catch(g){return 0}}function calculateAllMoisture(){for(var e=["drama","vs","first","bran","feed","soak"],t=0;t<e.length;t++)calculateMoisture(e[t])}function handleMassChange(e){calculateMoisture(e)}function initializeMoistureCalculation(){for(var e=["drama","vs","first","bran","feed","soak"],t=0;t<e.length;t++)for(var r=e[t],n=["_mass1","_dried1","_mass2","_dried2"],a=0;a<n.length;a++){var o=r+n[a],i=document.getElementById(o);i&&function(e){i.addEventListener?(i.addEventListener("input",function(){handleMassChange(e)},!1),i.addEventListener("change",function(){handleMassChange(e)},!1)):i.attachEvent&&(i.attachEvent("oninput",function(){handleMassChange(e)}),i.attachEvent("onchange",function(){handleMassChange(e)}))}(r)}calculateAllMoisture()}function setCurrentDate(){var e=new Date,t=e.getFullYear(),r=e.getMonth()+1,n=e.getDate(),a=t+"-"+(r<10?"0"+r:r.toString())+"-"+(n<10?"0"+n:n.toString()),o=document.getElementById("journalDate");o&&!o.value&&(o.value=a)}function getElementValue(e){var t=document.getElementById(e);return t?t.value:""}function initializeMassFieldsNavigation(){for(var e=["drama","vs","first","bran","feed","soak"],t=["_mass1","_mass2","_dried1","_dried2"],r=0;r<e.length;r++)for(var n=e[r],a=0;a<t.length;a++){var o=n+t[a],i=document.getElementById(o);i&&function(e,t){e.addEventListener?e.addEventListener("keydown",function(r){handleMassFieldKeydown(r,e,t)},!1):e.attachEvent&&e.attachEvent("onkeydown",function(r){handleMassFieldKeydown(r||window.event,e,t)})}(i,n)}}function handleMassFieldKeydown(e,t,r){var n=e.keyCode||e.which;if(38===n||40===n){e.preventDefault?e.preventDefault():e.returnValue=!1;var a,o=parseFloat(t.value)||0;return a=38===n?o+1:Math.max(0,o-1),t.value=a,calculateMoisture(r),!1}}function toggleProductRow(e){try{productToggleStates[e]=!productToggleStates[e];var t=productToggleStates[e],r=document.querySelectorAll('tr[data-product="'+e+'"]');if(!r||0===r.length)return;for(var n=document.querySelector('button[onclick*="'+e+'"]'),a=[],o=[],i=document.querySelectorAll('input[id^="'+e+'_"], select[id^="'+e+'_"]'),s=0;s<i.length;s++)"input"===i[s].tagName.toLowerCase()?a.push(i[s]):"select"===i[s].tagName.toLowerCase()&&o.push(i[s]);if(t){for(var l=0;l<r.length;l++)r[l].className=r[l].className.replace(/ inactive/g,"");for(var u=0;u<a.length;u++)a[u].disabled=!1,a[u].style.backgroundColor="",a[u].style.color="",a[u].style.borderColor="",a[u].style.cursor="";for(var d=0;d<o.length;d++)o[d].disabled=!1,o[d].style.backgroundColor="",o[d].style.color="",o[d].style.borderColor="",o[d].style.cursor="";n&&(n.className=n.className.replace(/ inactive/g,""),n.textContent="−",n.title="Деактивувати продукцію")}else{for(var c=0;c<r.length;c++)-1===r[c].className.indexOf("inactive")&&(r[c].className+=" inactive");for(var m=0;m<a.length;m++)a[m].disabled=!0;for(var g=0;g<o.length;g++)o[g].disabled=!0;n&&(-1===n.className.indexOf("inactive")&&(n.className+=" inactive"),n.textContent="+",n.title="Активувати продукцію")}t&&setTimeout(function(){calculateMoisture(e)},100),handleProductToggleChange()}catch(f){}}function initializeProductToggleStates(){try{for(var e=["drama","vs","first","bran","feed","soak"],t=0;t<e.length;t++){var r=e[t];productToggleStates[r]=!0;var n=document.querySelector('button[onclick*="'+r+'"]');n&&(n.textContent="−",n.title="Деактивувати продукцію")}}catch(a){}}function loadProductToggleStates(){if(window.currentUserData&&"Guest"!==window.currentUserData.role)try{if(currentUserSettings&&currentUserSettings.productStates){var e=currentUserSettings.productStates;for(var t in e)if(productToggleStates.hasOwnProperty(t)){var r=e[t];productToggleStates[t]=r,applyProductRowState(t,r)}}}catch(n){}}function applyProductRowState(e,t){try{var r=document.querySelectorAll('tr[data-product="'+e+'"]');if(!r||0===r.length)return;var n=document.querySelector('button[onclick*="'+e+'"]'),a=document.querySelectorAll('input[id^="'+e+'_"], select[id^="'+e+'_"]');if(t){for(var o=0;o<r.length;o++)r[o].className=r[o].className.replace(/ inactive/g,"");for(var i=0;i<a.length;i++)a[i].disabled=!1,a[i].style.backgroundColor="",a[i].style.color="",a[i].style.borderColor="",a[i].style.cursor="";n&&(n.className=n.className.replace(/ inactive/g,""),n.textContent="−",n.title="Деактивувати продукцію")}else{for(var s=0;s<r.length;s++)-1===r[s].className.indexOf("inactive")&&(r[s].className+=" inactive");for(var l=0;l<a.length;l++)a[l].disabled=!0;n&&(-1===n.className.indexOf("inactive")&&(n.className+=" inactive"),n.textContent="+",n.title="Активувати продукцію")}}catch(u){}}function initializeWorkJournal(){setCurrentDate(),initializeProductToggleStates(),initializeMoistureCalculation(),initializeMassFieldsNavigation(),initializeProductionFlow(),setTimeout(function(){initializeDatePicker(),attachDatePicker("journalDate")},100)}function loadUserSettings(){initializeUserSettings(),initializeSettingsEventListeners(),setTimeout(function(){loadProductToggleStates(),"function"==typeof loadProductionFlowData&&(loadProductionFlowData(),console.log("ProductionFlow дані завантажено"))},500)}function handleProductToggleChange(){window.currentUserData&&"Guest"!==window.currentUserData.role&&setTimeout(function(){"function"==typeof saveProductStatesQuick?saveProductStatesQuick():saveCurrentSettings()},100)}var PRODUCTION_FLOW_FIELDS_MAP={"I драна":["drama_sample1","drama_mass1","drama_dried1","drama_sample2","drama_mass2","drama_dried2","drama_moisture"],"В/С":["vs_bunker","vs_sample1","vs_mass1","vs_dried1","vs_sample2","vs_mass2","vs_dried2","vs_moisture","vs_whiteness","vs_gluten_quantity","vs_gluten_bdk","vs_falling_number","vs_residue","vs_metal","vs_color","vs_crunch"],"1/С":["first_bunker","first_sample1","first_mass1","first_dried1","first_sample2","first_mass2","first_dried2","first_moisture","first_whiteness","first_gluten_quantity","first_gluten_bdk","first_falling_number","first_residue","first_passage","first_metal","first_color","first_crunch"],"Висівки":["bran_bunker","bran_sample1","bran_mass1","bran_dried1","bran_sample2","bran_mass2","bran_dried2","bran_moisture","bran_passage","bran_metal","bran_color"],"Подача":["feed_bunker","feed_sample1","feed_mass1","feed_dried1","feed_sample2","feed_mass2","feed_dried2","feed_moisture","feed_gluten_quantity","feed_gluten_bdk","feed_falling_number","feed_color","feed_infection"],"I Замочка":["soak_bunker","soak_sample1","soak_mass1","soak_dried1","soak_sample2","soak_mass2","soak_dried2","soak_moisture"]};function collectProductionFlowData(){try{var e={},t=getElementValue("shiftNumber")||"1",r=getElementValue("brigadeInfo")||"",n=getElementValue("sampleSelection")||"1";for(var a in PRODUCTION_FLOW_FIELDS_MAP){var o=getProductPrefixByName(a);if(productToggleStates[o]){for(var i={},s=!1,l=PRODUCTION_FLOW_FIELDS_MAP[a],u=0;u<l.length;u++){var d=l[u],c="",m=document.getElementById(d);m&&(c=-1!==d.indexOf("_moisture")&&"span"===m.tagName.toLowerCase()?m.textContent||m.innerText:m.value),c&&""!==c.trim()&&(i[d]=c.trim(),s=!0)}s&&(e[a]||(e[a]={}),e[a][t]||(e[a][t]={}),e[a][t][n]=i,e[a][t].brigade=r)}}return e}catch(g){return{}}}function getProductPrefixByName(e){return{"I драна":"drama","В/С":"vs","1/С":"first","Висівки":"bran","Подача":"feed","I Замочка":"soak"}[e]||""}function saveProductionFlowData(){if(window.currentUserData&&"Guest"!==window.currentUserData.role)try{var e=collectProductionFlowData();if(0===Object.keys(e).length)return;var t=getElementValue("journalDate");if(!t)return void alert("Будь ласка, вкажіть дату аналізу!");var r=getElementValue("shiftNumber")||"1",n={},a=GetProductionFlowData(t);if(a&&""!==a)try{var o,i=xorDecrypt(a,window.currentUserData.xorkey),s=i.indexOf("|");if(-1!==s){var l=parseInt(i.substring(0,s));o=i.substring(s+1,s+1+l)}else o=i.trim().replace(/\0/g,"").replace(/[\x00-\x1F\x7F]/g,"");n=JSON.parse(o)}catch(g){console.log("Помилка завантаження існуючих даних: "+g.message),n={}}var u=mergeProductionFlowData(n,e),d=JSON.stringify(u),c=xorEncrypt(d.length+"|"+d,window.currentUserData.xorkey),m=(new Date).toISOString();SaveProductionFlowData(t,c,m,window.currentUserData.id,r),console.log("ProductionFlow збережено з об'єднанням для дати: "+t+" та зміни: "+r)}catch(g){console.log("Помилка збереження ProductionFlow: "+g.message),alert("Помилка збереження даних: "+g.message)}}function mergeProductionFlowData(e,t){try{var r=JSON.parse(JSON.stringify(e));for(var n in t)for(var a in r[n]||(r[n]={}),t[n])for(var o in r[n][a]||(r[n][a]={}),t[n][a])r[n][a][o]=t[n][a][o];return console.log("Дані успішно об'єднано"),r}catch(i){return e}}function loadProductionFlowData(){clearAllProductFields();var e=getElementValue("shiftNumber")||"1";if(window.currentUserData&&window.currentUserData.xorkey)try{var t=document.getElementById("verifiedDataMessage"),r=document.getElementById("qualityTable"),n=document.querySelector("#workspace .journal-footer"),a=getElementValue("journalDate");if(!a)return void loadDefaultValuesFromSettings();var o=GetProductionFlowData(a);if(o&&""!==o){var i,s=xorDecrypt(o,window.currentUserData.xorkey),l=s.indexOf("|");if(-1!==l){var u=parseInt(s.substring(0,l));i=s.substring(l+1,l+1+u)}else i=s.trim().replace(/\0/g,"").replace(/[\x00-\x1F\x7F]/g,"");applyProductionFlowDataToForm(JSON.parse(i),e,getElementValue("sampleSelection")||"1")}else loadDefaultValuesFromSettings();IsDataVerifiedForDate(a,e)?(t&&(t.style.display="block"),r&&(r.style.display="none"),n&&(n.style.display="none"),console.log("Дані для "+a+" верифіковано. Редагування заблоковано.")):(t&&(t.style.display="none"),r&&(r.style.display="table"),n&&(n.style.display="block"))}catch(d){console.log("Помилка завантаження ProductionFlow: "+d.message),loadDefaultValuesFromSettings()}else loadDefaultValuesFromSettings()}function applyProductionFlowDataToForm(e,t,r){try{var n=0,a="";for(var o in PRODUCTION_FLOW_FIELDS_MAP)if(e[o]&&e[o][t]&&e[o][t][r]){var i=e[o][t][r],s=PRODUCTION_FLOW_FIELDS_MAP[o];!a&&e[o][t].brigade&&(a=e[o][t].brigade);for(var l=0;l<s.length;l++){var u=s[l];if(-1===u.indexOf("_moisture")&&i.hasOwnProperty(u)){var d=i[u],c=document.getElementById(u);c&&(c.value=d,n++)}}}if(a){var m=getElementValue("brigadeInfo");m&&""!==m||setElementValue("brigadeInfo",a)}n>0?setTimeout(function(){calculateAllMoisture()},100):loadDefaultValuesFromSettings()}catch(g){loadDefaultValuesFromSettings()}}function loadDefaultValuesFromSettings(){try{var e=getElementValue("shiftNumber"),t=getElementValue("sampleSelection"),r=getElementValue("brigadeInfo"),n=getElementValue("journalDate");if(void 0!==currentUserSettings&&currentUserSettings.products)for(var a in currentUserSettings.products)if(currentUserSettings.products.hasOwnProperty(a)){var o=currentUserSettings.products[a];for(var i in o)if(o.hasOwnProperty(i)){var s=document.getElementById(i);s&&(s.value=o[i])}}e&&setElementValue("shiftNumber",e),t&&setElementValue("sampleSelection",t),r&&setElementValue("brigadeInfo",r),n&&setElementValue("journalDate",n),setTimeout(function(){calculateAllMoisture()},50)}catch(l){}}function clearAllProductFields(){for(var e in PRODUCTION_FLOW_FIELDS_MAP)for(var t=PRODUCTION_FLOW_FIELDS_MAP[e],r=0;r<t.length;r++){var n=t[r];if(-1===n.indexOf("_moisture")){var a=document.getElementById(n);a&&("input"!==a.tagName.toLowerCase()&&"select"!==a.tagName.toLowerCase()||(a.value=""))}}}function initializeProductionFlowOnChange(){for(var e=["journalDate","shiftNumber","sampleSelection","brigadeInfo"],t=0;t<e.length;t++){var r=document.getElementById(e[t]);r&&function(e,t){var r=function(){loadProductionFlowData()};e.addEventListener?(e.addEventListener("change",r,!1),"journalDate"===t&&e.addEventListener("blur",r,!1)):e.attachEvent&&(e.attachEvent("onchange",r),"journalDate"===t&&e.attachEvent("onblur",r))}(r,e[t])}if(void 0!==DatePicker&&DatePicker.selectDate){var n=DatePicker.selectDate;DatePicker.selectDate=function(e){n.call(this,e),setTimeout(function(){loadProductionFlowData()},100)}}}function saveJournalDataWithProductionFlow(){calculateAllMoisture(),saveProductionFlowData(),"function"==typeof saveCurrentSettings&&saveCurrentSettings();var e=parseInt(getElementValue("sampleSelection"))||1;if(e<6){var t=e+1;setElementValue("sampleSelection",t.toString()),alert("Дані збережено! Переходимо до відбору "+t),setTimeout(function(){loadProductionFlowData()},500)}else alert("Дані збережено! Всі відбори завершено."),setTimeout(function(){returnToMainMenu()},1e3)}function initializeProductionFlow(){console.log("Ініціалізація ProductionFlow модуля");var e=document.getElementById("journalDate"),t=document.getElementById("shiftNumber");e&&t?(initializeProductionFlowOnChange(),loadProductionFlowData()):setTimeout(function(){initializeProductionFlow()},100)}function setSummaryWorkCurrentDate(){var e=new Date,t=e.getFullYear(),r=e.getMonth()+1,n=e.getDate(),a=t+"-"+(r<10?"0"+r:r.toString())+"-"+(n<10?"0"+n:n.toString()),o=document.getElementById("summaryWorkJournalDate");o&&!o.value&&(o.value=a)}function initializeSummaryWorkDataLoading(){for(var e=["summaryWorkJournalDate","summaryWorkShiftNumber"],t=0;t<e.length;t++){var r=document.getElementById(e[t]);r&&function(e){var t=function(){loadSummaryWorkProductionFlowData()};e.addEventListener?e.addEventListener("change",t,!1):e.attachEvent&&e.attachEvent("onchange",t)}(r)}loadSummaryWorkProductionFlowData()}function loadSummaryWorkProductionFlowData(){if(window.currentUserData&&"Moderator"===window.currentUserData.role)try{var e=document.getElementById("summaryWorkJournalDate").value;if(!e)return void clearSummaryWorkTables();var t=GetProductionFlowData(e);if(!t||""===t)return void clearSummaryWorkTables();var r,n=xorDecrypt(t,window.currentUserData.xorkey),a=n.indexOf("|");if(-1!==a){var o=parseInt(n.substring(0,a));r=n.substring(a+1,a+1+o)}else r=n.trim().replace(/\0/g,"").replace(/[\x00-\x1F\x7F]/g,"");renderSummaryWorkTables(JSON.parse(r))}catch(i){console.log("Помилка завантаження зведених даних: "+i.message),clearSummaryWorkTables()}}function clearSummaryWorkTables(){var e=document.getElementById("summaryWorkTablesContainer"),t=document.querySelector("#summaryWorkspace .journal-footer");e&&(e.innerHTML="<p>Дані відсутні для вибраної дати та зміни</p>"),t&&(t.style.display="none")}function renderSummaryWorkTables(e){var t=document.getElementById("summaryWorkTablesContainer"),r=document.getElementById("summaryWorkShiftNumber").value||"1",n=document.querySelector("#summaryWorkspace .journal-footer");t.innerHTML="";for(var a=!1,o=["I драна","В/С","1/С","Висівки","Подача","I Замочка"],i=0;i<o.length;i++){var s=o[i];if(e[s]&&e[s][r]){var l=e[s][r],u=[];for(var d in l)"brigade"===d||isNaN(parseInt(d))||u.push(parseInt(d));if(u.length>0){if(a=!0,u.sort(function(e,t){return e-t}),l.brigade){var c=document.getElementById("summaryWorkBrigadeInfo");c&&(c.value=l.brigade)}var m=createSummaryWorkTableForProduct(s,l,u);t.innerHTML+=m}}}a?(n&&(n.style.display="block"),initializeSummaryMoistureCalculation(),initializeAverageCalculations()):clearSummaryWorkTables()}function createSummaryWorkTableForProduct(e,t,r){var n=getProductPrefixByName(e),a=getProductColumnConfig(e),o='<div class="product-summary-table" style="margin-bottom: 24px;">';o+='<h3 style="margin-bottom: 16px; color: #334155;">'+e+"</h3>",o+='<table class="journal-table summary-table">',o+="<thead><tr>",o+='<th rowspan="2" class="col-table col-product">Відбір</th>',a.bunker&&(o+='<th rowspan="2" class="col-table col-bunker">Бункер/<br/>Силос/<br/>Яма</th>'),a.moisture&&(o+='<th colspan="4">Воло&shy;гість</th>'),a.whiteness&&(o+='<th rowspan="2" class="col-table col-whiteness">Білість,<br/>од.</th>'),a.gluten&&(o+='<th colspan="'+(a.falling_number?3:2)+'">Сира клейко&shy;вина</th>'),a.residue&&(o+='<th rowspan="2" class="col-table col-residue">Зали&shy;шок на ситі *, %</th>'),a.passage&&(o+='<th rowspan="2" class="col-table col-passage">Прохо&shy;дження<br/>через сито **, %</th>'),a.metal&&(o+='<th rowspan="2" class="col-table col-metal">Метало&shy;доміш&shy;ки,<br/>мг</th>'),a.color&&(o+='<th rowspan="2" class="col-table col-color">Колір, запах,<br/>смак</th>'),a.crunch&&(o+='<th rowspan="2" class="col-table col-crust">Хруст&shy;кість</th>'),a.infection&&(o+='<th rowspan="2" class="col-table col-infection">Зараже&shy;ність<br/>шкідни&shy;ками</th>'),o+="</tr><tr>",a.moisture&&(o+='<th class="col-table col-sample">№ бюкси</th>',o+='<th class="col-table col-mass">Маса бюкси з<br/>наваж&shy;кою 500г, мг</th>',o+='<th class="col-table col-moisture">Маса бюкси з<br/>наваж&shy;кою після<br/>сушиль&shy;ної шафи, мг</th>',o+='<th class="col-table col-avg-moisture">Середня<br/>воло&shy;гість, %</th>'),a.gluten&&(o+='<th class="col-table col-quantity">Кіль&shy;кість, %</th>',o+='<th class="col-table col-bdk">БДК, од.</th>',a.falling_number&&(o+='<th class="col-table col-falling-number">ЧП,с</th>')),o+="</tr></thead>",o+="<tbody>";for(var i=0;i<r.length;i++){var s=r[i],l=t[s]||{};o+='<tr class="product-group-'+getProductGroupClass(e)+' product-row">';var u=a.moisture?' rowspan="2"':"";o+="<td"+u+' class="product-name" style="text-align: center; font-weight: bold;">'+s+"</td>",a.bunker&&(o+="<td"+u+">"+createSummarySelectField(n+"_bunker_"+s,l[n+"_bunker"]||"",getBunkerOptions(e))+"</td>"),a.moisture&&(o+="<td>"+createSummarySelectField(n+"_sample1_"+s,l[n+"_sample1"]||"",getSampleOptions())+"</td>",o+="<td>"+createSummaryInputField(n+"_mass1_"+s,l[n+"_mass1"]||"","number")+"</td>",o+="<td>"+createSummaryInputField(n+"_dried1_"+s,l[n+"_dried1"]||"","number")+"</td>",o+="<td"+u+' style="text-align: center; font-weight: bold;"><span class="table-text number" id="summary_'+n+"_moisture_"+s+'"></span></td>'),a.whiteness&&(o+="<td"+u+">"+createSummaryInputField(n+"_whiteness_"+s,l[n+"_whiteness"]||"","number")+"</td>"),a.gluten&&(o+="<td"+u+">"+createSummaryInputField(n+"_gluten_quantity_"+s,l[n+"_gluten_quantity"]||"","number","0.1")+"</td>",o+="<td"+u+">"+createSummaryInputField(n+"_gluten_bdk_"+s,l[n+"_gluten_bdk"]||"","number")+"</td>"),a.falling_number&&(o+="<td"+u+">"+createSummaryInputField(n+"_falling_number_"+s,l[n+"_falling_number"]||"","number")+"</td>"),a.residue&&(o+="<td"+u+">"+createSummaryInputField(n+"_residue_"+s,l[n+"_residue"]||"","number","0.1")+"</td>"),a.passage&&(o+="<td"+u+">"+createSummaryInputField(n+"_passage_"+s,l[n+"_passage"]||"","number","0.1")+"</td>"),a.metal&&(o+="<td"+u+">"+createSummaryInputField(n+"_metal_"+s,l[n+"_metal"]||"","text")+"</td>"),a.color&&(o+="<td"+u+">"+createSummaryInputField(n+"_color_"+s,l[n+"_color"]||"","text")+"</td>"),a.crunch&&(o+="<td"+u+">"+createSummaryInputField(n+"_crunch_"+s,l[n+"_crunch"]||"","text")+"</td>"),a.infection&&(o+="<td"+u+">"+createSummaryInputField(n+"_infection_"+s,l[n+"_infection"]||"","text")+"</td>"),o+="</tr>",a.moisture&&(o+='<tr class="product-group-'+getProductGroupClass(e)+' product-row">',o+="<td>"+createSummarySelectField(n+"_sample2_"+s,l[n+"_sample2"]||"",getSampleOptions())+"</td>",o+="<td>"+createSummaryInputField(n+"_mass2_"+s,l[n+"_mass2"]||"","number")+"</td>",o+="<td>"+createSummaryInputField(n+"_dried2_"+s,l[n+"_dried2"]||"","number")+"</td>",o+="</tr>")}return o+="</tbody>",o+="<tfoot><tr>",o+='<td colspan="'+(1+(a.bunker?1:0)+(a.moisture?3:0))+'" class="footer-title">Середньозмінне значення:</td>',a.moisture&&(o+='<td class="footer-value"><span class="table-text number" id="summary_'+n+'_avg_moisture"></span></td>'),a.whiteness&&(o+='<td class="footer-value"><span class="table-text number" id="summary_'+n+'_avg_whiteness"></span></td>'),a.gluten&&(o+='<td class="footer-value"><span class="table-text number" id="summary_'+n+'_avg_gluten_quantity"></span></td>',o+='<td class="footer-value"><span class="table-text number" id="summary_'+n+'_avg_gluten_bdk"></span></td>'),a.falling_number&&(o+='<td class="footer-value"><span class="table-text number" id="summary_'+n+'_avg_falling_number"></span></td>'),a.residue&&(o+='<td class="footer-value"><span class="table-text number" id="summary_'+n+'_avg_residue"></span></td>'),a.passage&&(o+='<td class="footer-value"><span class="table-text number" id="summary_'+n+'_avg_passage"></span></td>'),a.metal&&(o+='<td class="footer-value"></td>'),a.color&&(o+='<td class="footer-value"></td>'),a.crunch&&(o+='<td class="footer-value"></td>'),a.infection&&(o+='<td class="footer-value"></td>'),(o+="</tr></tfoot>")+"</table></div>"}function calculateAndDisplayShiftAverages(e){var t=getProductPrefixByName(e),r={moisture:"_moisture_",whiteness:"_whiteness_",gluten_quantity:"_gluten_quantity_",gluten_bdk:"_gluten_bdk_",falling_number:"_falling_number_",residue:"_residue_",passage:"_passage_"};for(var n in r){for(var a=0,o=0,i='[id^="summary_'+t+r[n]+'"]',s=document.querySelectorAll(i),l=0;l<s.length;l++){var u;u="span"===s[l].tagName.toLowerCase()?s[l].textContent||s[l].innerText:s[l].value;var d=parseFloat(u);isNaN(d)||(a+=d,o++)}var c=o>0?(a/o).toFixed(1):"",m=document.getElementById("summary_"+t+"_avg_"+n);m&&(m.textContent=c)}}function initializeAverageCalculations(){setTimeout(function(){for(var e=["I драна","В/С","1/С","Висівки","Подача","I Замочка"],t=["_whiteness_","_gluten_quantity_","_gluten_bdk_","_falling_number_","_residue_","_passage_"],r=0;r<e.length;r++){var n=e[r],a=getProductPrefixByName(n);calculateAndDisplayShiftAverages(n);for(var o=0;o<t.length;o++)for(var i='input[id^="summary_'+a+t[o]+'"]',s=document.querySelectorAll(i),l=0;l<s.length;l++)(function(e){var t=function(){calculateAndDisplayShiftAverages(e)};s[l].addEventListener?(s[l].addEventListener("input",t,!1),s[l].addEventListener("change",t,!1)):s[l].attachEvent&&(s[l].attachEvent("oninput",t),s[l].attachEvent("onchange",t))})(n)}},250)}function createSummaryInputField(e,t,r,n){return'<input type="'+r+'" class="table-input '+r+'" id="summary_'+e+'" value="'+t+'"'+(n?' step="'+n+'"':"")+" />"}function calculateSummaryMoisture(e,t){return calculateMoisture("summary_"+e,t)}function initializeSummaryMoistureCalculation(){setTimeout(function(){for(var e=["drama","vs","first","bran","feed","soak"],t={drama:"I драна",vs:"В/С",first:"1/С",bran:"Висівки",feed:"Подача",soak:"I Замочка"},r=0;r<e.length;r++)for(var n=e[r],a=t[n],o=1;o<=6;o++){calculateSummaryMoisture(n,o);for(var i=["_mass1_","_dried1_","_mass2_","_dried2_"],s=0;s<i.length;s++){var l="summary_"+n+i[s]+o,u=document.getElementById(l);u&&function(e,t,r){var n=function(){calculateSummaryMoisture(e,t),calculateAndDisplayShiftAverages(r)};u.addEventListener?(u.addEventListener("input",n,!1),u.addEventListener("change",n,!1)):u.attachEvent&&(u.attachEvent("oninput",n),u.attachEvent("onchange",n))}(n,o,a)}}},200)}function createSummarySelectField(e,t,r){var n='<select class="table-select" id="summary_'+e+'">';n+='<option value=""></option>';for(var a=0;a<r.length;a++){var o=t===r[a]?" selected":"";n+='<option value="'+r[a]+'"'+o+">"+r[a]+"</option>"}return n+"</select>"}function getProductColumnConfig(e){return{"I драна":{moisture:!0,bunker:!1,whiteness:!1,gluten:!1,falling_number:!1,residue:!1,passage:!1,metal:!1,color:!1,crunch:!1,infection:!1},"В/С":{moisture:!0,bunker:!0,whiteness:!0,gluten:!0,falling_number:!0,residue:!0,passage:!1,metal:!0,color:!0,crunch:!0,infection:!1},"1/С":{moisture:!0,bunker:!0,whiteness:!0,gluten:!0,falling_number:!0,residue:!0,passage:!0,metal:!0,color:!0,crunch:!0,infection:!1},"Висівки":{moisture:!0,bunker:!0,whiteness:!1,gluten:!1,falling_number:!1,residue:!1,passage:!0,metal:!0,color:!0,crunch:!1,infection:!1},"Подача":{moisture:!0,bunker:!0,whiteness:!1,gluten:!0,falling_number:!0,residue:!1,passage:!1,metal:!1,color:!0,crunch:!1,infection:!0},"I Замочка":{moisture:!0,bunker:!0,whiteness:!1,gluten:!1,falling_number:!1,residue:!1,passage:!1,metal:!1,color:!1,crunch:!1,infection:!1}}[e]||{}}function getProductGroupClass(e){return{"I драна":"1","В/С":"2","1/С":"3","Висівки":"2","Подача":"3","I Замочка":"2"}[e]||"1"}function getBunkerOptions(e){return{"В/С":["1","2","3","4","5","6","7","8","9","10"],"1/С":["1","2","3","4","5","6","7","8","9","10"],"Висівки":["11","12","13","14"],"Подача":["1","2","3"],"I Замочка":["1","2","3","4","5","6","1а","2а","3а","4а","5а","6а"]}[e]||[]}function getSampleOptions(){return["1","4a","10a","18a","1a","2a","8","9","21","22","5","6"]}function verifySummaryWorkData(){if(window.currentUserData&&"Moderator"===window.currentUserData.role)try{var e=document.getElementById("summaryWorkJournalDate").value;if(!e)return void alert("Будь ласка, вкажіть дату аналізу!");var t=collectSummaryWorkData();if(!t)return void alert("Немає даних для підтвердження!");var r=window.currentUserData.xorkey.substring(0,8),n=JSON.stringify(t),a=n.length+"|"+n,o=document.getElementById("summaryWorkShiftNumber").value||"1",i=xorEncrypt(a,r);SaveVerifiedProductionFlowData(e,i,(new Date).toISOString(),window.currentUserData.id,o),alert("Дані успішно підтверджено та збережено!")}catch(s){console.log("Помилка підтвердження даних: "+s.message),alert("Помилка підтвердження: "+s.message)}else alert("Недостатньо прав доступу!")}function collectSummaryWorkData(){try{for(var e={},t=document.getElementById("summaryWorkShiftNumber").value||"1",r=document.getElementById("summaryWorkBrigadeInfo").value||"",n=["I драна","В/С","1/С","Висівки","Подача","I Замочка"],a=0;a<n.length;a++){var o=n[a],i=getProductPrefixByName(o),s=!1,l=document.querySelectorAll('input[id^="summary_'+i+'_"],select[id^="summary_'+i+'_"],span[id^="summary_'+i+'_moisture_"]');if(0!==l.length){for(var u={},d=0;d<l.length;d++){var c=l[d],m="";if((m="span"===c.tagName.toLowerCase()?c.textContent||c.innerText:c.value)&&""!==m.trim()){var g=c.id.split("_");if(g.length>=4){var f=g[g.length-1],p=c.id.replace("summary_","").replace("_"+f,"");u[f]||(u[f]={}),u[f][p]=m.trim(),s=!0}}}if(s){for(var f in e[o]||(e[o]={}),e[o][t]||(e[o][t]={}),u)e[o][t][f]=u[f];r&&(e[o][t].brigade=r)}}}return Object.keys(e).length>0?e:null}catch(y){return console.log("Помилка збору зведених даних: "+y.message),null}}function loadSummaryWorkSettings(){if(window.currentUserData&&"Moderator"===window.currentUserData.role)try{if(void 0!==currentUserSettings&&currentUserSettings.general){var e=currentUserSettings.general.shiftNumber;if(e){var t=document.getElementById("summaryWorkShiftNumber");t&&(t.value=e)}var r=currentUserSettings.general.brigadeInfo;if(r){var n=document.getElementById("summaryWorkBrigadeInfo");n&&!n.value&&(n.value=r)}}}catch(a){console.log("Помилка завантаження налаштувань зведеного журналу: "+a.message)}}function saveSummaryWorkSettings(){if(window.currentUserData&&"Moderator"===window.currentUserData.role)try{if(void 0!==currentUserSettings){currentUserSettings.general||(currentUserSettings.general={});var e=document.getElementById("summaryWorkShiftNumber").value,t=document.getElementById("summaryWorkBrigadeInfo").value;e&&(currentUserSettings.general.shiftNumber=e),t&&(currentUserSettings.general.brigadeInfo=t),"function"==typeof saveCurrentSettings&&saveCurrentSettings()}}catch(r){console.log("Помилка збереження налаштувань зведеного журналу: "+r.message)}}function handleSummaryWorkSettingsChange(){window.currentUserData&&"Moderator"===window.currentUserData.role&&setTimeout(function(){saveSummaryWorkSettings()},1e3)}function initializeSummaryWorkSettingsEventListeners(){if(window.currentUserData&&"Moderator"===window.currentUserData.role)for(var e=["summaryWorkShiftNumber","summaryWorkBrigadeInfo"],t=0;t<e.length;t++){var r=document.getElementById(e[t]);r&&(r.addEventListener?r.addEventListener("change",handleSummaryWorkSettingsChange,!1):r.attachEvent&&r.attachEvent("onchange",handleSummaryWorkSettingsChange))}}function initializeSummaryWorkJournal(){setSummaryWorkCurrentDate(),setTimeout(function(){if(initializeDatePicker(),attachDatePicker("summaryWorkJournalDate"),initializeSummaryWorkDataLoading(),initializeSummaryWorkSettingsEventListeners(),void 0!==DatePicker&&DatePicker.selectDate){var e=DatePicker.selectDate;DatePicker.selectDate=function(t){e.apply(this,arguments),setTimeout(function(){loadSummaryWorkProductionFlowData()},100)}}},100)}window.saveProductionFlowData=saveProductionFlowData,window.loadProductionFlowData=loadProductionFlowData,window.saveJournalDataWithProductionFlow=saveJournalDataWithProductionFlow,window.initializeProductionFlow=initializeProductionFlow;var userMap={};function initializeMoistureJournal(){loadUserListForJournal(),setMoistureJournalCurrentDate(),initializeMoistureJournalEventListeners(),setTimeout(function(){if(initializeDatePicker(),attachDatePicker("moistureJournalDate"),void 0!==DatePicker&&DatePicker.selectDate){var e=DatePicker.selectDate;DatePicker.selectDate=function(t){e.apply(this,arguments),setTimeout(function(){loadMoistureJournalData()},150)}}loadMoistureJournalData()},150)}function setMoistureJournalCurrentDate(){var e=new Date,t=e.getFullYear(),r=e.getMonth()+1,n=e.getDate(),a=t+"-"+(r<10?"0"+r:r)+"-"+(n<10?"0":"")+n,o=document.getElementById("moistureJournalDate");o&&!o.value&&(o.value=a)}function loadUserListForJournal(){var e=getAllUsers();if(e)for(var t=e.split("|"),r=0;r<t.length;r++){var n=t[r].split(",");n.length>=2&&(userMap[n[0]]=n[1])}}function initializeMoistureJournalEventListeners(){var e=document.getElementById("moistureJournalShiftNumber");if(e){var t=function(){loadMoistureJournalData()};e.addEventListener?e.addEventListener("change",t,!1):e.attachEvent&&e.attachEvent("onchange",t)}}function loadMoistureJournalData(){if(window.currentUserData&&window.currentUserData.xorkey)try{var e=document.getElementById("moistureJournalDate").value;if(!e)return void renderMoistureJournalTables(null,null);var t=document.getElementById("moistureJournalShiftNumber").value||"1",r=GetVerifiedProductionFlowData(e,t);if(!r||-1===r.indexOf("|||"))return void renderMoistureJournalTables(null,null);var n=r.split("|||"),a=n[0],o=n[1];if(!a)return void renderMoistureJournalTables(null,null);var i,s=xorDecrypt(a,window.currentUserData.xorkey.substring(0,8)),l=s.indexOf("|");if(-1!==l){var u=parseInt(s.substring(0,l));i=s.substring(l+1,l+1+u)}else i=s.trim().replace(/\0/g,"").replace(/[\x00-\x1F\x7F]/g,"");renderMoistureJournalTables(JSON.parse(i),o)}catch(d){console.log("Помилка завантаження даних журналу вологості: "+d.message),renderMoistureJournalTables(null,null)}}function getProductGroupClass(e){return{"I драна":"1","В/С":"2","1/С":"3","Висівки":"2","Подача":"3","I Замочка":"2"}[e]||"1"}function renderMoistureJournalTables(e,t){var r=document.getElementById("moistureJournalTablesContainer"),n=document.querySelector(".journal-info-bar"),a=document.querySelector("#moistureJournal .journal-footer"),o=document.getElementById("moistureJournalShiftNumber").value||"1",i=!1,s="";if(e)for(var l=["I драна","В/С","1/С","Висівки","Подача","I Замочка"],u=0;u<l.length;u++){var d=l[u];if(e[d]&&e[d][o]){var c=e[d][o],m=Object.keys(c).filter(function(e){return!isNaN(parseInt(e))});m.length>0&&(i=!0,m.sort(function(e,t){return parseInt(e)-parseInt(t)}),s+=createMoistureTableForProduct(d,c,m))}}if(i){var g;n&&(n.style.display="flex"),a&&(a.style.display="block"),r.innerHTML=s,document.getElementById("moistureJournalLabTechnicianInfo").textContent=userMap[t]||t||"-";for(var f=0;f<l.length;f++)if(e[l[f]]&&e[l[f]][o]){g=l[f];break}document.getElementById("moistureJournalBrigadeInfo").textContent=g&&e[g][o].brigade||"-"}else n&&(n.style.display="none"),a&&(a.style.display="none"),r.innerHTML="<p>Дані відсутні для вибраної дати та зміни.</p>"}function createMoistureTableForProduct(e,t,r){var n=getProductPrefixByName(e),a=0,o=0,i='<div class="product-summary-table"><h3>'+e+"</h3>";i+='<table class="journal-table summary-table moisture-table">',i+='<thead><tr><th rowspan="2">Відбір</th><th>№ бюкси</th><th>Маса порож. бюкси, мг</th><th>Маса бюкси з наваж&shy;кою, мг</th><th>Маса бюкси після сушки, мг</th><th>Різниця маси, мг</th><th>Воло&shy;гість, %</th><th rowspan="2">Середня воло&shy;гість, %</th></tr></thead><tbody>';for(var s=0;s<r.length;s++){var l=r[s],u=t[l]||{},d='class="product-group-'+getProductGroupClass(e)+'"',c=parseFloat(u[n+"_mass1"])||0,m=parseFloat(u[n+"_dried1"])||0,g=parseFloat(u[n+"_mass2"])||0,f=parseFloat(u[n+"_dried2"])||0,p=c>0?c-500:"-",y=c>0&&m>0?c-m:"-",h="-"!==y?(y/5).toFixed(1):"-",v=g>0?g-500:"-",w=g>0&&f>0?g-f:"-",_="-"!==w?(w/5).toFixed(1):"-",b=parseFloat(u[n+"_moisture"])||0;b>0&&(a+=b,o++),i+="<tr "+d+'><td rowspan="2"><span>'+l+"</span></td><td><span>"+(u[n+"_sample1"]||"-")+"</span></td><td><span>"+p+"</span></td><td><span>"+(c||"-")+"</span></td><td><span>"+(m||"-")+"</span></td><td><span>"+y+"</span></td><td><span>"+h+'</span></td><td rowspan="2"><span>'+(b>0?b.toFixed(1):"-")+"</span></td></tr>",i+="<tr "+d+"><td><span>"+(u[n+"_sample2"]||"-")+"</span></td><td><span>"+v+"</span></td><td><span>"+(g||"-")+"</span></td><td><span>"+(f||"-")+"</span></td><td><span>"+w+"</span></td><td><span>"+_+"</span></td></tr>"}return(i+='</tbody><tfoot><tr><td colspan="7" class="footer-title">Середньозмінне значення:</td><td class="footer-value"><span>'+(o>0?(a/o).toFixed(1):"-")+"</span></td></tr></tfoot>")+"</table></div>"}var userMap={};function initializeQualityControlJournal(){loadUserListForJournal(),setQualityControlJournalCurrentDate(),initializeQualityControlEventListeners(),setTimeout(function(){if(initializeDatePicker(),attachDatePicker("qualityControlJournalDate"),void 0!==DatePicker&&DatePicker.selectDate){var e=DatePicker.selectDate;DatePicker.selectDate=function(t){e.apply(this,arguments),setTimeout(function(){loadQualityControlData()},150)}}loadQualityControlData()},150)}function loadUserListForJournal(){var e=getAllUsers();if(e)for(var t=e.split("|"),r=0;r<t.length;r++){var n=t[r].split(",");n.length>=2&&(userMap[n[0]]=n[1])}}function setQualityControlJournalCurrentDate(){var e=new Date,t=e.getFullYear()+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+("0"+e.getDate()).slice(-2),r=document.getElementById("qualityControlJournalDate");r&&!r.value&&(r.value=t)}function initializeQualityControlEventListeners(){for(var e=["qualityControlJournalDate","qualityControlShiftNumber"],t=0;t<e.length;t++){var r=document.getElementById(e[t]);if(r){var n=function(){loadQualityControlData()};r.addEventListener?r.addEventListener("change",n,!1):r.attachEvent&&r.attachEvent("onchange",n)}}}function loadQualityControlData(){if(window.currentUserData&&window.currentUserData.xorkey)try{var e=document.getElementById("qualityControlJournalDate").value,t=document.getElementById("qualityControlShiftNumber").value;if(!e)return void renderQualityControlTables(null,t,null);t=document.getElementById("qualityControlShiftNumber").value;var r=GetVerifiedProductionFlowData(e,t);if(!r||-1===r.indexOf("|||"))return void renderQualityControlTables(null,t,null);var n=r.split("|||"),a=n[0],o=n[1];if(!a)return void renderQualityControlTables(null,t,null);var i,s=xorDecrypt(a,window.currentUserData.xorkey.substring(0,8)),l=s.indexOf("|");if(-1!==l){var u=parseInt(s.substring(0,l));i=s.substring(l+1,l+1+u)}else i=s.trim().replace(/\0/g,"").replace(/[\x00-\x1F\x7F]/g,"");renderQualityControlTables(JSON.parse(i),t,o)}catch(d){console.log("Помилка завантаження даних для ОКЖ: "+d.message),renderQualityControlTables(null,null,null)}}function calculateAverage(e,t){t=t===undefined?1:t;var r=e.filter(function(e){return null!==e&&e!==undefined&&""!==e&&!isNaN(parseFloat(e))});return 0===r.length?"-":(r.reduce(function(e,t){return e+parseFloat(t)},0)/r.length).toFixed(t)}function populateCell(e,t){var r=document.getElementById(e);r&&(r.innerHTML=t)}function renderQualityControlTables(e,t,r){for(var n=document.querySelectorAll("#qualityControlTablesContainer .qc-section"),a=document.getElementById("qc-no-data-message"),o=document.querySelector("#qualityControlJournal .journal-info-bar"),i=document.querySelectorAll(".qc-table tbody td[id]"),s=0;s<i.length;s++)i[s].innerHTML="-";if(!e){for(s=0;s<n.length;s++)n[s].style.display="none";return a.style.display="block",void(o&&(o.style.display="none"))}for(s=0;s<n.length;s++)n[s].style.display="block";a.style.display="none",o&&(o.style.display="flex");var l={moisture:{key:"_moisture",precision:1},gluten_quantity:{key:"_gluten_quantity",precision:1},gluten_bdk:{key:"_gluten_bdk",precision:0},falling_number:{key:"_falling_number",precision:0},whiteness:{key:"_whiteness",precision:0},residue:{key:"_residue",precision:1},passage:{key:"_passage",precision:1},infection:{key:"_infection",isAvg:!1,"default":"н/в"},color:{key:"_color",isAvg:!1,"default":"вл"},crunch:{key:"_crunch",isAvg:!1,"default":"н/в"},metal:{key:"_metal",isAvg:!1,"default":"сл"}},u={feed:{prefix:"feed",tableId:"qc_grain_feed"},drama:{prefix:"drama",tableId:"qc_grain_drana"},vs:{prefix:"vs",tableId:"qc_prod_vs"},first:{prefix:"first",tableId:"qc_prod_first"},bran:{prefix:"bran",tableId:"qc_prod_bran"}},d={},c="-",m=!1;for(var g in u){var f=u[g];d[g]={};var p=e[getProductFullName(g)];if(p&&p[t])for(var y in m=!0,p[t].brigade&&(c=p[t].brigade),l){for(var h=l[y],v=[],w=1;w<=6;w++)if(p[t][w]){var _=p[t][w][f.prefix+h.key];v.push(_)}var b;b=!1===h.isAvg?v.find(function(e){return e!==undefined&&""!==e})||h["default"]||"-":calculateAverage(v,h.precision);var D=v.map(function(e){return null===e||e===undefined||""===e||isNaN(parseFloat(e))||h.precision===undefined?e:parseFloat(e).toFixed(h.precision)});d[g][y]={prelim:D.filter(function(e){return e!==undefined&&""!==e}).join("<br>"),avg:b}}}if(m){for(var S in document.getElementById("qualityControlBrigadeInfo").textContent=c,document.getElementById("qualityControlLabTechnicianInfo").textContent=userMap[r]||r||"-",d)for(var k in d[S])populateCell(u[S].tableId+"_"+k+"_prelim",d[S][k]&&d[S][k].prelim||"-"),populateCell(u[S].tableId+"_"+k+"_avg",d[S][k]?d[S][k].avg:"-");var E=["gluten_quantity","gluten_bdk","falling_number","infection","color"];for(s=0;s<E.length;s++){h=E[s];var I=d.feed&&d.feed[h]?d.feed[h].avg:"-";populateCell("qc_grain_drana_"+h+"_avg",I)}}else renderQualityControlTables(null,t,null)}function getProductFullName(e){return{feed:"Подача",drama:"I драна",vs:"В/С",first:"1/С",bran:"Висівки",soak:"I Замочка"}[e]}var currentDisplayDate=new Date;function initializeConsolidatedJournal(){currentDisplayDate=new Date,loadAndRenderConsolidatedData()}function changeMonth(e){currentDisplayDate.setMonth(currentDisplayDate.getMonth()+e),loadAndRenderConsolidatedData()}function calculateShiftAverage(e,t,r){var n=[];if(!e)return"-";for(var a=1;a<=6;a++)e[a]&&e[a][t]&&n.push(e[a][t]);return 0===n.length?"-":(n.reduce(function(e,t){return e+parseFloat(t||0)},0)/n.length).toFixed(r)}function loadAndRenderConsolidatedData(){var e=document.getElementById("consolidated-journal-body"),t=document.getElementById("consolidated-table"),r=document.getElementById("consolidated-no-data");document.getElementById("currentMonthDisplay").textContent=["Січень","Лютий","Березень","Квітень","Травень","Червень","Липень","Серпень","Вересень","Жовтень","Листопад","Грудень"][currentDisplayDate.getMonth()]+" "+currentDisplayDate.getFullYear(),e.innerHTML='<tr><td colspan="18">Завантаження даних...</td></tr>';try{var n=GetAllVerifiedProductionFlowData();if(!n)return t.style.display="none",r.style.display="block",void(e.innerHTML="");for(var a=window.currentUserData.xorkey.substring(0,8),o=n.split("|||ROW|||"),i=[],s=currentDisplayDate.getFullYear(),l=currentDisplayDate.getMonth(),u=0;u<o.length;u++)(c=o[u].split("|||")).length<2||(g=new Date(c[0])).getFullYear()===s&&g.getMonth()===l&&i.push(o[u]);if(0===i.length)return t.style.display="none",r.style.display="block",void(e.innerHTML="");t.style.display="table",r.style.display="none",i.sort(function(e,t){return new Date(e.split("|||")[0])-new Date(t.split("|||")[0])});var d="";for(u=0;u<i.length;u++){var c,m,g=(c=i[u].split("|||"))[0],f=xorDecrypt(c[1],a),p=f.indexOf("|");if(-1!==p){var y=parseInt(f.substring(0,p));m=f.substring(p+1,p+1+y)}else m=f.trim().replace(/\0/g,"").replace(/[\x00-\x1F\x7F]/g,"");for(var h=JSON.parse(m),v=1;v<=2;v++){var w=v.toString(),_=Object.keys(h).some(function(e){return h[e]&&h[e][w]});if(_){var b="-";for(var D in h)if(h[D][w]&&h[D][w].brigade){b=h[D][w].brigade;break}var S=function(e,t,r){var n=h[e];if(n&&n[w])for(var a=1;a<=6;a++)if(n[w][a]&&n[w][a][t])return n[w][a][t];return r},k={date:new Date(g).toLocaleDateString("uk-UA"),brigade:b,drana_moisture:calculateShiftAverage(h["I драна"]?h["I драна"][w]:null,"drama_moisture",1),vs_moisture:calculateShiftAverage(h["В/С"]?h["В/С"][w]:null,"vs_moisture",1),vs_whiteness:calculateShiftAverage(h["В/С"]?h["В/С"][w]:null,"vs_whiteness",0),vs_metal:S("В/С","vs_metal","сл"),vs_residue:calculateShiftAverage(h["В/С"]?h["В/С"][w]:null,"vs_residue",1),vs_gluten:calculateShiftAverage(h["В/С"]?h["В/С"][w]:null,"vs_gluten_quantity",1),vs_bdk:calculateShiftAverage(h["В/С"]?h["В/С"][w]:null,"vs_gluten_bdk",0),first_moisture:calculateShiftAverage(h["1/С"]?h["1/С"][w]:null,"first_moisture",1),first_whiteness:calculateShiftAverage(h["1/С"]?h["1/С"][w]:null,"first_whiteness",0),first_metal:S("1/С","first_metal","сл"),first_residue:calculateShiftAverage(h["1/С"]?h["1/С"][w]:null,"first_residue",1),first_passage:calculateShiftAverage(h["1/С"]?h["1/С"][w]:null,"first_passage",1),first_gluten:calculateShiftAverage(h["1/С"]?h["1/С"][w]:null,"first_gluten_quantity",1),first_bdk:calculateShiftAverage(h["1/С"]?h["1/С"][w]:null,"first_bdk",0),bran_moisture:calculateShiftAverage(h["Висівки"]?h["Висівки"][w]:null,"bran_moisture",1),bran_metal:S("Висівки","bran_metal","сл")};d+="<tr><td>"+k.date+" (зм. "+w+")</td><td>"+k.brigade+"</td><td>"+k.drana_moisture+"</td><td>"+k.vs_moisture+"</td><td>"+k.vs_whiteness+"</td><td>"+k.vs_metal+"</td><td>"+k.vs_residue+"</td><td>"+k.vs_gluten+"</td><td>"+k.vs_bdk+"</td><td>"+k.first_moisture+"</td><td>"+k.first_whiteness+"</td><td>"+k.first_metal+"</td><td>"+k.first_residue+"</td><td>"+k.first_passage+"</td><td>"+k.first_gluten+"</td><td>"+k.first_bdk+"</td><td>"+k.bran_moisture+"</td><td>"+k.bran_metal+"</td></tr>"}}}e.innerHTML=d}catch(E){console.log("Помилка при обробці зведених даних: "+E.message),t.style.display="none",r.style.display="block",r.textContent="Помилка завантаження даних.",e.innerHTML=""}}function normalizeContent(e){return e.replace(/\s*data-integrity="[^"]*"/g,"").replace(/<!--[\s\S]*?-->/g,"").replace(/<script[^>]*>\s*verifyIntegrity\(\)\s*<\/script>/gi,"").replace(/\r\n/g,"\n").replace(/\r/g,"\n").replace(/>\s+</g,"><").replace(/\s{2,}/g," ").replace(/^\s+|\s+$/gm,"").replace(/\n\s*\n/g,"\n")}function generateIntegrityHash(e){return crypto_sha256(normalizeContent(e).toLowerCase())}function verifyIntegrity(){try{var e=document.documentElement.getAttribute("data-integrity"),t=generateIntegrityHash(ReadHTAFile());return!(!e||t!==e)||(alert("УВАГА: Файл було змінено!\nПрограма буде закрита з міркувань безпеки. "+t),window.close(),!1)}catch(r){return alert("Критична помилка перевірки цілісності: "+r.message),window.close(),!1}} 
</script>

<script language="VBScript">
Function GetTSVPath()
Dim fso,path,dbFolder
Set fso = CreateObject("Scripting.FileSystemObject")
path = Replace(document.location, "file:///", "")
path = Replace(path, "/", "\")
Dim pos
pos = InStr(path, "?")
If pos > 0 Then path = Left(path, pos - 1)
path = fso.GetParentFolderName(path)
dbFolder = path & "\yavirlabdb"
If Not fso.FolderExists(dbFolder) Then
fso.CreateFolder dbFolder
End If
GetTSVPath = dbFolder
End Function
Function GetUsersFilePath()
GetUsersFilePath = GetTSVPath() & "\users.tsv"
End Function
Function GetSettingsFilePath()
GetSettingsFilePath = GetTSVPath() & "\settings.tsv"
End Function
Function CreateTSVFilesIfNotExists()
Dim fso,usersFile,settingsFile
Set fso = CreateObject("Scripting.FileSystemObject")
CreateTSVFilesIfNotExists = True
On Error Resume Next
usersFile = GetUsersFilePath()
If Not fso.FileExists(usersFile) Then
Dim file
Set file = fso.CreateTextFile(usersFile, True, True)
file.WriteLine "ID" & vbTab & "Username" & vbTab & "PasswordHash" & vbTab & "Salt" & vbTab & "Role" & vbTab & "XORKey" & vbTab & "CreatedDate" & vbTab & "LastLogin"
file.Close
Set file = Nothing
End If
settingsFile = GetSettingsFilePath()
If Not fso.FileExists(settingsFile) Then
Set file = fso.CreateTextFile(settingsFile, True, True)
file.WriteLine "UserID" & vbTab & "SettingsData" & vbTab & "UpdatedDate"
file.Close
Set file = Nothing
End If
If Err.Number <> 0 Then
MsgBox "Помилка створення TSV файлів: " & Err.Description, vbCritical
CreateTSVFilesIfNotExists = False
End If
On Error GoTo 0
End Function
Function CheckIfAdminExists()
Dim fso,usersFile,file, line, fields
CheckIfAdminExists = False
If Not CreateTSVFilesIfNotExists() Then Exit Function
Set fso = CreateObject("Scripting.FileSystemObject")
usersFile = GetUsersFilePath()
On Error Resume Next
If fso.FileExists(usersFile) Then
Set file = fso.OpenTextFile(usersFile, 1, False, -1)
If Not file.AtEndOfStream Then
file.ReadLine
End If
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= 4 Then
If Trim(fields(4)) = "Administrator" Then
CheckIfAdminExists = True
Exit Do
End If
End If
End If
Loop
file.Close
Set file = Nothing
End If
On Error GoTo 0
End Function
Function getUserDataString(username)
Dim fso,usersFile,file, line, fields
getUserDataString = ""
If Not CreateTSVFilesIfNotExists() Then Exit Function
Set fso = CreateObject("Scripting.FileSystemObject")
usersFile = GetUsersFilePath()
On Error Resume Next
If fso.FileExists(usersFile) Then
Set file = fso.OpenTextFile(usersFile, 1, False, -1)
If Not file.AtEndOfStream Then
file.ReadLine
End If
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= 7 Then
If Trim(fields(1)) = username Then
getUserDataString = Trim(fields(0)) & "," & _
Trim(fields(2)) & "," & _
Trim(fields(3)) & "," & _
Trim(fields(4)) & "," & _
Trim(fields(5))
Exit Do
End If
End If
End If
Loop
file.Close
Set file = Nothing
End If
On Error GoTo 0
End Function
Function userExistsCheck(username)
userExistsCheck = (getUserDataString(username) <> "")
End Function
Function GetNextUserID()
Dim fso,usersFile,file, line, fields, maxID
maxID = 0
Set fso = CreateObject("Scripting.FileSystemObject")
usersFile = GetUsersFilePath()
On Error Resume Next
If fso.FileExists(usersFile) Then
Set file = fso.OpenTextFile(usersFile, 1, False, -1)
If Not file.AtEndOfStream Then
file.ReadLine
End If
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= 0 Then
Dim currentID
currentID = CInt(Trim(fields(0)))
If currentID > maxID Then
maxID = currentID
End If
End If
End If
Loop
file.Close
Set file = Nothing
End If
GetNextUserID = maxID + 1
On Error GoTo 0
End Function
Sub saveUser(username, hash, salt, role, xorkey)
Dim fso,usersFile,file, userID, currentDate
If Not CreateTSVFilesIfNotExists() Then Exit Sub
Set fso = CreateObject("Scripting.FileSystemObject")
usersFile = GetUsersFilePath()
On Error Resume Next
userID = GetNextUserID()
currentDate = Now()
If role = "" Then role = "Guest"
If xorkey = "" Then xorkey = "-"
Set file = fso.OpenTextFile(usersFile, 8, True, -1)
file.WriteLine userID & vbTab & username & vbTab & hash & vbTab & salt & vbTab & role & vbTab & xorkey & vbTab & currentDate & vbTab & "-"
file.Close
Set file = Nothing
If Err.Number <> 0 Then
MsgBox "Помилка створення користувача: " & Err.Description, vbCritical
End If
On Error GoTo 0
End Sub
Sub updateLastLogin(username)
Dim fso,usersFile,tempFile, file, tempFilePath, line, fields, currentDate
If Not CreateTSVFilesIfNotExists() Then Exit Sub
Set fso = CreateObject("Scripting.FileSystemObject")
usersFile = GetUsersFilePath()
tempFilePath = GetTSVPath() & "\users_temp.tsv"
currentDate = Now()
On Error Resume Next
If fso.FileExists(usersFile) Then
Set tempFile = fso.CreateTextFile(tempFilePath, True, True)
Set file = fso.OpenTextFile(usersFile, 1, False, -1)
If Not file.AtEndOfStream Then
tempFile.WriteLine file.ReadLine
End If
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= 7 Then
If Trim(fields(1)) = username Then
fields(7) = currentDate
End If
tempFile.WriteLine Join(fields, vbTab)
End If
End If
Loop
file.Close
tempFile.Close
Set file = Nothing
Set tempFile = Nothing
fso.DeleteFile usersFile
fso.MoveFile tempFilePath, usersFile
End If
On Error GoTo 0
End Sub
Function getAllUsers()
Dim fso,usersFile,file, line, fields, userList
getAllUsers = ""
If Not CreateTSVFilesIfNotExists() Then Exit Function
Set fso = CreateObject("Scripting.FileSystemObject")
usersFile = GetUsersFilePath()
userList = ""
On Error Resume Next
If fso.FileExists(usersFile) Then
Set file = fso.OpenTextFile(usersFile, 1, False, -1)
If Not file.AtEndOfStream Then
file.ReadLine
End If
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= 7 Then
If userList <> "" Then userList = userList & "|"
Dim lastLogin
lastLogin = Trim(fields(7))
If lastLogin = "-" Or lastLogin = "" Then
lastLogin = "Ніколи"
End If
userList = userList & Trim(fields(0)) & "," & _
Trim(fields(1)) & "," & _
Trim(fields(4)) & "," & _
lastLogin
End If
End If
Loop
file.Close
Set file = Nothing
getAllUsers = userList
End If
On Error GoTo 0
End Function
Sub deleteUser(userID)
Dim fso,usersFile,tempFile, file, tempFilePath, line, fields
If Not CreateTSVFilesIfNotExists() Then Exit Sub
If userID = 1 Then Exit Sub ' Не можна видалити адміністратора
Set fso = CreateObject("Scripting.FileSystemObject")
usersFile = GetUsersFilePath()
tempFilePath = GetTSVPath() & "\users_temp.tsv"
On Error Resume Next
If fso.FileExists(usersFile) Then
Set tempFile = fso.CreateTextFile(tempFilePath, True, True)
Set file = fso.OpenTextFile(usersFile, 1, False, -1)
If Not file.AtEndOfStream Then
tempFile.WriteLine file.ReadLine
End If
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= 0 Then
If CInt(Trim(fields(0))) <> CInt(userID) Then
tempFile.WriteLine line
End If
End If
End If
Loop
file.Close
tempFile.Close
Set file = Nothing
Set tempFile = Nothing
fso.DeleteFile usersFile
fso.MoveFile tempFilePath, usersFile
End If
On Error GoTo 0
End Sub
Sub changeUserPassword(username, newHash, newSalt, newEncryptedXORKey)
Dim fso,usersFile,tempFile, file, tempFilePath, line, fields
If Not CreateTSVFilesIfNotExists() Then Exit Sub
Set fso = CreateObject("Scripting.FileSystemObject")
usersFile = GetUsersFilePath()
tempFilePath = GetTSVPath() & "\users_temp.tsv"
On Error Resume Next
If fso.FileExists(usersFile) Then
Set tempFile = fso.CreateTextFile(tempFilePath, True, True)
Set file = fso.OpenTextFile(usersFile, 1, False, -1)
If Not file.AtEndOfStream Then
tempFile.WriteLine file.ReadLine
End If
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= 7 Then
If Trim(fields(1)) = username Then
fields(2) = newHash
fields(3) = newSalt
fields(5) = newEncryptedXORKey ' XOR ключ (позиція 5)
End If
tempFile.WriteLine Join(fields, vbTab)
End If
End If
Loop
file.Close
tempFile.Close
Set file = Nothing
Set tempFile = Nothing
fso.DeleteFile usersFile
fso.MoveFile tempFilePath, usersFile
End If
If Err.Number <> 0 Then
MsgBox "Помилка зміни паролю з XOR: " & Err.Description, vbCritical
End If
On Error GoTo 0
End Sub
Function ReadHTAFile()
Dim fso,file,content, path
Set fso = CreateObject("Scripting.FileSystemObject")
On Error Resume Next
path = Replace(document.location, "file:///", "")
path = Replace(path, "/", "\")
Dim pos
pos = InStr(path, "?")
If pos > 0 Then path = Left(path, pos - 1)
If fso.FileExists(path) Then
Set file = fso.OpenTextFile(path, 1, False, 0)
content = file.ReadAll
file.Close
Set file = Nothing
content = Replace(content, vbCrLf, vbLf)
content = Replace(content, vbCr, vbLf)
ReadHTAFile = content
Else
ReadHTAFile = ""
End If
If Err.Number <> 0 Then
Err.Clear
If fso.FileExists(path) Then
Set file = fso.OpenTextFile(path, 1, False, -1)
content = file.ReadAll
file.Close
Set file = Nothing
content = Replace(content, vbCrLf, vbLf)
content = Replace(content, vbCr, vbLf)
ReadHTAFile = content
Else
ReadHTAFile = ""
End If
End If
Set fso = Nothing
On Error GoTo 0
End Function
Function TestDatabaseConnection()
Dim fso,usersFile,userCount
TestDatabaseConnection = ""
userCount = 0
Set fso = CreateObject("Scripting.FileSystemObject")
usersFile = GetUsersFilePath()
On Error Resume Next
If Not CreateTSVFilesIfNotExists() Then
TestDatabaseConnection = "Помилка створення TSV файлів"
Exit Function
End If
If fso.FileExists(usersFile) Then
Dim file,line
Set file = fso.OpenTextFile(usersFile, 1, False, -1)
If Not file.AtEndOfStream Then
file.ReadLine
End If
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
userCount = userCount + 1
End If
Loop
file.Close
Set file = Nothing
TestDatabaseConnection = "TSV база працює. Користувачів: " & userCount
Else
TestDatabaseConnection = "TSV файли не знайдено"
End If
If Err.Number <> 0 Then
TestDatabaseConnection = "Помилка роботи з TSV: " & Err.Description
End If
On Error GoTo 0
End Function
Function GetUserSettings(userID)
Dim fso,settingsFile,file, line, fields
GetUserSettings = ""
Set fso = CreateObject("Scripting.FileSystemObject")
settingsFile = GetSettingsFilePath()
On Error Resume Next
If fso.FileExists(settingsFile) Then
Set file = fso.OpenTextFile(settingsFile, 1, False, -1)
If Not file.AtEndOfStream Then
file.ReadLine
End If
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= 1 Then
If CInt(Trim(fields(0))) = CInt(userID) Then
GetUserSettings = Trim(fields(1))
Exit Do
End If
End If
End If
Loop
file.Close
Set file = Nothing
End If
On Error GoTo 0
End Function
Sub SaveUserSettings(userID, settingsData)
Dim fso,settingsFile,tempFile, file, tempFilePath, line, fields, currentDate, userFound
Set fso = CreateObject("Scripting.FileSystemObject")
settingsFile = GetSettingsFilePath()
tempFilePath = GetTSVPath() & "\settings_temp.tsv"
currentDate = Now()
userFound = False
On Error Resume Next
If fso.FileExists(settingsFile) Then
Set tempFile = fso.CreateTextFile(tempFilePath, True, True)
Set file = fso.OpenTextFile(settingsFile, 1, False, -1)
If Not file.AtEndOfStream Then
tempFile.WriteLine file.ReadLine
End If
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= 1 Then
If CInt(Trim(fields(0))) = CInt(userID) Then
tempFile.WriteLine userID & vbTab & settingsData & vbTab & currentDate
userFound = True
Else
tempFile.WriteLine line
End If
End If
End If
Loop
If Not userFound Then
tempFile.WriteLine userID & vbTab & settingsData & vbTab & currentDate
End If
file.Close
tempFile.Close
Set file = Nothing
Set tempFile = Nothing
fso.DeleteFile settingsFile
fso.MoveFile tempFilePath, settingsFile
End If
If Err.Number <> 0 Then
MsgBox "Помилка збереження налаштувань: " & Err.Description, vbCritical
End If
On Error GoTo 0
End Sub
Function GetProductionFlowFilePath()
GetProductionFlowFilePath = GetTSVPath() & "\ProductionFlowDB.tsv"
End Function
Function CreateProductionFlowFileIfNotExists()
On Error Resume Next
CreateProductionFlowFileIfNotExists = True
Dim fso,productionFlowFile
Set fso = CreateObject("Scripting.FileSystemObject")
productionFlowFile = GetProductionFlowFilePath()
If Not fso.FileExists(productionFlowFile) Then
Dim file
Set file = fso.CreateTextFile(productionFlowFile, True, True) ' Unicode
file.WriteLine "Date" & vbTab & "ProductionFlow" & vbTab & "VerifiedProductionFlow" & vbTab & "PFUpdatedDate_1" & vbTab & "User_1" & vbTab & "PFUpdatedDate_2" & vbTab & "User_2" & vbTab & "VPFUpdatedDate_1" & vbTab & "Moderator_1" & vbTab & "VPFUpdatedDate_2" & vbTab & "Moderator_2"
file.Close
Set file = Nothing
End If
If Err.Number <> 0 Then
MsgBox "Помилка створення ProductionFlowDB.tsv: " & Err.Description, vbCritical
CreateProductionFlowFileIfNotExists = False
End If
Set fso = Nothing
On Error GoTo 0
End Function
Function GetProductionFlowData(analysisDate)
Dim fso,filePath,file, line, fields
GetProductionFlowData = ""
If Not CreateProductionFlowFileIfNotExists() Then Exit Function
Set fso = CreateObject("Scripting.FileSystemObject")
filePath = GetProductionFlowFilePath()
On Error Resume Next
If fso.FileExists(filePath) Then
Set file = fso.OpenTextFile(filePath, 1, False, -1)
If Not file.AtEndOfStream Then file.ReadLine
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= 1 Then
If Trim(fields(0)) = analysisDate Then
GetProductionFlowData = Trim(fields(1))
Exit Do
End If
End If
End If
Loop
file.Close
End If
Set fso = Nothing
On Error GoTo 0
End Function
Function GetVerifiedProductionFlowData(analysisDate, shift)
Dim fso,filePath,file, line, fields, userId, moderatorId
GetVerifiedProductionFlowData = "" ' За замовчуванням
If Not CreateProductionFlowFileIfNotExists() Then Exit Function
Set fso = CreateObject("Scripting.FileSystemObject")
filePath = GetProductionFlowFilePath()
On Error Resume Next
If fso.FileExists(filePath) Then
Set file = fso.OpenTextFile(filePath, 1, False, -1)
If Not file.AtEndOfStream Then file.ReadLine
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= 10 Then
If Trim(fields(0)) = analysisDate Then
If CInt(shift) = 1 Then
userId = Trim(fields(4)) ' User_1
moderatorId = Trim(fields(8)) ' Moderator_1
Else
userId = Trim(fields(6)) ' User_2
moderatorId = Trim(fields(10)) ' Moderator_2
End If
GetVerifiedProductionFlowData = Trim(fields(2)) & "|||" & userId & "|||" & moderatorId
Exit Do
End If
End If
End If
Loop
file.Close
End If
Set fso = Nothing
On Error GoTo 0
End Function
Function IsDataVerifiedForDate(analysisDate, shift)
Dim fso,filePath,file, line, fields, columnIndex
IsDataVerifiedForDate = False
If Not CreateProductionFlowFileIfNotExists() Then Exit Function
Set fso = CreateObject("Scripting.FileSystemObject")
filePath = GetProductionFlowFilePath()
If CInt(shift) = 1 Then columnIndex = 7 Else columnIndex = 9
On Error Resume Next
If fso.FileExists(filePath) Then
Set file = fso.OpenTextFile(filePath, 1, False, -1)
If Not file.AtEndOfStream Then file.ReadLine
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= columnIndex Then
If Trim(fields(0)) = analysisDate Then
If Trim(fields(columnIndex)) <> "" Then IsDataVerifiedForDate = True
Exit Do
End If
End If
End If
Loop
file.Close
End If
Set fso = Nothing
On Error GoTo 0
End Function
Sub SaveProductionFlowData(analysisDate, encryptedProductionFlow, updatedDate, userID, shift)
Dim fso,filePath,tempFilePath, file, tempFile, line, fields, recordFound
If Not CreateProductionFlowFileIfNotExists() Then Exit Sub
Set fso = CreateObject("Scripting.FileSystemObject")
filePath = GetProductionFlowFilePath()
tempFilePath = GetTSVPath() & "\prod_temp.tsv"
recordFound = False
On Error Resume Next
If fso.FileExists(filePath) Then
Set tempFile = fso.CreateTextFile(tempFilePath, True, True)
Set file = fso.OpenTextFile(filePath, 1, False, -1)
If Not file.AtEndOfStream Then tempFile.WriteLine file.ReadLine
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) < 10 Then
Dim tempFields(10)
For i = 0 To UBound(fields)
tempFields(i) = fields(i)
Next
For i = UBound(fields) + 1 To 10
tempFields(i) = ""
Next
fields = tempFields
End If
If Trim(fields(0)) = analysisDate Then
recordFound = True
If CInt(shift) = 1 Then
fields(1) = encryptedProductionFlow
fields(3) = updatedDate
fields(4) = userID
Else
fields(1) = encryptedProductionFlow
fields(5) = updatedDate
fields(6) = userID
End If
tempFile.WriteLine Join(fields, vbTab)
Else
tempFile.WriteLine line
End If
End If
Loop
If Not recordFound Then
Dim newFields(10)
newFields(0) = analysisDate
newFields(1) = encryptedProductionFlow
If CInt(shift) = 1 Then
newFields(3) = updatedDate
newFields(4) = userID
Else
newFields(5) = updatedDate
newFields(6) = userID
End If
tempFile.WriteLine Join(newFields, vbTab)
End If
file.Close
tempFile.Close
fso.DeleteFile filePath, True
fso.MoveFile tempFilePath, filePath
End If
If Err.Number <> 0 Then MsgBox "Помилка збереження ProductionFlow: " & Err.Description, vbCritical
Set fso = Nothing
On Error GoTo 0
End Sub
Sub SaveVerifiedProductionFlowData(analysisDate, encryptedVerifiedData, updatedDate, moderatorID, shift)
Dim fso,filePath,tempFilePath, file, tempFile, line, fields, recordFound
If Not CreateProductionFlowFileIfNotExists() Then Exit Sub
Set fso = CreateObject("Scripting.FileSystemObject")
filePath = GetProductionFlowFilePath()
tempFilePath = GetTSVPath() & "\verified_temp.tsv"
recordFound = False
On Error Resume Next
If fso.FileExists(filePath) Then
Set tempFile = fso.CreateTextFile(tempFilePath, True, True)
Set file = fso.OpenTextFile(filePath, 1, False, -1)
If Not file.AtEndOfStream Then tempFile.WriteLine file.ReadLine
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) < 10 Then
Dim tempFields(10)
For i = 0 To UBound(fields)
tempFields(i) = fields(i)
Next
For i = UBound(fields) + 1 To 10
tempFields(i) = ""
Next
fields = tempFields
End If
If Trim(fields(0)) = analysisDate Then
recordFound = True
fields(2) = encryptedVerifiedData
If CInt(shift) = 1 Then
fields(7) = updatedDate
fields(8) = moderatorID
Else
fields(9) = updatedDate
fields(10) = moderatorID
End If
tempFile.WriteLine Join(fields, vbTab)
Else
tempFile.WriteLine line
End If
End If
Loop
If Not recordFound Then
Dim newFields(10)
newFields(0) = analysisDate
newFields(2) = encryptedVerifiedData
If CInt(shift) = 1 Then
newFields(7) = updatedDate
newFields(8) = moderatorID
Else
newFields(9) = updatedDate
newFields(10) = moderatorID
End If
tempFile.WriteLine Join(newFields, vbTab)
End If
file.Close
tempFile.Close
fso.DeleteFile filePath, True
fso.MoveFile tempFilePath, filePath
End If
If Err.Number <> 0 Then MsgBox "Помилка збереження VerifiedProductionFlow: " & Err.Description, vbCritical
Set fso = Nothing
On Error GoTo 0
End Sub
Function GetDatesWithData(baseColumnName)
Dim fso,filePath,file, line, fields, datesList, dateValue, formattedDate
Dim colIndex1,colIndex2
Set fso = CreateObject("Scripting.FileSystemObject")
Set datesList = CreateObject("System.Collections.ArrayList")
If Not CreateProductionFlowFileIfNotExists() Then GetDatesWithData = "": Exit Function
Select Case LCase(baseColumnName)
Case "pfupdateddate"
colIndex1 = 3 ' PFUpdatedDate_1
colIndex2 = 5 ' PFUpdatedDate_2
Case "vpfupdateddate"
colIndex1 = 7 ' VPFUpdatedDate_1
colIndex2 = 9 ' VPFUpdatedDate_2
Case Else
GetDatesWithData = ""
Exit Function
End Select
filePath = GetProductionFlowFilePath()
On Error Resume Next
If fso.FileExists(filePath) Then
Set file = fso.OpenTextFile(filePath, 1, False, -1)
If Not file.AtEndOfStream Then file.ReadLine
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= colIndex2 And (Trim(fields(colIndex1)) <> "" Or Trim(fields(colIndex2)) <> "") Then
dateValue = Trim(fields(0))
Dim dateParts,y,m, d
dateParts = Split(dateValue, "-")
If UBound(dateParts) = 2 Then
y = CStr(dateParts(0)): m = CStr(dateParts(1)): d = CStr(dateParts(2))
If Len(m) = 1 Then m = "0" & m
If Len(d) = 1 Then d = "0" & d
formattedDate = y & "-" & m & "-" & d
If Not datesList.Contains(formattedDate) Then datesList.Add formattedDate
End If
End If
End If
Loop
file.Close
End If
If Err.Number <> 0 Then GetDatesWithData = "Error: " & Err.Description Else GetDatesWithData = Join(datesList.ToArray(), ",")
Set fso = Nothing
On Error GoTo 0
End Function
Function GetAllVerifiedProductionFlowData()
Dim fso,filePath,file, line, fields, allData, rowSeparator
allData = ""
rowSeparator = "|||ROW|||"
If Not CreateProductionFlowFileIfNotExists() Then
GetAllVerifiedProductionFlowData = ""
Exit Function
End If
Set fso = CreateObject("Scripting.FileSystemObject")
filePath = GetProductionFlowFilePath()
On Error Resume Next
If fso.FileExists(filePath) Then
Set file = fso.OpenTextFile(filePath, 1, False, -1)
If Not file.AtEndOfStream Then file.ReadLine
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then
fields = Split(line, vbTab)
If UBound(fields) >= 10 Then
Dim dateValue,verifiedData,userData, moderatorData
dateValue = Trim(fields(0))
verifiedData = Trim(fields(2))
If verifiedData <> "" Then
If Trim(fields(7)) <> "" Then ' VPFUpdatedDate_1
userData = Trim(fields(4)) ' User_1
moderatorData = Trim(fields(8)) ' Moderator_1
If allData <> "" Then allData = allData & rowSeparator
allData = allData & dateValue & "|||" & verifiedData & "|||" & userData & "|||" & moderatorData
End If
If Trim(fields(9)) <> "" Then ' VPFUpdatedDate_2
userData = Trim(fields(6)) ' User_2
moderatorData = Trim(fields(10)) ' Moderator_2
If allData <> "" Then allData = allData & rowSeparator
allData = allData & dateValue & "|||" & verifiedData & "|||" & userData & "|||" & moderatorData
End If
End If
End If
End If
Loop
file.Close
End If
GetAllVerifiedProductionFlowData = allData
Set fso = Nothing
On Error GoTo 0
End Function
Function GetProductionFlowStats()
Dim fso,filePath,file, line, recordCount
GetProductionFlowStats = ""
recordCount = 0
If Not CreateProductionFlowFileIfNotExists() Then GetProductionFlowStats = "Помилка створення файлу": Exit Function
Set fso = CreateObject("Scripting.FileSystemObject")
filePath = GetProductionFlowFilePath()
On Error Resume Next
If fso.FileExists(filePath) Then
Set file = fso.OpenTextFile(filePath, 1, False, -1)
If Not file.AtEndOfStream Then file.ReadLine
Do Until file.AtEndOfStream
line = Trim(file.ReadLine)
If line <> "" Then recordCount = recordCount + 1
Loop
file.Close
GetProductionFlowStats = "ProductionFlowDB працює. Записів: " & recordCount
Else
GetProductionFlowStats = "ProductionFlowDB.tsv не знайдено"
End If
If Err.Number <> 0 Then GetProductionFlowStats = "Помилка роботи з ProductionFlowDB: " & Err.Description
Set fso = Nothing
On Error GoTo 0
End Function
Sub Window_OnLoad
Call hideAllForms()
Dim dbTest
dbTest = TestDatabaseConnection()
If Not CheckIfAdminExists() Then
Call showAdminSetup()
Else
Call showLoginForm()
document.getElementById("username").focus
End If
End Sub
</script>

<style>
* {
  box-sizing: border-box
}
html {
  height: 100%;
  font-size: 100%;
  margin: 0;
  padding: 0;
  -webkit-text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
  overflow: hidden
}
body {
  margin: 0;
  padding: 0;
  border: none;
  font-family: "Segoe UI",Arial,sans-serif;
  font-size: 16px;
  line-height: 1.4;
  color: #424242;
  background-color: #f5f5f5;
  width: 100%;
  height: 100%;
  overflow: hidden
}
h1,
h2,
h3,
h4,
h5,
h6 {
  margin: 0;
  padding: 0
}
ol,
ul {
  margin: 0;
  padding: 0;
  list-style: none
}
input,
select,
textarea {
  font-family: inherit;
  font-size: inherit;
  margin: 0;
  padding: 0;
  border: none;
  background: 0 0
}
img {
  display: block;
  max-width: 100%;
  width: 100%;
  height: auto;
  border: none
}
table {
  border-spacing: 0;
  width: 100%;
  border-collapse: collapse;
  margin-top: 16px
}
td,
th {
  padding: 0;
  margin: 0;
  text-align: left
}
fieldset {
  border: none;
  margin: 0;
  padding: 0
}
legend {
  padding: 0;
  margin: 0
}
#adminSetupForm,
#changePasswordForm,
#createUserForm,
#deleteUserForm,
#loginForm,
#myXORKeyForm,
#registerForm,
#secureContent,
#usersListForm {
  display: none
}
h1 {
  text-align: center;
  color: #334155;
  font-size: 28px;
  font-weight: 700;
  margin-bottom: 36px
}
h2 {
  color: #334155;
  font-size: 24px;
  font-weight: 700;
  margin-bottom: 24px
}
h3 {
  color: #334155;
  font-size: 20px;
  font-weight: 600;
  margin-bottom: 16px;
  margin-top: 0
}
h4 {
  color: #424242;
  font-size: 18px;
  font-weight: 600;
  margin-bottom: 16px
}
h5 {
  color: #424242;
  font-size: 16px;
  font-weight: 600;
  margin-bottom: 8px
}
h6 {
  color: #757575;
  font-size: 14px;
  font-weight: 600;
  margin-bottom: 8px
}
p {
  margin: 0 0 16px;
  padding: 0;
  font-size: 16px;
  line-height: 1.5;
  color: #424242
}
p:last-child {
  margin-bottom: 0
}
a {
  color: #3498db;
  text-decoration: none;
  cursor: pointer;
  -webkit-transition: color .3s;
  -moz-transition: color .3s;
  -o-transition: color .3s;
  transition: color .3s
}
a:hover {
  color: #2980b9;
  text-decoration: underline
}
a:focus {
  outline: #3498db solid 2px;
  outline-offset: 2px
}
label {
  display: block;
  margin-bottom: 8px;
  font-weight: 600;
  color: #757575;
  font-size: 16px
}
.success-message {
  text-align: center;
  font-size: 18px;
  color: #22c55e;
  font-weight: 600;
  margin-top: 24px
}
.info-note {
  font-size: 12px;
  color: #9e9e9e;
  margin-top: 8px;
  text-align: center
}
.security-info {
  background: #f5f5f5;
  padding: 16px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  margin-top: 16px;
  font-size: 13px;
  color: #757575;
  line-height: 1.5
}
.security-info strong {
  color: #424242;
  font-weight: 700
}
.form-toggle {
  text-align: center;
  margin-top: 24px
}
.form-toggle a {
  color: #3498db;
  font-weight: 600
}
.form-toggle a:hover {
  text-decoration: underline
}
.text-center {
  text-align: center
}
.text-left {
  text-align: left
}
.text-right {
  text-align: right
}
.text-muted {
  color: #9e9e9e
}
.text-primary {
  color: #3498db
}
.text-success {
  color: #22c55e
}
.text-danger {
  color: #ef4444
}
.text-warning {
  color: #f59e0b
}
.font-weight-normal {
  font-weight: 400
}
.font-weight-bold {
  font-weight: 700
}
.font-size-small {
  font-size: 12px
}
.font-size-large {
  font-size: 18px
}
.promo-box {
  max-width: 35vw;
  width: 35vw;
  margin: 0;
  border: none;
  overflow: hidden;
  position: absolute;
  top: 50%;
  left: 30%;
  transform: translate(-50%,-50%);
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: flex-start;
  -webkit-justify-content: flex-start;
  justify-content: flex-start;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
  z-index: 1
}
@media screen and (max-width:768px) {
  .promo-box {
    position: absolute;
    top: 50%;
    left: 20%;
    transform: translate(-50%,-50%)
  }
}
.promo-box__footer {
  position: absolute;
  top: 96%;
  left: 50%;
  transform: translate(-50%,-50%);
  font-size: 8px;
  color: #000;
  z-index: 1
}
.promo-box__footer-text {
  font-size: 12px
}
.logo__icon {
  max-width: 12.783vw;
  width: 12.783vw
}
@media screen and (max-width:648px) {
  .logo__icon {
    display: none
  }
}
.logo__text {
  max-width: 20.37vw;
  width: 20.37vw;
  margin-left: -1.71vw;
  margin-bottom: -.1vw;
  text-align: center
}
@media screen and (max-width:1024px) {
  .logo__text {
    display: none
  }
}
button {
  background: 0 0;
  margin: 0;
  font-family: inherit;
  border: none;
  padding: 16px 24px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 600;
  width: 100%;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  background: -ms-linear-gradient(top,#3498db,#2980b9);
  background: -webkit-linear-gradient(135deg,#3498db,#2980b9);
  background: linear-gradient(135deg,#3498db,#2980b9);
  color: #fff
}
button:focus,
button:hover {
  background: -ms-linear-gradient(top,#2980b9,#1f618d);
  background: -webkit-linear-gradient(135deg,#2980b9,#1f618d);
  background: linear-gradient(135deg,#2980b9,#1f618d);
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.secondary-btn {
  border: 2px solid #3498db;
  padding: 16px 24px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 600;
  width: 100%;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  background: 0 0;
  color: #3498db;
  margin-top: 16px
}
.secondary-btn:hover {
  background: #e3f2fd;
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.back-button {
  border: none;
  padding: 16px 24px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 600;
  width: 100%;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  background: #9e9e9e;
  color: #fff;
  margin-top: 10px;
  font-size: 24px;
  line-height: 1
}
.back-button:hover {
  background: #757575;
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.back-button--journal {
  width: 36px;
  padding: 8px;
  margin-top: 0
}
.danger-button {
  border: none;
  padding: 16px 24px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 600;
  width: 100%;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  background: #ef4444;
  color: #fff
}
.danger-button:hover {
  background: #dc2626;
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.menu-button {
  border: none;
  padding: 12px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 4px;
  border-radius: 4px;
  cursor: pointer;
  font-weight: 600;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  display: block;
  width: 100%;
  margin-bottom: 10px;
  background: #3498db;
  color: #fff;
  -webkit-border-radius: 4px;
  font-size: 14px
}
.menu-button:hover {
  background: #2980b9;
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.button-group {
  display: block
}
.button-group .button {
  margin-bottom: 10px
}
.button-group .button:last-child {
  margin-bottom: 0
}
.btn-small {
  padding: 8px 16px;
  font-size: 12px
}
.btn-large {
  padding: 24px 36px;
  font-size: 18px
}
.btn-disabled {
  opacity: .6;
  cursor: not-allowed
}
.btn-disabled:hover {
  -webkit-transform: none;
  -ms-transform: none;
  transform: none
}
.btn-loading {
  position: relative;
  color: transparent
}
.btn-loading:after {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  width: 16px;
  height: 16px;
  margin-top: -8px;
  margin-left: -8px;
  border: 2px solid transparent;
  border-top: 2px solid #fff;
  -webkit-border-radius: 50%;
  -moz-border-radius: 50%;
  border-radius: 50%;
  animation: 1s linear infinite spin
}
@keyframes spin {
  0% {
    -webkit-transform: rotate(0);
    -ms-transform: rotate(0);
    transform: rotate(0)
  }
  100% {
    -webkit-transform: rotate(360deg);
    -ms-transform: rotate(360deg);
    transform: rotate(360deg)
  }
}
.btn-icon {
  position: relative
}
.btn-icon:before {
  content: "";
  display: inline-block;
  width: 16px;
  height: 16px;
  margin-right: 8px;
  vertical-align: middle
}
.btn-icon-only {
  width: auto;
  min-width: 44px;
  height: 44px;
  padding: 10px
}
.btn-icon-only:before {
  margin-right: 0
}
.btn-success {
  border: none;
  padding: 16px 24px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 600;
  width: 100%;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  background: #22c55e;
  color: #fff
}
.btn-success:hover {
  background: #1a9a49;
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.btn-warning {
  border: none;
  padding: 16px 24px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 600;
  width: 100%;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  background: #f59e0b;
  color: #fff
}
.btn-warning:hover {
  background: #c57f08;
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.btn-info {
  border: none;
  padding: 16px 24px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 600;
  width: 100%;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  background: #3498db;
  color: #fff
}
.btn-info:hover {
  background: #217dbb;
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.btn-light {
  border: none;
  padding: 16px 24px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 600;
  width: 100%;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  background: #f5f5f5;
  color: #424242
}
.btn-light:hover {
  background: #dcdcdc;
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.btn-outline-primary {
  border: 2px solid #3498db;
  padding: 16px 24px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 600;
  width: 100%;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  background: 0 0;
  color: #3498db
}
.btn-outline-primary:hover {
  background: #3498db;
  color: #fff;
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.btn-outline-secondary {
  border: 2px solid #334155;
  padding: 16px 24px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 600;
  width: 100%;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  background: 0 0;
  color: #334155
}
.btn-outline-secondary:hover {
  background: #334155;
  color: #fff;
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.btn-outline-danger {
  border: 2px solid #ef4444;
  padding: 16px 24px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 600;
  width: 100%;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  background: 0 0;
  color: #ef4444
}
.btn-outline-danger:hover {
  background: #ef4444;
  color: #fff;
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.wrapper {
  min-width: 100vw;
  width: 100%;
  min-height: 100vh;
  max-height: 100vh;
  overflow-y: auto
}
@media screen and (max-height:768px) {
  .wrapper {
    padding-right: 8vw;
    padding-top: 8vh;
    display: -ms-flexbox;
    display: -webkit-flex;
    display: flex;
    -ms-flex-direction: row;
    -webkit-flex-direction: row;
    flex-direction: row;
    -ms-flex-wrap: nowrap;
    -webkit-flex-wrap: nowrap;
    flex-wrap: nowrap;
    -ms-flex-pack: flex-end;
    -webkit-justify-content: flex-end;
    justify-content: flex-end;
    -ms-flex-align: flex-start;
    -webkit-align-items: flex-start;
    align-items: flex-start
  }
}
.containerForm {
  background-color: rgba(255,255,255,.95);
  -webkit-border-radius: 12px;
  -moz-border-radius: 12px;
  border-radius: 12px;
  -webkit-box-shadow: 0 10px 15px rgba(0,0,0,.1);
  -moz-box-shadow: 0 10px 15px rgba(0,0,0,.1);
  box-shadow: 0 10px 15px rgba(0,0,0,.1);
  padding: 36px;
  max-width: 90%;
  width: 480px
}
@media screen and (min-height:768px) {
  .containerForm {
    position: absolute;
    top: 50%;
    left: 70%;
    transform: translate(-50%,-50%);
    z-index: 1
  }
}
#loginForm {
  min-height: 450px
}
#adminSetupForm {
  min-height: 645px
}
#myXORKeyForm,
#secureContent,
#usersListForm {
  min-height: 768px
}
#createUserForm {
  min-height: 720px
}
#changePasswordForm {
  min-height: 740px
}
.form-group {
  margin-bottom: 24px
}
.form-group:last-child {
  margin-bottom: 0
}
.form-row {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: space-between;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  -ms-flex-align: flex-start;
  -webkit-align-items: flex-start;
  align-items: flex-start;
  margin-bottom: 24px
}
.form-row .form-group {
  flex: 1;
  margin-bottom: 0
}
.form-row .form-group:not(:last-child) {
  margin-right: 16px
}
input[type=date],
input[type=email],
input[type=number],
input[type=password],
input[type=tel],
input[type=text],
input[type=url] {
  width: 100%;
  padding: 8px;
  border: 2px solid #e0e0e0;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  font-size: 16px;
  box-sizing: border-box;
  -webkit-transition: border-color .3s;
  -moz-transition: border-color .3s;
  -o-transition: border-color .3s;
  transition: border-color .3s
}
input[type=date]:focus,
input[type=email]:focus,
input[type=number]:focus,
input[type=password]:focus,
input[type=tel]:focus,
input[type=text]:focus,
input[type=url]:focus,
select:focus,
textarea:focus {
  border-color: #3498db;
  outline: 0;
  -webkit-box-shadow: 0 0 0 3px rgba(52,152,219,.25);
  -moz-box-shadow: 0 0 0 3px rgba(52,152,219,.25);
  box-shadow: 0 0 0 3px rgba(52,152,219,.25)
}
input[type=date]:hover,
input[type=email]:hover,
input[type=number]:hover,
input[type=password]:hover,
input[type=tel]:hover,
input[type=text]:hover,
input[type=url]:hover,
textarea:hover {
  border-color: #bdbdbd
}
input[type=date]:disabled,
input[type=email]:disabled,
input[type=number]:disabled,
input[type=password]:disabled,
input[type=tel]:disabled,
input[type=text]:disabled,
input[type=url]:disabled,
select:disabled,
textarea:disabled {
  background-color: #f5f5f5;
  color: #bdbdbd;
  border-color: #e0e0e0;
  cursor: not-allowed
}
textarea {
  width: 100%;
  padding: 8px;
  border: 2px solid #e0e0e0;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  box-sizing: border-box;
  -webkit-transition: border-color .3s;
  -moz-transition: border-color .3s;
  -o-transition: border-color .3s;
  transition: border-color .3s;
  resize: vertical;
  min-height: 80px;
  font-family: monospace;
  font-size: 12px;
  line-height: 1.4
}
select {
  width: 100%;
  padding: 8px 40px 8px 8px;
  border: 2px solid #e0e0e0;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  font-size: 16px;
  box-sizing: border-box;
  -webkit-transition: border-color .3s;
  -moz-transition: border-color .3s;
  -o-transition: border-color .3s;
  transition: border-color .3s;
  background-image: url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 4 5'%3E%3Cpath fill='%23666' d='M2 0L0 2h4zm0 5L0 3h4z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 12px center;
  background-size: 12px;
  cursor: pointer
}
select:hover {
  border-color: #bdbdbd;
  background-color: #e3f2fd
}
select::-ms-expand {
  display: none
}
.form-check {
  display: block;
  margin-bottom: 16px
}
.form-check input[type=checkbox],
.form-check input[type=radio] {
  width: auto;
  margin-right: 8px;
  vertical-align: middle
}
.form-check label {
  display: inline-block;
  margin-bottom: 0;
  font-weight: 400;
  cursor: pointer
}
.form-check-inline {
  display: inline-block;
  margin-right: 24px;
  margin-bottom: 0
}
.form-group.has-success input,
.form-group.has-success select,
.form-group.has-success textarea {
  border-color: #22c55e
}
.form-group.has-success input:focus,
.form-group.has-success select:focus,
.form-group.has-success textarea:focus {
  border-color: #22c55e;
  -webkit-box-shadow: 0 0 0 3px rgba(34,197,94,.25);
  -moz-box-shadow: 0 0 0 3px rgba(34,197,94,.25);
  box-shadow: 0 0 0 3px rgba(34,197,94,.25)
}
.form-group.has-error input,
.form-group.has-error select,
.form-group.has-error textarea {
  border-color: #ef4444
}
.form-group.has-error input:focus,
.form-group.has-error select:focus,
.form-group.has-error textarea:focus {
  border-color: #ef4444;
  -webkit-box-shadow: 0 0 0 3px rgba(239,68,68,.25);
  -moz-box-shadow: 0 0 0 3px rgba(239,68,68,.25);
  box-shadow: 0 0 0 3px rgba(239,68,68,.25)
}
.form-group.has-warning input,
.form-group.has-warning select,
.form-group.has-warning textarea {
  border-color: #f59e0b
}
.form-group.has-warning input:focus,
.form-group.has-warning select:focus,
.form-group.has-warning textarea:focus {
  border-color: #f59e0b;
  -webkit-box-shadow: 0 0 0 3px rgba(245,158,11,.25);
  -moz-box-shadow: 0 0 0 3px rgba(245,158,11,.25);
  box-shadow: 0 0 0 3px rgba(245,158,11,.25)
}
.form-feedback {
  display: block;
  margin-top: 8px;
  font-size: 12px
}
.form-feedback.valid-feedback {
  color: #22c55e
}
.form-feedback.invalid-feedback {
  color: #ef4444
}
.form-feedback.warning-feedback {
  color: #f59e0b
}
.password-wrapper {
  position: relative
}
.password-wrapper input[type=password],
.password-wrapper input[type=text] {
  padding-right: 40px
}
.password-toggle-icon {
  position: absolute;
  top: 50%;
  right: 12px;
  transform: translateY(-50%);
  cursor: pointer;
  user-select: none;
  color: #9e9e9e;
  font-size: 20px;
  transition: color .2s
}
.password-toggle-icon:hover {
  color: #424242
}
.menu {
  background: #f5f5f5;
  padding: 24px;
  -webkit-border-radius: 8px;
  -moz-border-radius: 8px;
  border-radius: 8px;
  margin-top: 16px
}
.menu h3 {
  margin-top: 0;
  color: #334155;
  margin-bottom: 16px
}
.role-badge {
  background: #dcfce7;
  color: #22c55e;
  padding: 4px 8px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px;
  font-size: 16px;
  font-weight: 700;
  font-family: "Lucida Sans Unicode","Lucida Grande",sans-serif;
  letter-spacing: .75px
}
.role-badge.Administrator {
  background: #dcfce7;
  color: #ef4444;
  padding: 4px 8px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px;
  font-size: 16px;
  font-weight: 700;
  font-family: "Lucida Sans Unicode","Lucida Grande",sans-serif;
  letter-spacing: .75px
}
.role-badge.Moderator {
  background: #dcfce7;
  color: #f59e0b;
  padding: 4px 8px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px;
  font-size: 16px;
  font-weight: 700;
  font-family: "Lucida Sans Unicode","Lucida Grande",sans-serif;
  letter-spacing: .75px
}
.role-badge.User {
  background: #dcfce7;
  color: #3498db;
  padding: 4px 8px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px;
  font-size: 16px;
  font-weight: 700;
  font-family: "Lucida Sans Unicode","Lucida Grande",sans-serif;
  letter-spacing: .75px
}
.role-badge.Guest {
  background: #dcfce7;
  color: #9e9e9e;
  padding: 4px 8px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px;
  font-size: 16px;
  font-weight: 700;
  font-family: "Lucida Sans Unicode","Lucida Grande",sans-serif;
  letter-spacing: .75px
}
table td,
table th {
  padding: 8px;
  text-align: left;
  border: 1px solid #e0e0e0
}
table th {
  background-color: #eee;
  font-weight: 700;
  position: sticky;
  top: 0;
  z-index: 10
}
table tr:nth-child(2n) {
  background-color: #fafafa
}
table tr:hover {
  background-color: #e3f2fd
}
table th.sortable {
  cursor: pointer;
  user-select: none
}
table th.sortable:hover {
  background-color: #bdbdbd
}
table th.sortable:after {
  content: " ↕";
  color: #9e9e9e;
  font-size: 12px
}
table th.sortable.sort-asc:after {
  content: " ↑";
  color: #3498db
}
table th.sortable.sort-desc:after {
  content: " ↓";
  color: #3498db
}
table td {
  vertical-align: middle
}
table td.text-center {
  text-align: center
}
table td.text-right {
  text-align: right
}
table td.actions {
  white-space: nowrap;
  width: 1%
}
.stats-grid {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: wrap;
  -webkit-flex-wrap: wrap;
  flex-wrap: wrap;
  -ms-flex-pack: space-between;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  -ms-flex-align: stretch;
  -webkit-align-items: stretch;
  align-items: stretch;
  margin-bottom: 24px;
  gap: 16px
}
.stat-card {
  flex: 1;
  min-width: 200px;
  background: #fff;
  padding: 24px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  -webkit-box-shadow: 0 1px 3px rgba(0,0,0,.1);
  -moz-box-shadow: 0 1px 3px rgba(0,0,0,.1);
  box-shadow: 0 1px 3px rgba(0,0,0,.1);
  text-align: center
}
.stat-card .stat-number {
  font-size: 32px;
  font-weight: 700;
  color: #3498db;
  margin-bottom: 8px
}
.stat-card .stat-label {
  color: #9e9e9e;
  font-size: 12px;
  text-transform: uppercase;
  letter-spacing: 1px
}
.stat-card.stat-success .stat-number {
  color: #22c55e
}
.stat-card.stat-warning .stat-number {
  color: #f59e0b
}
.stat-card.stat-danger .stat-number {
  color: #ef4444
}
.alert {
  padding: 16px;
  margin-bottom: 16px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  border: 1px solid transparent
}
.alert.alert-success {
  color: #16a34a;
  background-color: #dcfce7;
  border-color: #22c55e
}
.alert.alert-danger {
  color: #dc2626;
  background-color: #fee2e2;
  border-color: #ef4444
}
.alert.alert-warning {
  color: #d97706;
  background-color: #fef3c7;
  border-color: #f59e0b
}
.alert.alert-info {
  color: #2980b9;
  background-color: #bbdefb;
  border-color: #3498db
}
.progress {
  width: 100%;
  height: 20px;
  background-color: #f5f5f5;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  overflow: hidden;
  margin-bottom: 16px
}
.progress .progress-bar {
  height: 100%;
  background-color: #3498db;
  -webkit-transition: width .6s;
  -moz-transition: width .6s;
  -o-transition: width .6s;
  transition: width .6s
}
.progress .progress-bar.progress-striped {
  background-image: linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);
  background-size: 1rem 1rem
}
.progress .progress-bar.progress-animated {
  animation: 1s linear infinite progress-bar-stripes
}
@keyframes progress-bar-stripes {
  from {
    background-position: 1rem 0
  }
  to {
    background-position: 0 0
  }
}
.modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0,0,0,.5);
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-pack: center;
  -webkit-justify-content: center;
  justify-content: center;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
  z-index: 1050
}
.modal .modal-dialog {
  background: #fff;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  max-width: 500px;
  width: 90%;
  max-height: 90vh;
  overflow-y: auto
}
.modal .modal-header {
  padding: 24px;
  border-bottom: 1px solid #e0e0e0;
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: space-between;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center
}
.modal .modal-header h5 {
  margin: 0;
  color: #424242
}
.modal .modal-header .close {
  background: 0 0;
  border: none;
  font-size: 24px;
  cursor: pointer;
  padding: 0;
  width: auto;
  color: #9e9e9e
}
.modal .modal-header .close:hover {
  color: #424242
}
.modal .modal-body {
  padding: 24px
}
.modal .modal-footer {
  padding: 24px;
  border-top: 1px solid #e0e0e0;
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: flex-end;
  -webkit-justify-content: flex-end;
  justify-content: flex-end;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center
}
.modal .modal-footer button {
  width: auto;
  margin-left: 8px
}
.modal .modal-footer button:first-child {
  margin-left: 0
}
.dropdown {
  position: relative;
  display: inline-block
}
.dropdown .dropdown-toggle {
  cursor: pointer
}
.dropdown .dropdown-toggle:after {
  content: " ▼";
  font-size: 12px;
  margin-left: 8px
}
.dropdown .dropdown-menu {
  position: absolute;
  top: 100%;
  left: 0;
  z-index: 1000;
  display: none;
  min-width: 160px;
  background-color: #fff;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  -webkit-box-shadow: 0 4px 6px rgba(0,0,0,.07);
  -moz-box-shadow: 0 4px 6px rgba(0,0,0,.07);
  box-shadow: 0 4px 6px rgba(0,0,0,.07);
  border: 1px solid #e0e0e0
}
.dropdown .dropdown-menu.show {
  display: block
}
.dropdown .dropdown-menu .dropdown-item {
  display: block;
  padding: 8px 16px;
  color: #424242;
  text-decoration: none;
  border: none;
  background: 0 0;
  width: 100%;
  text-align: left;
  cursor: pointer
}
.dropdown .dropdown-menu .dropdown-item:hover {
  background-color: #e3f2fd;
  color: #424242
}
.dropdown .dropdown-menu .dropdown-item:focus {
  background-color: #3498db;
  color: #fff;
  outline: 0
}
.dropdown .dropdown-menu .dropdown-item.disabled {
  color: #9e9e9e;
  cursor: not-allowed
}
.dropdown .dropdown-menu .dropdown-item.disabled:hover {
  background-color: transparent
}
.dropdown .dropdown-menu .dropdown-divider {
  height: 0;
  margin: 8px 0;
  overflow: hidden;
  border-top: 1px solid #e0e0e0
}
.pagination {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: center;
  -webkit-justify-content: center;
  justify-content: center;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
  margin-top: 24px
}
.pagination .page-item {
  margin: 0 2px
}
.pagination .page-item .page-link {
  display: block;
  padding: 8px 16px;
  background: #fff;
  border: 1px solid #e0e0e0;
  color: #3498db;
  text-decoration: none;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s
}
.pagination .page-item .page-link:hover {
  background-color: #e3f2fd;
  border-color: #3498db
}
.pagination .page-item .page-link:focus {
  outline: #3498db solid 2px;
  outline-offset: 2px
}
.pagination .page-item.active .page-link {
  background-color: #3498db;
  border-color: #3498db;
  color: #fff
}
.pagination .page-item.disabled .page-link {
  color: #9e9e9e;
  cursor: not-allowed
}
.pagination .page-item.disabled .page-link:hover {
  background-color: #fff;
  border-color: #e0e0e0
}
.datepicker {
  position: absolute;
  background: #fff;
  border: 2px solid #3498db;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  -webkit-box-shadow: 0 20px 25px rgba(0,0,0,.1);
  -moz-box-shadow: 0 20px 25px rgba(0,0,0,.1);
  box-shadow: 0 20px 25px rgba(0,0,0,.1);
  z-index: 1060;
  font-family: "Segoe UI",Arial,sans-serif;
  font-size: 14px;
  width: 280px;
  animation: .3s ease-out datepicker-fadeIn;
  transform-origin: top left
}
.datepicker-header {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: space-between;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
  padding: 12px;
  background: #3498db;
  color: #fff;
  -webkit-border-radius: 4px 4px 0 0;
  -moz-border-radius: 4px 4px 0 0;
  border-radius: 4px 4px 0 0
}
.datepicker-title {
  font-weight: 700;
  font-size: 16px;
  color: #fff
}
.datepicker-btn {
  width: 48px;
  background: rgba(255,255,255,.2);
  border: none;
  color: #fff;
  padding: 6px 12px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
  -webkit-transition: background .15s;
  -moz-transition: background .15s;
  -o-transition: background .15s;
  transition: background .15s
}
.datepicker-btn:hover {
  background: rgba(255,255,255,.3);
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.datepicker-btn:active {
  -webkit-transform: translateY(0);
  -ms-transform: translateY(0);
  transform: translateY(0);
  background: rgba(255,255,255,.4)
}
.datepicker-btn:focus {
  outline: rgba(255,255,255,.5) solid 2px;
  outline-offset: 2px
}
.datepicker-weekdays {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: wrap;
  -webkit-flex-wrap: wrap;
  flex-wrap: wrap;
  -ms-flex-pack: flex-start;
  -webkit-justify-content: flex-start;
  justify-content: flex-start;
  -ms-flex-align: stretch;
  -webkit-align-items: stretch;
  align-items: stretch;
  padding: 8px;
  background: #fafafa;
  border-bottom: 1px solid #e0e0e0
}
.datepicker-weekdays span {
  display: block;
  width: 14.28%;
  text-align: center;
  padding: 4px;
  font-size: 12px;
  font-weight: 700;
  color: #9e9e9e
}
.datepicker-days {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: wrap;
  -webkit-flex-wrap: wrap;
  flex-wrap: wrap;
  -ms-flex-pack: flex-start;
  -webkit-justify-content: flex-start;
  justify-content: flex-start;
  -ms-flex-align: stretch;
  -webkit-align-items: stretch;
  align-items: stretch;
  padding: 8px;
  background: #fff
}
.datepicker-day {
  width: 14.28%;
  text-align: center;
  padding: 8px 4px;
  cursor: pointer;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px;
  -webkit-transition: .15s;
  -moz-transition: .15s;
  -o-transition: .15s;
  transition: .15s;
  color: #424242;
  position: relative
}
.datepicker-day:hover {
  background: #e3f2fd;
  color: #3498db;
  -webkit-transform: scale(1.05);
  -ms-transform: scale(1.05);
  transform: scale(1.05)
}
.datepicker-day:active {
  -webkit-transform: scale(.95);
  -ms-transform: scale(.95);
  transform: scale(.95)
}
.datepicker-day.other-month {
  color: #9e9e9e
}
.datepicker-day.other-month:hover {
  color: #757575;
  background: #f5f5f5
}
.datepicker-day.disabled {
  color: #ccc!important;
  background-color: #f5f5f5!important;
  cursor: not-allowed!important
}
.datepicker-day.disabled:hover {
  background-color: #f5f5f5!important;
  color: #ccc!important;
  -webkit-transform: none!important;
  -ms-transform: none!important;
  transform: none!important
}
.datepicker-day.selected {
  background: #3498db;
  color: #fff;
  -webkit-box-shadow: 0 4px 6px rgba(0,0,0,.07);
  -moz-box-shadow: 0 4px 6px rgba(0,0,0,.07);
  box-shadow: 0 4px 6px rgba(0,0,0,.07);
  font-weight: 700
}
.datepicker-day.selected:hover {
  background: #2980b9;
  -webkit-transform: scale(1.05);
  -ms-transform: scale(1.05);
  transform: scale(1.05)
}
.datepicker-day.today {
  background: #f59e0b;
  color: #fff;
  font-weight: 700;
  -webkit-box-shadow: 0 1px 2px rgba(0,0,0,.05);
  -moz-box-shadow: 0 1px 2px rgba(0,0,0,.05);
  box-shadow: 0 1px 2px rgba(0,0,0,.05)
}
.datepicker-day.today:hover {
  background: #d97706;
  -webkit-transform: scale(1.05);
  -ms-transform: scale(1.05);
  transform: scale(1.05)
}
.datepicker-day.today.selected {
  background: #3498db
}
.datepicker-day.today.selected::after {
  content: "";
  position: absolute;
  bottom: 2px;
  left: 50%;
  transform: translateX(-50%);
  width: 4px;
  height: 4px;
  background: #f59e0b;
  -webkit-border-radius: 9999px;
  -moz-border-radius: 9999px;
  border-radius: 9999px
}
.datepicker-day:focus {
  outline: #3498db solid 2px;
  outline-offset: 2px;
  z-index: 1
}
.datepicker-footer {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: space-between;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
  padding: 8px 12px;
  border-top: 1px solid #e0e0e0;
  background: #fafafa;
  -webkit-border-radius: 0 0 4px 4px;
  -moz-border-radius: 0 0 4px 4px;
  border-radius: 0 0 4px 4px
}
.datepicker-footer .datepicker-btn {
  width: 48%;
  background: #9e9e9e;
  color: #fff;
  padding: 6px 16px;
  font-size: 12px
}
.datepicker-footer .datepicker-btn:hover {
  background: #757575;
  -webkit-box-shadow: 0 1px 2px rgba(0,0,0,.05);
  -moz-box-shadow: 0 1px 2px rgba(0,0,0,.05);
  box-shadow: 0 1px 2px rgba(0,0,0,.05)
}
.datepicker-footer .datepicker-btn:active {
  -webkit-transform: translateY(0);
  -ms-transform: translateY(0);
  transform: translateY(0);
  -webkit-box-shadow: none;
  -moz-box-shadow: none;
  box-shadow: none
}
.datepicker-footer .datepicker-btn#todayBtn {
  background: #3498db
}
.datepicker-footer .datepicker-btn#todayBtn:hover {
  background: #2980b9
}
.datepicker-footer .datepicker-btn#closeBtn {
  background: #9e9e9e
}
.datepicker-footer .datepicker-btn#closeBtn:hover {
  background: #757575
}
.datepicker-input {
  position: relative
}
.datepicker-input input {
  width: 100%;
  padding: 8px 30px 8px 8px;
  border: 2px solid #e0e0e0;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  font-size: 16px;
  box-sizing: border-box;
  -webkit-transition: border-color .3s;
  -moz-transition: border-color .3s;
  -o-transition: border-color .3s;
  transition: border-color .3s;
  background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEzIDJIMTVWMTRIMVYySDE1VjJINTNNMyA2SDE1TTUgMFY0TTExIDBWNCIgc3Ryb2tlPSIjNjY2IiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiLz4KPC9zdmc+");
  background-repeat: no-repeat;
  background-position: right 8px center;
  background-size: 16px 16px
}
.datepicker-input input:focus {
  border-color: #3498db;
  outline: 0;
  -webkit-box-shadow: 0 0 0 3px rgba(52,152,219,.25);
  -moz-box-shadow: 0 0 0 3px rgba(52,152,219,.25);
  box-shadow: 0 0 0 3px rgba(52,152,219,.25)
}
.datepicker-input input:hover {
  border-color: #bdbdbd
}
.datepicker-input input:disabled {
  background-color: #f5f5f5;
  color: #bdbdbd;
  border-color: #e0e0e0;
  cursor: not-allowed
}
.datepicker.loading .datepicker-days {
  position: relative
}
.datepicker.loading .datepicker-days::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(255,255,255,.8);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1
}
.datepicker.loading .datepicker-days::after {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  width: 20px;
  height: 20px;
  margin: -10px 0 0 -10px;
  border: 2px solid #e0e0e0;
  border-top: 2px solid #3498db;
  -webkit-border-radius: 9999px;
  -moz-border-radius: 9999px;
  border-radius: 9999px;
  animation: 1s linear infinite datepicker-spin;
  z-index: 2
}
@keyframes datepicker-spin {
  0% {
    transform: rotate(0)
  }
  100% {
    transform: rotate(360deg)
  }
}
@media screen and (max-width:480px) {
  .datepicker {
    width: 260px;
    font-size: 12px
  }
  .datepicker-header {
    padding: 8px 12px
  }
  .datepicker-btn {
    width: 40px;
    padding: 4px 8px;
    font-size: 12px
  }
  .datepicker-day {
    padding: 6px 2px;
    font-size: 12px
  }
  .datepicker-footer {
    padding: 6px 8px
  }
  .datepicker-footer .datepicker-btn {
    padding: 4px 12px;
    font-size: 12px
  }
}
@media screen and (max-height:600px) {
  .datepicker .datepicker-header {
    padding: 6px 12px
  }
  .datepicker .datepicker-day {
    padding: 4px 2px
  }
  .datepicker .datepicker-footer {
    padding: 4px 8px
  }
}
@media (prefers-color-scheme:dark) {
  .datepicker {
    background: #1e293b;
    border-color: #475569;
    color: #f5f5f5
  }
  .datepicker .datepicker-header {
    background: #334155;
    color: #f5f5f5
  }
  .datepicker .datepicker-weekdays {
    background: #334155;
    border-color: #475569
  }
  .datepicker .datepicker-weekdays span {
    color: #bdbdbd
  }
  .datepicker .datepicker-days {
    background: #1e293b
  }
  .datepicker .datepicker-day {
    color: #eee
  }
  .datepicker .datepicker-day:hover {
    background: #334155;
    color: #42a5f5
  }
  .datepicker .datepicker-day.other-month {
    color: #9e9e9e
  }
  .datepicker .datepicker-day.other-month:hover {
    color: #bdbdbd;
    background: #334155
  }
  .datepicker .datepicker-day.selected {
    background: #2980b9;
    color: #fff
  }
  .datepicker .datepicker-day.selected:hover {
    background: #3498db
  }
  .datepicker .datepicker-day.today {
    background: #d97706;
    color: #fff
  }
  .datepicker .datepicker-day.today:hover {
    background: #f59e0b
  }
  .datepicker .datepicker-footer {
    background: #334155;
    border-color: #475569
  }
  .datepicker .datepicker-footer .datepicker-btn:hover {
    background: #475569
  }
}
@keyframes datepicker-fadeIn {
  from {
    opacity: 0;
    -webkit-transform: scale(.95) translateY(-10px);
    -ms-transform: scale(.95) translateY(-10px);
    transform: scale(.95) translateY(-10px)
  }
  to {
    opacity: 1;
    -webkit-transform: scale(1) translateY(0);
    -ms-transform: scale(1) translateY(0);
    transform: scale(1) translateY(0)
  }
}
.datepicker.closing {
  animation: .15s ease-in datepicker-fadeOut
}
@keyframes datepicker-fadeOut {
  from {
    opacity: 1;
    -webkit-transform: scale(1) translateY(0);
    -ms-transform: scale(1) translateY(0);
    transform: scale(1) translateY(0)
  }
  to {
    opacity: 0;
    -webkit-transform: scale(.95) translateY(-10px);
    -ms-transform: scale(.95) translateY(-10px);
    transform: scale(.95) translateY(-10px)
  }
}
@media (prefers-contrast:high) {
  .datepicker {
    border-width: 3px
  }
  .datepicker .datepicker-day {
    border: 1px solid transparent
  }
  .datepicker .datepicker-day:focus {
    border-color: #424242;
    outline: 0
  }
  .datepicker .datepicker-day.selected {
    border-color: #fff
  }
}
@media (prefers-reduced-motion:reduce) {
  .datepicker {
    animation: none
  }
  .datepicker .datepicker-btn,
  .datepicker .datepicker-day {
    transition: none
  }
  .datepicker .datepicker-btn:hover,
  .datepicker .datepicker-day:hover {
    transform: none
  }
}
.workspace-container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: #f5f5f5;
  padding: 24px;
  box-sizing: border-box;
  overflow: auto;
  z-index: 1030
}
#verifiedDataMessage {
  display: none;
  text-align: center;
  padding: 64px;
  font-size: 18px;
  color: #2980b9;
  font-weight: 700
}
.journal-header {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: space-between;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
  margin-bottom: 24px;
  background: rgba(255,255,255,.95);
  padding: 15px 24px;
  -webkit-border-radius: 12px;
  -moz-border-radius: 12px;
  border-radius: 12px;
  -webkit-box-shadow: 0 10px 15px rgba(0,0,0,.1);
  -moz-box-shadow: 0 10px 15px rgba(0,0,0,.1);
  box-shadow: 0 10px 15px rgba(0,0,0,.1);
  position: relative
}
@media screen and (max-width:768px) {
  .journal-header {
    display: -ms-flexbox;
    display: -webkit-flex;
    display: flex;
    -ms-flex-direction: column;
    -webkit-flex-direction: column;
    flex-direction: column;
    -ms-flex-wrap: nowrap;
    -webkit-flex-wrap: nowrap;
    flex-wrap: nowrap;
    -ms-flex-pack: flex-start;
    -webkit-justify-content: flex-start;
    justify-content: flex-start;
    -ms-flex-align: stretch;
    -webkit-align-items: stretch;
    align-items: stretch;
    gap: 16px
  }
}
.journal-title {
  font-size: 24px;
  font-weight: 700;
  color: #334155;
  margin: 0;
  letter-spacing: 1px
}
@media screen and (max-width:480px) {
  .journal-title {
    font-size: 20px;
    text-align: center
  }
}
.journal-controls {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: wrap;
  -webkit-flex-wrap: wrap;
  flex-wrap: wrap;
  -ms-flex-pack: flex-end;
  -webkit-justify-content: flex-end;
  justify-content: flex-end;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center
}
@media screen and (max-width:768px) {
  .journal-controls {
    display: -ms-flexbox;
    display: -webkit-flex;
    display: flex;
    -ms-flex-direction: row;
    -webkit-flex-direction: row;
    flex-direction: row;
    -ms-flex-wrap: wrap;
    -webkit-flex-wrap: wrap;
    flex-wrap: wrap;
    -ms-flex-pack: center;
    -webkit-justify-content: center;
    justify-content: center;
    -ms-flex-align: center;
    -webkit-align-items: center;
    align-items: center;
    width: 100%
  }
}
.control-group {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: flex-start;
  -webkit-justify-content: flex-start;
  justify-content: flex-start;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
  margin-right: 15px;
  margin-bottom: 10px;
  font-weight: 600;
  color: #757575;
  white-space: nowrap
}
.control-group:last-child {
  margin-right: 0
}
.control-group label {
  margin-bottom: 0;
  margin-right: 8px;
  font-size: 14px;
  color: #757575
}
.journal-controls .control-input {
  padding: 0 4px;
  border: 2px solid #e0e0e0;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  box-sizing: border-box;
  -webkit-transition: border-color .3s;
  -moz-transition: border-color .3s;
  -o-transition: border-color .3s;
  transition: border-color .3s;
  width: 80px;
  height: 26px;
  font-size: 14px;
  vertical-align: middle
}
.journal-controls .control-input:hover {
  border-color: #bdbdbd
}
.journal-controls .control-input:disabled {
  background-color: #f5f5f5;
  color: #bdbdbd;
  border-color: #e0e0e0;
  cursor: not-allowed
}
.journal-controls .control-input:focus {
  outline: 0;
  border-color: #3498db;
  -webkit-box-shadow: 0 0 0 3px rgba(52,152,219,.25);
  -moz-box-shadow: 0 0 0 3px rgba(52,152,219,.25);
  box-shadow: 0 0 0 3px rgba(52,152,219,.25)
}
.journal-controls .control-input[type=date] {
  width: 108px
}
.journal-controls .control-input#brigadeInfo {
  width: 120px
}
.journal-controls .control-input#sampleSelection,
.journal-controls .control-input#shiftNumber {
  width: 48px
}
.journal-table-container {
  background: rgba(255,255,255,.95);
  -webkit-border-radius: 12px;
  -moz-border-radius: 12px;
  border-radius: 12px;
  -webkit-box-shadow: 0 10px 15px rgba(0,0,0,.1);
  -moz-box-shadow: 0 10px 15px rgba(0,0,0,.1);
  box-shadow: 0 10px 15px rgba(0,0,0,.1);
  padding: 24px;
  overflow-x: auto
}
@media screen and (max-width:768px) {
  .journal-table-container {
    padding: 16px;
    margin: 0 -16px;
    border-radius: 0
  }
}
.journal-table {
  border-collapse: collapse;
  margin-top: 16px;
  font-size: 12px;
  width: 91.5vw
}
.journal-table th {
  background: #334155;
  color: #fff;
  font-weight: 700;
  position: sticky;
  top: 0;
  z-index: 10;
  padding: 6px;
  text-align: center;
  vertical-align: middle;
  border: 1px solid #1f618d
}
.journal-table th[rowspan="2"] {
  vertical-align: middle
}
.journal-table td {
  padding: 2px 4px;
  border: 1px solid #e0e0e0;
  text-align: center;
  vertical-align: middle
}
.journal-table td.product-name {
  font-weight: 700;
  background-color: rgba(255,255,255,.95);
  text-align: center;
  vertical-align: middle
}
.journal-table td:hover {
  background-color: #e3f2fd
}
.journal-table tbody tr.product-group-1,
.journal-table tbody tr.product-group-3 {
  background-color: #f5f0e6
}
.journal-table tbody tr.product-group-2 {
  background-color: #fff8e1
}
.journal-table tfoot td {
  font-weight: 700
}
.journal-table tfoot .footer-title {
  text-align: right!important;
  padding: 8px;
  color: #fff;
  background-color: #64748b
}
.journal-table tfoot .footer-value {
  background-color: #cbd5e1;
  text-align: center;
  font-size: 14px
}
.table-input,
.table-select {
  width: 100%;
  border: 1px solid #e0e0e0;
  margin: 0;
  font-size: 14px;
  line-height: 14px;
  background: #fff;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px;
  box-sizing: border-box;
  -webkit-transition: .15s;
  -moz-transition: .15s;
  -o-transition: .15s;
  transition: .15s
}
.table-input:focus,
.table-select:focus {
  border-color: #3498db;
  outline: 0;
  background-color: #e3f2fd;
  -webkit-box-shadow: 0 0 0 3px rgba(52,152,219,.25);
  -moz-box-shadow: 0 0 0 3px rgba(52,152,219,.25);
  box-shadow: 0 0 0 3px rgba(52,152,219,.25)
}
.table-input:hover,
.table-select:hover {
  border-color: #2980b9
}
.table-input:disabled,
.table-select:disabled {
  background-color: #f5f5f5;
  color: #bdbdbd;
  border-color: #e0e0e0;
  cursor: not-allowed
}
.table-input.number,
.table-select.number {
  font-size: 14px;
  text-align: center
}
.table-input.text,
.table-select.text {
  font-size: 14px;
  text-align: left
}
.table-select {
  cursor: pointer;
  background-image: url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 4 5'%3E%3Cpath fill='%23666' d='M2 0L0 2h4zm0 5L0 3h4z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 6px center;
  background-size: 8px;
  padding-right: 8px
}
.table-select::-ms-expand {
  display: none
}
.table-select:hover {
  background-color: #e3f2fd
}
.table-text {
  padding: 0;
  margin: 0;
  color: #424242
}
.table-text.number {
  font-size: 14px;
  line-height: 14px;
  text-align: center;
  font-weight: 600
}
.col-table {
  width: 6.1vw;
  min-width: 64px
}
.journal-footer {
  margin-top: 24px;
  background: rgba(255,255,255,.95);
  padding: 15px 24px;
  -webkit-border-radius: 12px;
  -moz-border-radius: 12px;
  border-radius: 12px;
  -webkit-box-shadow: 0 10px 15px rgba(0,0,0,.1);
  -moz-box-shadow: 0 10px 15px rgba(0,0,0,.1);
  box-shadow: 0 10px 15px rgba(0,0,0,.1);
  text-align: center
}
@media screen and (max-width:768px) {
  .journal-footer {
    padding: 16px;
    margin: 24px -16px 0;
    border-radius: 0
  }
}
.journal-notes {
  font-size: 13px;
  color: #757575;
  line-height: 1.5;
  margin-bottom: 15px;
  text-align: left
}
.journal-notes strong {
  color: #424242;
  font-weight: 700
}
.save-btn {
  border: none;
  padding: 12px 36px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 600;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  background: -ms-linear-gradient(top,#3498db,#2980b9);
  background: -webkit-linear-gradient(135deg,#3498db,#2980b9);
  background: linear-gradient(135deg,#3498db,#2980b9);
  color: #fff;
  width: auto;
  font-size: 16px
}
.save-btn:focus,
.save-btn:hover {
  background: -ms-linear-gradient(top,#2980b9,#1f618d);
  background: -webkit-linear-gradient(135deg,#2980b9,#1f618d);
  background: linear-gradient(135deg,#2980b9,#1f618d);
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
@media screen and (max-width:480px) {
  .save-btn {
    width: 100%
  }
}
.save-btn:hover {
  -webkit-box-shadow: 0 4px 6px rgba(0,0,0,.07);
  -moz-box-shadow: 0 4px 6px rgba(0,0,0,.07);
  box-shadow: 0 4px 6px rgba(0,0,0,.07);
  -webkit-transform: translateY(-1px);
  -ms-transform: translateY(-1px);
  transform: translateY(-1px)
}
.save-btn:active {
  -webkit-transform: translateY(0);
  -ms-transform: translateY(0);
  transform: translateY(0);
  -webkit-box-shadow: 0 1px 2px rgba(0,0,0,.05);
  -moz-box-shadow: 0 1px 2px rgba(0,0,0,.05);
  box-shadow: 0 1px 2px rgba(0,0,0,.05)
}
@media screen and (max-width:768px) {
  .workspace-container {
    padding: 16px
  }
  .journal-table {
    font-size: 11px
  }
  .journal-table td,
  .journal-table th {
    padding: 4px
  }
  .table-input,
  .table-select {
    padding: 2px;
    font-size: 11px
  }
}
@media print {
  .workspace-container {
    position: static;
    width: auto;
    height: auto;
    background: #fff;
    padding: 0
  }
  .journal-footer,
  .journal-header {
    background: #fff;
    box-shadow: none;
    border: 1px solid #424242
  }
  .back-button,
  .save-btn {
    display: none
  }
  .journal-table {
    font-size: 10px
  }
  .journal-table td,
  .journal-table th {
    border: 1px solid #424242;
    padding: 4px 2px
  }
  .journal-table th {
    background: #f5f5f5;
    color: #424242
  }
  .table-input,
  .table-select {
    border: none;
    background: 0 0;
    padding: 0
  }
}
.product-name-container {
  position: relative;
  width: 100%;
  height: 100%;
  display: block;
  padding-right: 20px;
  line-height: 1.2
}
.product-toggle-btn {
  position: absolute;
  top: 0;
  right: 0;
  width: 18px;
  height: 18px;
  background: #3498db;
  color: #fff;
  border: 1px solid #2980b9;
  -webkit-border-radius: 2px;
  -moz-border-radius: 2px;
  border-radius: 2px;
  font-size: 12px;
  font-weight: 700;
  line-height: 1;
  text-align: center;
  cursor: pointer;
  padding: 0;
  margin: 0;
  z-index: 2;
  -webkit-transition: .15s;
  -moz-transition: .15s;
  -o-transition: .15s;
  transition: .15s
}
.product-toggle-btn:focus {
  outline: 0
}
.product-toggle-btn:hover {
  background: #2980b9;
  border-color: #1f618d;
  -webkit-transform: scale(1.1);
  -ms-transform: scale(1.1);
  transform: scale(1.1);
  -webkit-box-shadow: 0 1px 2px rgba(0,0,0,.05);
  -moz-box-shadow: 0 1px 2px rgba(0,0,0,.05);
  box-shadow: 0 1px 2px rgba(0,0,0,.05)
}
.product-toggle-btn:active {
  -webkit-transform: scale(.95);
  -ms-transform: scale(.95);
  transform: scale(.95);
  -webkit-box-shadow: none;
  -moz-box-shadow: none;
  box-shadow: none
}
.product-toggle-btn.inactive {
  background: #9e9e9e;
  border-color: #757575;
  color: #fff
}
.product-toggle-btn.inactive:hover {
  background: #757575;
  border-color: #9e9e9e
}
.product-row {
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s
}
.product-row.inactive {
  background-color: #f5f5f5!important;
  color: #bdbdbd;
  opacity: .6
}
.product-row.inactive .table-input,
.product-row.inactive .table-select {
  background-color: #f5f5f5!important;
  color: #bdbdbd!important;
  border-color: #e0e0e0!important;
  cursor: not-allowed!important
}
.product-row.inactive .table-input:focus,
.product-row.inactive .table-input:hover,
.product-row.inactive .table-select:focus,
.product-row.inactive .table-select:hover {
  background-color: #f5f5f5!important;
  border-color: #e0e0e0!important;
  -webkit-box-shadow: none!important;
  -moz-box-shadow: none!important;
  box-shadow: none!important
}
.product-row.inactive .table-text {
  color: #bdbdbd!important
}
.product-row.inactive:hover {
  background-color: #ededed!important
}
@media screen and (max-width:480px) {
  .product-name-container {
    font-size: 12px;
    padding-right: 18px
  }
  .product-toggle-btn {
    width: 14px;
    height: 14px;
    font-size: 9px;
    top: 1px;
    right: 1px
  }
}
@media print {
  .product-row.inactive,
  .product-toggle-btn {
    display: none!important
  }
}
.journal-table td .moisture-single {
  position: absolute;
  font-size: 12px;
  color: #757575;
  font-weight: 400;
  z-index: 1
}
.journal-table td .moisture-1 {
  top: 12px;
  left: 4px
}
.journal-table td .moisture-2 {
  bottom: 12px;
  left: 4px
}
#moistureJournal .journal-info-bar {
  width: 100%;
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: flex-end;
  -webkit-justify-content: flex-end;
  justify-content: flex-end;
  -ms-flex-align: flex-start;
  -webkit-align-items: flex-start;
  align-items: flex-start;
  padding: 0 24px 16px;
  margin: 0 auto;
  color: #757575
}
#moistureJournal .journal-info-bar strong {
  color: #424242
}
#moistureJournal .journal-info-bar__item {
  font-size: 14px
}
#moistureJournal .journal-info-bar__brigade {
  margin-right: 24px
}
#moistureJournal .moisture-table td,
#moistureJournal .moisture-table th {
  text-align: center;
  vertical-align: middle;
  padding: 8px
}
#moistureJournal .moisture-table tbody tr {
  font-size: 14px
}
#moistureJournal .moisture-table tbody tr:hover {
  background-color: #e3f2fd
}
#moistureJournal .moisture-table tbody tr.product-group-1,
#moistureJournal .moisture-table tbody tr.product-group-3 {
  background-color: #f5f0e6
}
#moistureJournal .moisture-table tbody tr.product-group-2 {
  background-color: #fff8e1
}
.qc-section {
  margin-bottom: 32px
}
.qc-section:last-child {
  margin-bottom: 0
}
.qc-section-title {
  font-size: 20px;
  color: #334155;
  margin-bottom: 16px;
  padding-bottom: 8px;
  border-bottom: 2px solid #eee
}
.qc-table tbody td {
  vertical-align: middle;
  text-align: center;
  font-size: 14px
}
.qc-table tbody td:first-child {
  text-align: left;
  font-weight: 600
}
#qualityControlJournal .journal-info-bar {
  width: 100%;
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: flex-end;
  -webkit-justify-content: flex-end;
  justify-content: flex-end;
  -ms-flex-align: flex-start;
  -webkit-align-items: flex-start;
  align-items: flex-start;
  padding: 0 24px 16px;
  margin: 0 auto;
  color: #757575
}
#qualityControlJournal .journal-info-bar strong {
  color: #424242
}
#qualityControlJournal .journal-info-bar__item {
  font-size: 14px
}
#qualityControlJournal .journal-info-bar__brigade {
  margin-right: 24px
}
.consolidated-table thead th {
  text-align: center;
  vertical-align: middle
}
.consolidated-table tbody td {
  text-align: center;
  vertical-align: middle;
  font-size: 14px
}
#consolidatedJournal .journal-header {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: flex-start;
  -webkit-justify-content: flex-start;
  justify-content: flex-start;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center
}
#consolidatedJournal .journal-header .journal-title {
  flex-grow: 1;
  text-align: center;
  padding-right: 52px
}
#consolidatedJournal .journal-controls {
  display: -ms-flexbox;
  display: -webkit-flex;
  display: flex;
  -ms-flex-direction: row;
  -webkit-flex-direction: row;
  flex-direction: row;
  -ms-flex-wrap: nowrap;
  -webkit-flex-wrap: nowrap;
  flex-wrap: nowrap;
  -ms-flex-pack: space-between;
  -webkit-justify-content: space-between;
  justify-content: space-between;
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
  gap: 12px;
  width: 360px
}
#consolidatedJournal .month-display {
  font-size: 18px;
  font-weight: 600;
  color: #334155;
  min-width: 180px;
  text-align: center
}
#consolidatedJournal .pagination-btn {
  border: 1px solid #e0e0e0;
  padding: 0;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 600;
  -webkit-transition: .3s;
  -moz-transition: .3s;
  -o-transition: .3s;
  transition: .3s;
  width: 40px;
  height: 40px;
  font-size: 20px;
  line-height: 1;
  background: #f5f5f5;
  color: #334155
}
#consolidatedJournal .pagination-btn:hover {
  background: #eee;
  border-color: #bdbdbd;
  -webkit-transform: translateY(0);
  -ms-transform: translateY(0);
  transform: translateY(0)
}
#xorKeyDisplay {
  display: none;
  margin-top: 24px
}
#xorKeyDisplay button,
#xorKeyDisplay textarea {
  margin-top: 10px
}
#usersList p {
  text-align: center;
  color: #9e9e9e;
  font-style: italic
}
.security-info br {
  line-height: 1.8
}
.logo {
  margin: 0 auto 24px;
  display: block
}
@media screen and (max-width:480px) {
  .containerForm {
    width: 95%;
    padding: 24px
  }
  .wrapper {
    padding: 8px
  }
}
@media print {
  body {
    background: #fff!important;
    color: #000!important
  }
  .containerForm {
    box-shadow: none!important;
    border: 1px solid #000
  }
  button {
    display: none!important
  }
}

</style>
</head>
<body id="body" onload="VBScript:Window_OnLoad()">
    <div class="wrapper">
        <div class="promo-box">
  <img
    src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzc0IiBoZWlnaHQ9IjMyMyIgdmlld0JveD0iMCAwIDM3NCAzMjMiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGQ9Ik0yNDggMTYyQzI0OCAxNjIgMjQ3Ljg3IDI2OS41NjMgMjQ4LjI3MyAzMTguMDE1QzI0OC4zMDMgMzIxLjU5NCAyNDYuOTU3IDMyMi41OTIgMjQzLjU5IDMyMi41ODVDMjAyLjYwMyAzMjIuNDk1IDE2MS42MTYgMzIyLjQ3NSAxMjAuNjMgMzIyLjUzNUMxMTcuMzg1IDMyMi41NCAxMTYuMjU4IDMyMS41MzEgMTE2LjM0NiAzMTguMjJDMTE2LjU1OCAzMTAuMjI4IDExNi40NjQgMzAyLjIyNyAxMTYuNDE2IDI5NC4yM0MxMTYuMTg2IDI1NS43NjIgMTE1Ljk3NiAyMTcuMjk0IDExNS41NzIgMTc4LjgyOEMxMTUuNTQ2IDE3Ni4zOSAxMTQuMzg3IDE3My42NjggMTEyLjk5NiAxNzEuNTg1Qzk3LjI5OTEgMTQ4LjA5MSAxNS40NTM4IDI0LjY5NjkgMCAxQzQuNjY4NzkgNi4zNjEzOSA3NC45ODYgMTExLjk5OSA3OS4zNTE4IDExNy45ODRDODYuMjU3MiAxMjguNDg0IDkzLjE3MTkgMTM4LjU5NyA5OS45NTM1IDE0OC43OThDMTA1LjkwOCAxNTcuNzU1IDExMS42NDYgMTY2LjY0MyAxMTcuNSAxNzZDMTE3LjUgMTc2IDE4MCAxMDkuNSAxODQgMTA3QzE4My43NDMgMTEwLjcyOSAxODMgMjQ2LjUgMTgzIDI0Ni41QzE4MyAyNDYuNSAxMjguMTU2IDMwOS43NzIgMTI2LjAzMiAzMTEuODE0QzEyMy40MjUgMzE0LjYyMSAxMjEuMTM5IDMxNy40MTYgMTE4LjUgMzIwLjVDMTE5Ljg2NyAzMjAuNjQ3IDEyMC40OSAzMjAuNjYxIDEyMS4xMjEgMzIwLjY2MUMxNDMuMzg3IDMyMC42NDkgMTg3LjkxOCAzMjAuNTcxIDE4Ny45MTggMzIwLjU3MUwyMDEuNzggMzIwLjQ3N0MyMDMuOTE2IDMyMC41MzkgMjA1LjYyOSAzMjAuNTM1IDIwNy43NjggMzIwLjU3MUMyMDkuOTA1IDMyMC41OTQgMjExLjYxNiAzMjAuNTc1IDIxMy43MjggMzIwLjYwMUMyMTUuMjAxIDMyMC42MTEgMjE2LjI3MyAzMjAuNTc2IDIxNy43OTIgMzIwLjU4NkMyMjAuOTQgMzIwLjU5MyAyMjMuNjQxIDMyMC41NTYgMjI2LjgwNyAzMjAuNTcyQzIzMi4yNTcgMzIwLjYzNiAyMzcuMjQ1IDMyMC41NjIgMjQyLjIyOCAzMjAuNjg3QzI0NS4xNDEgMzIwLjc2MSAyNDYuNDc5IDMxOS43MjkgMjQ2LjQ1MSAzMTYuNjU0QzI0Ni4xNDMgMjgzLjU5IDI0NS45MDQgMjUwLjUyNiAyNDUuNzMyIDIxNy4wNjhDMjQ1LjgyMiAyMTcuMTM0IDI0NS44MDEgMjE1LjA3NSAyNDUuNzMyIDIxNy4wNjhMMjQ2IDE2NUwyNDggMTYyWiIgZmlsbD0iIzc5QTdCRCIvPgo8cGF0aCBkPSJNMTgzIDI0Ni41QzE4Mi45ODMgMjM1Ljg1NyAxODIuOTQxIDIyNi4zMjYgMTgyLjk1NSAyMTUuNjgzQzE4Mi45NzYgMjAwLjM4MyAxODIuOTQ3IDE4NS4wODMgMTgzLjA0MSAxNjkuNzg0TDE4NCAxMDdMMjU4LjUgMi41TDMxOS41IDcwTDE4MyAyNDYuNVoiIGZpbGw9IiNCOUYwRjciLz4KPHBhdGggZD0iTTExMS4yNzQgMy4wMDAwN0MxMTIgMyAxMjEgMTYgMTIxIDE2QzEzOS43NDIgNDIuNjUwMyAxNjUuMzQ0IDgwLjI4OTEgMTg0IDEwN0MxODMuNDk5IDEwNy4zOTUgMTgzLjQ5OSAxMDcuNjg0IDE4MyAxMDcuNUMxODAuNjEgMTA0LjczNCAxNzguODYxIDEwMS43MzcgMTc3IDk5QzE3MS43MDMgOTEuMjA4NCAxNjUuOTk1IDgzLjExNDggMTYwLjU4NiA3NS40MDQyQzE1MC45MTYgNjEuNjIwMiAxNDAuOTk5IDQ4LjAwOSAxMzEuMTg4IDM0LjMyMzhDMTI4LjAzOSAyOS45MzE4IDEyNC44OTggMjUuNTM0MSAxMjEuNzAzIDIwLjc3NDVDMTE4LjgzOCAxNi40MjA4IDExNi4zNTMgMTIuMzQ0OCAxMTMuNSA4QzExMi43MTkgNi4xODkzOSAxMTEuNjUgNC41NDY3NSAxMTEgM0wxMTEuMjc0IDMuMDAwMDdaIiBmaWxsPSIjQjlGMEY3Ii8+CjxwYXRoIGQ9Ik0zMTkuNSA3MEMzMTkuNSA3MCAzNzAuMjc4IDMuNTkwNTMgMzcxIDEuNUMzNjYuOTcgMC45MTg4NjEgMjYzLjk5IDIuNDQ1MDggMjYwIDEuNUMyNjQuNzU3IDEuMTE1MSAzNjcuNDMzIDAgMzc0IDBDMzcxLjY0NSAzLjM4MDE3IDMxOS41IDcwIDMxOS41IDcwWiIgZmlsbD0iIzc5QTdCRCIvPgo8cGF0aCBkPSJNMTIwLjUgMzIwLjk5NUMxMTguNSAzMjEgMTE4IDMyMSAxMTggMzIwLjVMMjQ4IDE2Mi41QzI0OCAxNjIuNSAyNDcgMzE2LjUgMjQ2LjUgMzE4LjVDMjQ1LjQ0MyAzMjIuNzI3IDIzNy42NDcgMzIxLjA5OSAyMTkuMDc4IDMyMC45OTVDMTg3LjMwOSAzMjAuODE3IDE1NS4yNDYgMzIxLjA4NiAxMjAuNSAzMjAuOTk1WiIgZmlsbD0iIzIwNjQ4OSIvPgo8cGF0aCBkPSJNMzczIDAuNUwzMTkgNjkuNUwyNTguNSAyLjVMMjU5LjUgMUwzNzMgMC41WiIgZmlsbD0iIzVDQ0FERiIvPgo8cGF0aCBkPSJNMTg0IDEwOEwxMTcuNSAxNzZMMCAxSDExMC41TDE4NCAxMDhaIiBmaWxsPSIjNTU4NjlDIi8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMTgyLjYgMTExLjhWMjYyLjg0NEMxODIuNiAyNzcuNzc3IDE4MyAyODUgMTc4LjUgMjkxQzE3NCAyOTggMTY2IDMwMCAxNTIuNSAzMDFDMTQ4LjUgMzAxLjI5NiAxNDEuMzY3IDMwMS4zMzMgMTM1LjUgMzAwTDEzMiAzMDRDMTM3LjUgMzA1IDE0Ni4wMTIgMzA2LjQ5OSAxNTMuNSAzMDZDMTY4LjUgMzA1IDE3OC4yIDMwMyAxODIuNiAyOTQuNUMxODcgMjg2IDE4Ny41IDI4MS41IDE4OCAyNjNMMTg4LjIgMTA3LjRMMTcwLjIgMTA2LjJDMTQxLjkzMyAxMDQuNiAxMTcuOTMzIDk5LjI2NjYgOTguMiA5MC4xOTk5Qzg3LjUzMzMgODUuMTMzMyA3OS4xMzMzIDc4LjE5OTkgNzMgNjkuMzk5OUM2Ni44NjY3IDYwLjMzMzIgNjMuOCA0OS42NjY2IDYzLjggMzcuMzk5OUw1OSAzNy43OTk5QzU5IDU5LjEzMzMgNjcgNzUuNTMzMiA4MyA4Ni45OTk5Qzk5IDk4LjE5OTkgMTE5LjggMTA1LjQgMTQ1LjQgMTA4LjZMMTU0LjYgMTA4LjJWMTA5QzE0OC43MzMgMTA5LjggMTQ1LjY2NyAxMTAuMiAxNDUuNCAxMTAuMkMxMzYuNiAxMTIuNiAxMjkuNCAxMTcuNCAxMjMuOCAxMjQuNkMxMTguMiAxMzEuOCAxMTUuNCAxMzkuNCAxMTUuNCAxNDcuNEMxMTUuNCAxNTUuMTMzIDExOS4wNjcgMTY3LjggMTIyIDE3MUwxMjQuNzY5IDE2OC4xQzEyMy4xNjkgMTY0LjM2NyAxMjAuNiAxNTMuMjY3IDEyMC42IDE0OC4yQzEyMC42IDEzNS42NjcgMTI1LjEzMyAxMjYuMzMzIDEzNC4yIDEyMC4yQzE0My4yNjcgMTE0LjA2NyAxNTQuMiAxMTEgMTY3IDExMUgxNzAuMkwxODIuNiAxMTEuOFoiIGZpbGw9IiNCOUYwRjciLz4KPHBhdGggZD0iTTIwOC4yODYgMzA0QzIwNC42OTMgMzA0IDIwMS44ODMgMzAzLjA1MyAxOTkuODU4IDMwMS4xNThDMTk3Ljg5OCAyOTkuMjYzIDE5Ni45MTggMjk2LjYxNyAxOTYuOTE4IDI5My4yMlYyMzcuNTU2QzE5Ni45MTggMjM1LjQ2NSAxOTcuNzY3IDIzNC40MiAxOTkuNDY2IDIzNC40MkMyMDEuMjMgMjM0LjQyIDIwMi4xMTIgMjM1LjQ2NSAyMDIuMTEyIDIzNy41NTZWMjkzLjUxNEMyMDIuMTEyIDI5NS4yNzggMjAyLjYwMiAyOTYuNzE1IDIwMy41ODIgMjk3LjgyNkMyMDQuNjI3IDI5OC44NzEgMjA1Ljk5OSAyOTkuMzk0IDIwNy42OTggMjk5LjM5NEgyNDAuODIyQzI0MS44NjcgMjk5LjM5NCAyNDIuNjE5IDI5OS41OSAyNDMuMDc2IDI5OS45ODJDMjQzLjUzMyAzMDAuMzA5IDI0My43NjIgMzAwLjg5NyAyNDMuNzYyIDMwMS43NDZDMjQzLjc2MiAzMDMuMjQ5IDI0Mi43ODIgMzA0IDI0MC44MjIgMzA0SDIwOC4yODZaIiBmaWxsPSIjQjlGMEY3Ii8+Cjwvc3ZnPgo="
    alt="YavirLab Logo"
    class="logo__icon"
    width="400"
    height="200"
  />
  <img
    src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTkwIiBoZWlnaHQ9IjExNCIgdmlld0JveD0iMCAwIDU5MCAxMTQiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGQ9Ik00MC4xIDExMlY3Mi4xTDAuMDUgMi41SDIzLjZMNTAuOSA1My42NUg1MS4yTDc4LjM1IDIuNUgxMDIuMDVMNjIgNzIuMVYxMTJINDAuMVpNMTA4LjA4NiAxMTMuNUMxMDAuMzg2IDExMy41IDk0LjI4NjMgMTExLjM1IDg5Ljc4NjMgMTA3LjA1Qzg1LjM4NjMgMTAyLjc1IDgzLjE4NjMgOTcgODMuMTg2MyA4OS44QzgzLjE4NjMgODAuOCA4Ni42ODYzIDczLjg1IDkzLjY4NjMgNjguOTVDMTAwLjc4NiA2NC4wNSAxMTAuODM2IDYxLjYgMTIzLjgzNiA2MS42SDEzNC4xODZDMTM0LjE4NiA1Ni44IDEzMi45MzYgNTMuNCAxMzAuNDM2IDUxLjRDMTI3LjkzNiA0OS40IDEyMy42MzYgNDguNCAxMTcuNTM2IDQ4LjRDMTEyLjYzNiA0OC40IDEwNy44MzYgNDkgMTAzLjEzNiA1MC4yQzk4LjUzNjMgNTEuNCA5My44MzYzIDUzLjMgODkuMDM2MyA1NS45TDg2LjYzNjMgMzkuN0M5MS42MzYzIDM3LjIgOTYuODM2MyAzNS40IDEwMi4yMzYgMzQuM0MxMDcuNzM2IDMzLjEgMTEzLjczNiAzMi41IDEyMC4yMzYgMzIuNUMxMjguNTM2IDMyLjUgMTM1LjE4NiAzMy41IDE0MC4xODYgMzUuNUMxNDUuMjg2IDM3LjUgMTQ4Ljk4NiA0MC43NSAxNTEuMjg2IDQ1LjI1QzE1My41ODYgNDkuNjUgMTU0LjczNiA1NS41IDE1NC43MzYgNjIuOFYxMTJIMTM1LjA4NkwxMzQuOTM2IDEwM0gxMzQuNjM2QzEzMS44MzYgMTA2LjIgMTI3Ljk4NiAxMDguNzUgMTIzLjA4NiAxMTAuNjVDMTE4LjE4NiAxMTIuNTUgMTEzLjE4NiAxMTMuNSAxMDguMDg2IDExMy41Wk0xMTUuNTg2IDk3LjlDMTE5LjA4NiA5Ny45IDEyMi4yMzYgOTcuMyAxMjUuMDM2IDk2LjFDMTI3LjgzNiA5NC45IDEzMC4wMzYgOTMuMjUgMTMxLjYzNiA5MS4xNUMxMzMuMzM2IDg4Ljk1IDEzNC4xODYgODYuNTUgMTM0LjE4NiA4My45NVY3NS4xSDEyNi44MzZDMTE4LjczNiA3NS4xIDExMi42ODYgNzYuMTUgMTA4LjY4NiA3OC4yNUMxMDQuNjg2IDgwLjI1IDEwMi42ODYgODMuNCAxMDIuNjg2IDg3LjdDMTAyLjY4NiA5MC45IDEwMy43ODYgOTMuNCAxMDUuOTg2IDk1LjJDMTA4LjI4NiA5NyAxMTEuNDg2IDk3LjkgMTE1LjU4NiA5Ny45Wk0xODIuMTYxIDExMkwxNTYuMzYxIDM0SDE3OC4yNjFMMTk2LjU2MSA5OC4ySDE5Ni44NjFMMjE1LjAxMSAzNEgyMzYuOTExTDIxMS4xMTEgMTEySDE4Mi4xNjFaTTI0NS41NzggMTEyVjM1LjVIMjY2LjU3OFYxMTJIMjQ1LjU3OFpNMjU2LjA3OCAyNC44NUMyNTIuMTc4IDI0Ljg1IDI0OS4wNzggMjMuOCAyNDYuNzc4IDIxLjdDMjQ0LjQ3OCAxOS41IDI0My4zMjggMTYuNSAyNDMuMzI4IDEyLjdDMjQzLjMyOCA4Ljg5OTk5IDI0NC40NzggNS45NDk5OSAyNDYuNzc4IDMuODVDMjQ5LjA3OCAxLjY1IDI1Mi4xNzggMC41NDk5OTUgMjU2LjA3OCAwLjU0OTk5NUMyNTkuOTc4IDAuNTQ5OTk1IDI2My4wNzggMS42NSAyNjUuMzc4IDMuODVDMjY3LjY3OCA1Ljk0OTk5IDI2OC44MjggOC44OTk5OSAyNjguODI4IDEyLjdDMjY4LjgyOCAxNi41IDI2Ny42NzggMTkuNSAyNjUuMzc4IDIxLjdDMjYzLjA3OCAyMy44IDI1OS45NzggMjQuODUgMjU2LjA3OCAyNC44NVpNMjg0LjYxOCAxMTJWMzRIMzA0LjQxOEwzMDQuNTY4IDQ4LjU1SDMwNS4wMThDMzA3LjYxOCA0NS4wNSAzMTAuNjY4IDQyLjE1IDMxNC4xNjggMzkuODVDMzE3Ljc2OCAzNy40NSAzMjEuNjY4IDM1LjY1IDMyNS44NjggMzQuNDVDMzMwLjE2OCAzMy4xNSAzMzQuNTY4IDMyLjUgMzM5LjA2OCAzMi41VjUwLjA1QzMzMi44NjggNTAuMDUgMzI3LjIxOCA1MS4yIDMyMi4xMTggNTMuNUMzMTcuMDE4IDU1LjggMzEyLjk2OCA1OC45NSAzMDkuOTY4IDYyLjk1QzMwNi45NjggNjYuODUgMzA1LjQ2OCA3MS4yIDMwNS40NjggNzZWMTEySDI4NC42MThaTTM0Ny40OTMgMTEyVjIuNUgzNjguOTQzVjkzLjU1SDQyNS45NDNWMTEySDM0Ny40OTNaTTQ1MS45MTQgMTEzLjVDNDQ0LjIxNCAxMTMuNSA0MzguMTE0IDExMS4zNSA0MzMuNjE0IDEwNy4wNUM0MjkuMjE0IDEwMi43NSA0MjcuMDE0IDk3IDQyNy4wMTQgODkuOEM0MjcuMDE0IDgwLjggNDMwLjUxNCA3My44NSA0MzcuNTE0IDY4Ljk1QzQ0NC42MTQgNjQuMDUgNDU0LjY2NCA2MS42IDQ2Ny42NjQgNjEuNkg0NzguMDE0QzQ3OC4wMTQgNTYuOCA0NzYuNzY0IDUzLjQgNDc0LjI2NCA1MS40QzQ3MS43NjQgNDkuNCA0NjcuNDY0IDQ4LjQgNDYxLjM2NCA0OC40QzQ1Ni40NjQgNDguNCA0NTEuNjY0IDQ5IDQ0Ni45NjQgNTAuMkM0NDIuMzY0IDUxLjQgNDM3LjY2NCA1My4zIDQzMi44NjQgNTUuOUw0MzAuNDY0IDM5LjdDNDM1LjQ2NCAzNy4yIDQ0MC42NjQgMzUuNCA0NDYuMDY0IDM0LjNDNDUxLjU2NCAzMy4xIDQ1Ny41NjQgMzIuNSA0NjQuMDY0IDMyLjVDNDcyLjM2NCAzMi41IDQ3OS4wMTQgMzMuNSA0ODQuMDE0IDM1LjVDNDg5LjExNCAzNy41IDQ5Mi44MTQgNDAuNzUgNDk1LjExNCA0NS4yNUM0OTcuNDE0IDQ5LjY1IDQ5OC41NjQgNTUuNSA0OTguNTY0IDYyLjhWMTEySDQ3OC45MTRMNDc4Ljc2NCAxMDNINDc4LjQ2NEM0NzUuNjY0IDEwNi4yIDQ3MS44MTQgMTA4Ljc1IDQ2Ni45MTQgMTEwLjY1QzQ2Mi4wMTQgMTEyLjU1IDQ1Ny4wMTQgMTEzLjUgNDUxLjkxNCAxMTMuNVpNNDU5LjQxNCA5Ny45QzQ2Mi45MTQgOTcuOSA0NjYuMDY0IDk3LjMgNDY4Ljg2NCA5Ni4xQzQ3MS42NjQgOTQuOSA0NzMuODY0IDkzLjI1IDQ3NS40NjQgOTEuMTVDNDc3LjE2NCA4OC45NSA0NzguMDE0IDg2LjU1IDQ3OC4wMTQgODMuOTVWNzUuMUg0NzAuNjY0QzQ2Mi41NjQgNzUuMSA0NTYuNTE0IDc2LjE1IDQ1Mi41MTQgNzguMjVDNDQ4LjUxNCA4MC4yNSA0NDYuNTE0IDgzLjQgNDQ2LjUxNCA4Ny43QzQ0Ni41MTQgOTAuOSA0NDcuNjE0IDkzLjQgNDQ5LjgxNCA5NS4yQzQ1Mi4xMTQgOTcgNDU1LjMxNCA5Ny45IDQ1OS40MTQgOTcuOVpNNTU2LjY5NiAxMTMuNUM1NTEuNTk2IDExMy41IDU0Ni44OTYgMTEyLjYgNTQyLjU5NiAxMTAuOEM1MzguMjk2IDEwOSA1MzQuNTQ2IDEwNi4zNSA1MzEuMzQ2IDEwMi44NUg1MzEuMDQ2TDUzMC44OTYgMTEySDUxMS4yNDZWMi41SDUzMS45NDZWNDMuMTVINTMyLjI0NkM1MzUuMjQ2IDM5LjU1IDUzOC43OTYgMzYuOSA1NDIuODk2IDM1LjJDNTQ3LjA5NiAzMy40IDU1MS42OTYgMzIuNSA1NTYuNjk2IDMyLjVDNTY2Ljk5NiAzMi41IDU3NC45OTYgMzYuMDUgNTgwLjY5NiA0My4xNUM1ODYuMzk2IDUwLjI1IDU4OS4yNDYgNjAuMiA1ODkuMjQ2IDczQzU4OS4yNDYgODUuOCA1ODYuMzk2IDk1Ljc1IDU4MC42OTYgMTAyLjg1QzU3NC45OTYgMTA5Ljk1IDU2Ni45OTYgMTEzLjUgNTU2LjY5NiAxMTMuNVpNNTUwLjU0NiA5N0M1NTYuNTQ2IDk3IDU2MS4xNDYgOTQuOTUgNTY0LjM0NiA5MC44NUM1NjcuNTQ2IDg2LjY1IDU2OS4xNDYgODAuNyA1NjkuMTQ2IDczQzU2OS4xNDYgNjUuMyA1NjcuNTQ2IDU5LjQgNTY0LjM0NiA1NS4zQzU2MS4xNDYgNTEuMSA1NTYuNTQ2IDQ5IDU1MC41NDYgNDlDNTQ3LjA0NiA0OSA1NDMuODQ2IDQ5Ljc1IDU0MC45NDYgNTEuMjVDNTM4LjE0NiA1Mi43NSA1MzUuOTQ2IDU0LjggNTM0LjM0NiA1Ny40QzUzMi43NDYgNTkuOSA1MzEuOTQ2IDYyLjggNTMxLjk0NiA2Ni4xVjc5LjlDNTMxLjk0NiA4My4yIDUzMi43NDYgODYuMTUgNTM0LjM0NiA4OC43NUM1MzUuOTQ2IDkxLjI1IDUzOC4xNDYgOTMuMjUgNTQwLjk0NiA5NC43NUM1NDMuODQ2IDk2LjI1IDU0Ny4wNDYgOTcgNTUwLjU0NiA5N1oiIGZpbGw9IiMyMDY0ODkiLz4KPC9zdmc+Cg=="
    alt="YavirLab Logo Text"
    class="logo__text"
    width="400"
    height="200"
  />
</div>


        <!-- Форма налаштування адміністратора -->
<div id="adminSetupForm" class="containerForm">
  <h1>⚙️ Налаштування адміністратора</h1>
  <p>База даних порожня. Створіть обліковий запис адміністратора:</p>
  <div class="form-group">
    <label for="adminPassword">Пароль адміністратора:</label>
    <input type="password" id="adminPassword" autocomplete="off" />
  </div>
  <div class="form-group">
    <label for="adminXORKey">Головний XOR ключ:</label>
    <input type="text" id="adminXORKey" autocomplete="off" />
  </div>
  <button onclick="registerAdmin()">Створити адміністратора</button>
  <div class="security-info">
    <strong>Важливо:</strong><br />
    • Пароль: мінімум 8 символів<br />
    • XOR ключ: мінімум 16 символів<br />
    • Збережіть ці дані в надійному місці!
  </div>
</div>


        <!-- Форма входу -->
<div id="loginForm" class="containerForm">
  <h1>🔐 Вхід в систему</h1>
  <div class="form-group">
    <label for="username">Ім'я користувача:</label>
    <input type="text" id="username" autocomplete="off" value="" />
  </div>
  <div class="form-group">
    <label for="password">Пароль:</label>
    <div class="password-wrapper">
      <input type="password" id="password" autocomplete="off" value="" />
      <span
        class="password-toggle-icon"
        onclick="togglePasswordVisibility('password', this)"
        title="Показати/приховати пароль"
      >
        👁️
      </span>
    </div>
  </div>
  <button onclick="loginUser()">Увійти</button>
  <div class="info-note">SHA-256 хешування з XOR шифруванням</div>
</div>

<!-- Захищений вміст -->
<div id="secureContent" class="containerForm">
  <p>Користувач : <span class="role-badge" id="welcomeUser"></span></p>

  <!-- Меню адміністратора -->
  <div id="adminMenu" class="menu">
    <h3>🛠️ Панель адміністратора</h3>
    <button class="menu-button" onclick="showCreateUserForm()">
      Створити користувача
    </button>
    <button class="menu-button" onclick="showDeleteUserForm()">
      Видалити користувача
    </button>
    <button class="menu-button" onclick="showUsersListForm()">
      Список користувачів
    </button>
    <button class="menu-button" onclick="showMyXORKeyForm()">Мій XORKey</button>
  </div>

  <!-- Меню користувача -->
  <div id="workspaceMenu" class="menu">
    <h3>Меню</h3>
    <button
      id="workJournalLink"
      class="menu-button"
      onclick="showWorkJournal()"
    >
      Робочий журнал
    </button>
    <button
      id="summaryWorkJournalLink"
      class="menu-button"
      onclick="showSummaryWorkJournal()"
      style="display: none"
    >
      Зведений робочий журнал
    </button>
    <button class="menu-button" onclick="showMoistureJournal()">
      Журнал вологості<br />Готова продукція
    </button>
    <button class="menu-button" onclick="showQualityControlJournal()">
      Журнал оперативно-<br />якісного контролю
    </button>
    <button class="menu-button" onclick="showConsolidatedJournal()">
      Зведений журнал
    </button>
  </div>

  <div class="security-info">
    <strong>Рівень безпеки:</strong><br />
    • SHA-256 хешування<br />
    • XOR шифрування даних<br />
    • Система ролей користувачів<br />
    • Локальна TSV база даних
  </div>

  <button onclick="showChangePasswordForm()" class="secondary-btn">
    Змінити пароль
  </button>
  <button onclick="logout()" class="secondary-btn">Вийти з системи</button>
</div>

<!-- Форма зміни паролю -->
<div id="changePasswordForm" class="containerForm">
  <h1>🔑 Зміна паролю</h1>
  <div class="form-group">
    <label for="currentPassword">Поточний пароль:</label>
    <input type="password" id="currentPassword" autocomplete="off" />
  </div>
  <div class="form-group">
    <label for="newPassword">Новий пароль:</label>
    <input type="password" id="newPassword" autocomplete="off" />
  </div>
  <div class="form-group">
    <label for="confirmPassword">Підтвердіть новий пароль:</label>
    <input type="password" id="confirmPassword" autocomplete="off" />
  </div>
  <button onclick="changePassword()">Змінити пароль</button>
  <button onclick="returnToMainMenu()" class="back-button">Повернутися</button>

  <div class="security-info">
    <strong>Вимоги до паролю:</strong><br />
    • Мінімум 8 символів<br />
    • Великі та малі літери<br />
    • Цифри та спеціальні символи
  </div>
</div>


        <!-- Форма створення користувача -->
<div id="createUserForm" class="containerForm">
  <h1>👤 Створити користувача</h1>
  <div class="form-group">
    <label for="newUserName">Ім'я користувача:</label>
    <input type="text" id="newUserName" autocomplete="off" />
  </div>
  <div class="form-group">
    <label for="newUserPassword">Пароль:</label>
    <input type="password" id="newUserPassword" autocomplete="off" />
  </div>
  <div class="form-group">
    <label for="newUserRole">Роль:</label>
    <select id="newUserRole">
      <option value="Guest">Guest (обмежений доступ)</option>
      <option value="User">User (повний доступ)</option>
      <option value="Moderator">Moderator (розширений доступ)</option>
    </select>
  </div>
  <button onclick="createNewUser()">Створити користувача</button>
  <button onclick="returnToMainMenu()" class="back-button">Повернутися</button>

  <div class="security-info">
    <strong>XOR ключі:</strong><br />
    • Guest: перші 8 символів головного ключа<br />
    • User/Moderator: повний головний ключ
  </div>
</div>

<!-- Форма видалення користувача -->
<div id="deleteUserForm" class="containerForm">
  <h1>🗑️ Видалити користувача</h1>
  <div class="form-group">
    <label for="deleteUserID">ID користувача для видалення:</label>
    <input type="number" id="deleteUserID" min="2" autocomplete="off" />
  </div>
  <button onclick="deleteUserById()" class="danger-button">
    Видалити користувача
  </button>
  <button onclick="returnToMainMenu()" class="back-button">Повернутися</button>

  <div class="security-info">
    <strong>Увага:</strong><br />
    • Неможливо видалити адміністратора (ID=1)<br />
    • Дія незворотна!
  </div>
</div>

<!-- Форма списку користувачів -->
<div id="usersListForm" class="containerForm">
  <h1>📋 Список користувачів</h1>
  <div id="usersList">
    <p>Завантаження...</p>
  </div>
  <button onclick="showUsersList()">Оновити список</button>
  <button onclick="returnToMainMenu()" class="back-button">Повернутися</button>
</div>

<!-- Форма перегляду XOR ключа адміністратора -->
<div id="myXORKeyForm" class="containerForm">
  <h1>🔑 Мій XORKey</h1>

  <div id="xorKeyGet" style="display: block">
    <div class="form-group">
      <label for="decryptPassword">Введіть ваш пароль для розшифрування:</label>
      <input type="password" id="decryptPassword" autocomplete="off" />
    </div>
    <button onclick="decryptAndShowXORKey()">Показати XORKey</button>
  </div>

  <div id="xorKeyDisplay" style="display: none; margin-top: 20px">
    <div class="security-info">
      <strong>Ваш головний XORKey:</strong><br />
      <textarea
        id="xorKeyValue"
        readonly
        style="
          width: 100%;
          height: 80px;
          margin-top: 10px;
          font-family: monospace;
          font-size: 12px;
        "
      ></textarea>
    </div>
    <button onclick="copyXORKeyToClipboard()" style="margin-top: 10px">
      Копіювати в буфер
    </button>
  </div>

  <button onclick="returnToMainMenu()" class="back-button">Повернутися</button>

  <div class="security-info">
    <strong>Безпека:</strong><br />
    • XORKey зберігається в зашифрованому вигляді<br />
    • Для розшифрування потрібен ваш пароль<br />
    • Не передавайте цей ключ сторонім особам
  </div>
</div>


        <div id="workspace" class="workspaceContainer">
  <!-- {{РОБОЧИЙ_ЖУРНАЛ // work-journal.html}} -->
  <div class="workspace-container">
  <div class="journal-header">
    <button
      class="back-button back-button--journal"
      onclick="returnToMainMenu()"
      tabindex="1"
    >
      ⮪
    </button>
    <h1 class="journal-title">Робочий журнал</h1>
    <div class="journal-controls">
      <div class="control-group">
        <label>Відбір:</label>
        <select class="control-input" id="sampleSelection" tabindex="2">
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5</option>
          <option value="6">6</option>
        </select>
      </div>
      <div class="control-group">
        <label>Зміна:</label>
        <select class="control-input" id="shiftNumber" tabindex="3">
          <option value="1">1</option>
          <option value="2">2</option>
        </select>
      </div>
      <div class="control-group">
        <label>Дата:</label>
        <input
          type="date"
          class="control-input"
          id="journalDate"
          tabindex="4"
        />
      </div>
      <div class="control-group">
        <label>Бригада:</label>
        <input
          type="text"
          class="control-input"
          id="brigadeInfo"
          value="Ушакова"
          tabindex="5"
        />
      </div>
    </div>
  </div>

  <div class="journal-table-container">
    <div id="verifiedDataMessage">Дані верифіковано і не підлягають зміні.</div>

    <table class="journal-table" id="qualityTable">
      <thead>
        <tr>
          <th rowspan="2" class="col-table col-product">
            Назва про&shy;дукції
          </th>
          <th rowspan="2" class="col-table col-bunker">Бункер/ Силос/ Яма</th>
          <th colspan="4">Воло&shy;гість</th>
          <th rowspan="2" class="col-table col-whiteness">Білість, од.</th>
          <th colspan="3">Сира клейко&shy;вина</th>
          <th rowspan="2" class="col-table col-residue">
            Зали&shy;шок на ситі *, %
          </th>
          <th rowspan="2" class="col-table col-passage">
            Прохо&shy;дження через сито **, %
          </th>
          <th rowspan="2" class="col-table col-metal">
            Метало&shy;домішки, мг
          </th>
          <th rowspan="2" class="col-table col-color">Колір, запах, смак</th>
          <th rowspan="2" class="col-table col-crust">Хруст&shy;кість</th>
          <th rowspan="2" class="col-table col-infection">
            Зараже&shy;ність шкідни&shy;ками
          </th>
        </tr>
        <tr>
          <th class="col-table col-sample">№ бюкси</th>
          <th class="col-table col-mass">Маса бюкси з наважкою 500г, мг</th>
          <th class="col-table col-moisture">
            Маса бюкси з наважкою після сушиль&shy;ної шафи, мг
          </th>
          <th class="col-table col-avg-moisture">Середня воло&shy;гість, %</th>
          <th class="col-table col-quantity">Кількість, %</th>
          <th class="col-table col-bdk">БДК, од.</th>
          <th class="col-table col-falling-number">ЧП,с</th>
        </tr>
      </thead>
      <tbody>
        <tr class="product-group-1 product-row" data-product="drama">
          <td rowspan="2" class="product-name">
            <div class="product-name-container">
              I драна
              <button
                class="product-toggle-btn"
                onclick="toggleProductRow('drama')"
                tabindex="-1"
                title="Активувати/деактивувати продукцію"
              ></button>
            </div>
          </td>
          <td rowspan="2"></td>
          <td>
            <select class="table-select" id="drama_sample1" tabindex="26">
              <option value=""></option>
              <option value="1">1</option>
              <option value="4a">4a</option>
              <option value="10a">10a</option>
              <option value="18a">18a</option>
              <option value="1a">1a</option>
              <option value="2a">2a</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="drama_mass1"
              tabindex="41"
              value="1838"
            />
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="drama_dried1"
              tabindex="56"
              value=""
            />
          </td>
          <td rowspan="2">
            <span class="table-text number" id="drama_moisture"> </span>
          </td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
        </tr>
        <tr class="product-group-1 product-row" data-product="drama">
          <td>
            <select class="table-select" id="drama_sample2" tabindex="27">
              <option value=""></option>
              <option value="1">1</option>
              <option value="4a">4a</option>
              <option value="10a">10a</option>
              <option value="18a">18a</option>
              <option value="1a">1a</option>
              <option value="2a">2a</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="drama_mass2"
              tabindex="42"
              value="1842"
            />
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="drama_dried2"
              tabindex="57"
              value=""
            />
          </td>
        </tr>

        <tr class="product-group-2 product-row" data-product="vs">
          <td rowspan="2" class="product-name">
            <div class="product-name-container">
              В/С
              <button
                class="product-toggle-btn"
                onclick="toggleProductRow('vs')"
                tabindex="-1"
                title="Активувати/деактивувати продукцію"
              ></button>
            </div>
          </td>
          <td rowspan="2">
            <select class="table-select" id="vs_bunker" tabindex="6">
              <option value=""></option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
              <option value="7">7</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="10">10</option>
            </select>
          </td>
          <td>
            <select class="table-select" id="vs_sample1" tabindex="28">
              <option value=""></option>
              <option value="1">1</option>
              <option value="4a">4a</option>
              <option value="10a">10a</option>
              <option value="18a">18a</option>
              <option value="1a">1a</option>
              <option value="2a">2a</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="vs_mass1"
              tabindex="43"
              value="1838"
            />
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="vs_dried1"
              tabindex="58"
              value=""
            />
          </td>
          <td rowspan="2">
            <span class="table-text number" id="vs_moisture"> </span>
          </td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="vs_whiteness"
              tabindex="81"
              value=""
            />
          </td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="vs_gluten_quantity"
              tabindex="87"
              step="0.1"
              value=""
            />
          </td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="vs_gluten_bdk"
              tabindex="91"
              value=""
            />
          </td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="vs_falling_number"
              tabindex="94"
              value=""
            />
          </td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="vs_residue"
              tabindex="97"
              step="0.1"
              value=""
            />
          </td>
          <td rowspan="2"></td>
          <td rowspan="2">
            <input
              type="text"
              class="table-input text"
              id="vs_metal"
              tabindex="107"
              value="сл."
            />
          </td>
          <td rowspan="2">
            <input
              type="text"
              class="table-input text"
              id="vs_color"
              tabindex="112"
              value="вл."
            />
          </td>
          <td rowspan="2">
            <input
              type="text"
              class="table-input text"
              id="vs_crunch"
              tabindex="117"
              value="н/в"
            />
          </td>
          <td rowspan="2"></td>
        </tr>
        <tr class="product-group-2 product-row" data-product="vs">
          <td>
            <select class="table-select" id="vs_sample2" tabindex="29">
              <option value=""></option>
              <option value="1">1</option>
              <option value="4a">4a</option>
              <option value="10a">10a</option>
              <option value="18a">18a</option>
              <option value="1a">1a</option>
              <option value="2a">2a</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="vs_mass2"
              tabindex="44"
              value="1842"
            />
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="vs_dried2"
              tabindex="59"
              value=""
            />
          </td>
        </tr>

        <tr class="product-group-3 product-row" data-product="first">
          <td rowspan="2" class="product-name">
            <div class="product-name-container">
              1/С
              <button
                class="product-toggle-btn"
                onclick="toggleProductRow('first')"
                tabindex="-1"
                title="Активувати/деактивувати продукцію"
              ></button>
            </div>
          </td>
          <td rowspan="2">
            <select class="table-select" id="first_bunker" tabindex="7">
              <option value=""></option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
              <option value="7">7</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="10">10</option>
            </select>
          </td>
          <td>
            <select class="table-select" id="first_sample1" tabindex="30">
              <option value=""></option>
              <option value="1">1</option>
              <option value="4a">4a</option>
              <option value="10a">10a</option>
              <option value="18a">18a</option>
              <option value="1a">1a</option>
              <option value="2a">2a</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="first_mass1"
              tabindex="45"
              value="1838"
            />
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="first_dried1"
              tabindex="60"
              value=""
            />
          </td>
          <td rowspan="2">
            <span class="table-text number" id="first_moisture"> </span>
          </td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="first_whiteness"
              tabindex="82"
              value=""
            />
          </td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="first_gluten_quantity"
              tabindex="88"
              step="0.1"
              value=""
            />
          </td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="first_gluten_bdk"
              tabindex="92"
              value=""
            />
          </td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="first_falling_number"
              tabindex="95"
              value=""
            />
          </td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="first_residue"
              tabindex="98"
              step="0.1"
              value=""
            />
          </td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="first_passage"
              tabindex="103"
              step="0.1"
              value="92.4"
            />
          </td>
          <td rowspan="2">
            <input
              type="text"
              class="table-input text"
              id="first_metal"
              tabindex="108"
              value="сл."
            />
          </td>
          <td rowspan="2">
            <input
              type="text"
              class="table-input text"
              id="first_color"
              tabindex="113"
              value="вл."
            />
          </td>
          <td rowspan="2">
            <input
              type="text"
              class="table-input text"
              id="first_crunch"
              tabindex="118"
              value="н/в"
            />
          </td>
          <td rowspan="2"></td>
        </tr>
        <tr class="product-group-3 product-row" data-product="first">
          <td>
            <select class="table-select" id="first_sample2" tabindex="31">
              <option value=""></option>
              <option value="1">1</option>
              <option value="4a">4a</option>
              <option value="10a">10a</option>
              <option value="18a">18a</option>
              <option <option value="1a">1a</option>
              <option value="2a">2a</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="first_mass2"
              tabindex="46"
              value="1842"
            />
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="first_dried2"
              tabindex="61"
              value=""
            />
          </td>
        </tr>

        <tr class="product-group-2 product-row" data-product="bran">
          <td rowspan="2" class="product-name">
            <div class="product-name-container">
              Висівки
              <button
                class="product-toggle-btn"
                onclick="toggleProductRow('bran')"
                tabindex="-1"
                title="Активувати/деактивувати продукцію"
              ></button>
            </div>
          </td>
          <td rowspan="2">
            <select class="table-select" id="bran_bunker" tabindex="8">
              <option value=""></option>
              <option value="11">11</option>
              <option value="12">12</option>
              <option value="13">13</option>
              <option value="14">14</option>
            </select>
          </td>
          <td>
            <select class="table-select" id="bran_sample1" tabindex="32">
              <option value=""></option>
              <option value="1">1</option>
              <option value="4a">4a</option>
              <option value="10a">10a</option>
              <option value="18a">18a</option>
              <option value="1a">1a</option>
              <option value="2a">2a</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="bran_mass1"
              tabindex="47"
              value="1838"
            />
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="bran_dried1"
              tabindex="62"
              value=""
            />
          </td>
          <td rowspan="2">
            <span class="table-text number" id="bran_moisture"> </span>
          </td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="bran_passage"
              tabindex="104"
              step="0.1"
              value="10.5"
            />
          </td>
          <td rowspan="2">
            <input
              type="text"
              class="table-input text"
              id="bran_metal"
              tabindex="109"
              value="сл."
            />
          </td>
          <td rowspan="2">
            <input
              type="text"
              class="table-input text"
              id="bran_color"
              tabindex="114"
              value="вл."
            />
          </td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
        </tr>
        <tr class="product-group-2 product-row" data-product="bran">
          <td>
            <select class="table-select" id="bran_sample2" tabindex="33">
              <option value=""></option>
              <option value="1">1</option>
              <option value="4a">4a</option>
              <option value="10a">10a</option>
              <option value="18a">18a</option>
              <option value="1a">1a</option>
              <option value="2a">2a</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="bran_mass2"
              tabindex="48"
              value="1842"
            />
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="bran_dried2"
              tabindex="63"
              value=""
            />
          </td>
        </tr>

        <tr class="product-group-3 product-row" data-product="feed">
          <td rowspan="2" class="product-name">
            <div class="product-name-container">
              Подача
              <button
                class="product-toggle-btn"
                onclick="toggleProductRow('feed')"
                tabindex="-1"
                title="Активувати/деактивувати продукцію"
              ></button>
            </div>
          </td>
          <td rowspan="2">
            <select class="table-select" id="feed_bunker" tabindex="9">
              <option value=""></option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
            </select>
          </td>
          <td>
            <select class="table-select" id="feed_sample1" tabindex="34">
              <option value=""></option>
              <option value="1">1</option>
              <option value="4a">4a</option>
              <option value="10a">10a</option>
              <option value="18a">18a</option>
              <option value="1a">1a</option>
              <option value="2a">2a</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="feed_mass1"
              tabindex="49"
              value="1816"
            />
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="feed_dried1"
              tabindex="64"
              value=""
            />
          </td>
          <td rowspan="2">
            <span class="table-text number" id="feed_moisture"> </span>
          </td>
          <td rowspan="2"></td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="feed_gluten_quantity"
              tabindex="89"
              step="0.1"
              value=""
            />
          </td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="feed_gluten_bdk"
              tabindex="93"
              value=""
            />
          </td>
          <td rowspan="2">
            <input
              type="number"
              class="table-input number"
              id="feed_falling_number"
              tabindex="96"
              value=""
            />
          </td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2">
            <input
              type="text"
              class="table-input text"
              id="feed_color"
              tabindex="115"
              value="вл."
            />
          </td>
          <td rowspan="2"></td>
          <td rowspan="2">
            <input
              type="text"
              class="table-input text"
              id="feed_infection"
              tabindex="120"
              value="н/в"
            />
          </td>
        </tr>
        <tr class="product-group-3 product-row" data-product="feed">
          <td>
            <select class="table-select" id="feed_sample2" tabindex="35">
              <option value=""></option>
              <option value="1">1</option>
              <option value="4a">4a</option>
              <option value="10a">10a</option>
              <option value="18a">18a</option>
              <option value="1a">1a</option>
              <option value="2a">2a</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="feed_mass2"
              tabindex="50"
              value="1808"
            />
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="feed_dried2"
              tabindex="65"
              value=""
            />
          </td>
        </tr>

        <tr class="product-group-2 product-row" data-product="soak">
          <td rowspan="2" class="product-name">
            <div class="product-name-container">
              I Замочка
              <button
                class="product-toggle-btn"
                onclick="toggleProductRow('soak')"
                tabindex="-1"
                title="Активувати/деактивувати продукцію"
              ></button>
            </div>
          </td>
          <td rowspan="2">
            <select class="table-select" id="soak_bunker" tabindex="10">
              <option value=""></option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
              <option value="1а">1а</option>
              <option value="2а">2а</option>
              <option value="3а">3а</option>
              <option value="4а">4а</option>
              <option value="5а">5а</option>
              <option value="6а">6а</option>
            </select>
          </td>
          <td>
            <select class="table-select" id="soak_sample1" tabindex="36">
              <option value=""></option>
              <option value="1">1</option>
              <option value="4a">4a</option>
              <option value="10a">10a</option>
              <option value="18a">18a</option>
              <option value="1a">1a</option>
              <option value="2a">2a</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="21">21</option>
              <option value="22">22</option>
              <option value="5">5</option>
              <option value="6">6</option>
            </select>
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="soak_mass1"
              tabindex="51"
              value="1865"
            />
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="soak_dried1"
              tabindex="66"
              value=""
            />
          </td>
          <td rowspan="2">
            <span class="table-text number" id="soak_moisture"></span>
          </td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
          <td rowspan="2"></td>
        </tr>
        <tr class="product-group-2 product-row" data-product="soak">
          <td>
            <select class="table-select" id="soak_sample2" tabindex="37">
              <option value=""></option>
              <option value="1">1</option>
              <option value="4a">4a</option>
              <option value="5">5</option>
              <option value="6">6</option>
              <option value="8">8</option>
              <option value="9">9</option>
              <option value="10a">10a</option>
              <option value="18a">18a</option>
              <option value="1a">1a</option>
              <option value="2a">2a</option>
              <option value="21">21</option>
              <option value="22">22</option>
            </select>
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="soak_mass2"
              tabindex="52"
              value="1872"
            />
          </td>
          <td>
            <input
              type="number"
              class="table-input number"
              id="soak_dried2"
              tabindex="67"
              value=""
            />
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="journal-footer">
    <div class="journal-notes">
      <strong>* Залишок на ситі №43 для В/С та №35 для 1/С</strong><br />
      <strong>** Прохід через сито №43 для 1/С та №27 для Висівок</strong>
    </div>
    <button
      class="save-btn"
      onclick="saveJournalDataWithProductionFlow()"
      tabindex="121"
    >
      Зберегти
    </button>
  </div>
</div>

</div>

<div id="summaryWorkspace" class="workspaceContainer">
  <!-- {{ЗВЕДЕНИЙ_РОБОЧИЙ_ЖУРНАЛ // summary-work-journal.html}} -->
  <!-- summary-journal.html - Зведений журнал модератора -->
<div class="workspace-container">
  <div class="journal-header">
    <button
      class="back-button back-button--journal"
      onclick="returnToMainMenu()"
      tabindex="1"
    >
      ⮪
    </button>
    <h1 class="journal-title">Зведений робочий журнал</h1>
    <div class="journal-controls">
      <div class="control-group">
        <label>Зміна:</label>
        <select class="control-input" id="summaryWorkShiftNumber" tabindex="2">
          <option value="1">1</option>
          <option value="2">2</option>
        </select>
      </div>
      <div class="control-group">
        <label>Дата:</label>
        <input
          type="date"
          class="control-input"
          id="summaryWorkJournalDate"
          tabindex="3"
        />
      </div>
      <div class="control-group">
        <label>Бригада:</label>
        <input
          type="text"
          class="control-input"
          id="summaryWorkBrigadeInfo"
          readonly
          tabindex="4"
        />
      </div>
    </div>
  </div>

  <div class="journal-table-container">
    <div id="summaryWorkTablesContainer">
      <!-- Тут будуть згенеровані таблиці для кожного продукту -->
    </div>
  </div>

  <div class="journal-footer">
    <div class="journal-notes">
      <strong>Перевірте дані та підтвердіть їх правильність</strong>
    </div>
    <button class="save-btn" onclick="verifySummaryWorkData()" tabindex="120">
      Підтвердити
    </button>
  </div>
</div>

</div>

<div id="moistureJournal" class="workspaceContainer">
  <!-- {{ЖУРНАЛ_ВОЛОГОСТІ // moisture-journal.html}} -->
  <!-- moisture-journal.html - Журнал вологості готової продукції -->
<div class="workspace-container">
  <div class="journal-header">
    <button
      class="back-button back-button--journal"
      onclick="returnToMainMenu()"
      tabindex="1"
    >
      ⮪
    </button>
    <h1 class="journal-title">Журнал вологості готової продукції</h1>
    <div class="journal-controls">
      <div class="control-group">
        <label>Зміна:</label>
        <select
          class="control-input"
          id="moistureJournalShiftNumber"
          tabindex="2"
        >
          <option value="1">1</option>
          <option value="2">2</option>
        </select>
      </div>
      <div class="control-group">
        <label>Дата:</label>
        <input
          type="date"
          class="control-input"
          id="moistureJournalDate"
          tabindex="3"
        />
      </div>
    </div>
  </div>

  <div class="journal-info-bar">
    <p class="journal-info-bar__item journal-info-bar__brigade">
      <strong>Бригада:</strong>
      <span id="moistureJournalBrigadeInfo">-</span>
    </p>
    <p class="journal-info-bar__item">
      <strong>Лаборант:</strong>
      <span id="moistureJournalLabTechnicianInfo">-</span>
    </p>
  </div>

  <div class="journal-table-container">
    <div id="moistureJournalTablesContainer">
      <p>Дані відсутні для вибраної дати та зміни.</p>
    </div>
  </div>
</div>

</div>

<div id="qualityControlJournal" class="workspaceContainer">
  <!-- {{ЖУРНАЛ_ЯКІСНОГО_КОНТРОЛЮ // quality-control-journal.html}} -->
  <div class="workspace-container">
  <div class="journal-header">
    <button
      class="back-button back-button--journal"
      onclick="returnToMainMenu()"
      tabindex="1"
    >
      ⮪
    </button>
    <h1 class="journal-title">Журнал оперативно-якісного контролю</h1>
    <div class="journal-controls">
      <div class="control-group">
        <label>Зміна:</label>
        <select
          class="control-input"
          id="qualityControlShiftNumber"
          tabindex="2"
        >
          <option value="1">1</option>
          <option value="2">2</option>
        </select>
      </div>
      <div class="control-group">
        <label>Дата:</label>
        <input
          type="date"
          class="control-input"
          id="qualityControlJournalDate"
          tabindex="3"
        />
      </div>
    </div>
  </div>

  <div class="journal-info-bar">
    <p class="journal-info-bar__item journal-info-bar__brigade">
      <strong>Бригада:</strong>
      <span id="qualityControlBrigadeInfo">-</span>
    </p>
    <p class="journal-info-bar__item">
      <strong>Лаборант:</strong>
      <span id="qualityControlLabTechnicianInfo">-</span>
    </p>
  </div>

  <div class="journal-table-container" id="qualityControlTablesContainer">
    <p id="qc-no-data-message" style="display: none">
      Дані відсутні для вибраної дати та зміни.
    </p>

    <div class="qc-section">
      <h2 class="qc-section-title">1. ЯКІСТЬ ЗЕРНА</h2>
      <table class="journal-table qc-table">
        <thead>
          <tr>
            <th rowspan="2">Показники якості</th>
            <th colspan="2">До очищення</th>
            <th colspan="2">Після очищення</th>
          </tr>
          <tr>
            <th>Попереднє</th>
            <th>Середньо&shy;змінне</th>
            <th>Попереднє</th>
            <th>Середньо&shy;змінне</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Воло&shy;гість, %</td>
            <td id="qc_grain_feed_moisture_prelim">-</td>
            <td id="qc_grain_feed_moisture_avg">-</td>
            <td id="qc_grain_drana_moisture_prelim">-</td>
            <td id="qc_grain_drana_moisture_avg">-</td>
          </tr>
          <tr>
            <td>Сирої клейко&shy;вини, %</td>
            <td id="qc_grain_feed_gluten_quantity_prelim">-</td>
            <td id="qc_grain_feed_gluten_quantity_avg">-</td>
            <td id="qc_grain_drana_gluten_quantity_prelim">-</td>
            <td id="qc_grain_drana_gluten_quantity_avg">-</td>
          </tr>
          <tr>
            <td>БДК, од.</td>
            <td id="qc_grain_feed_gluten_bdk_prelim">-</td>
            <td id="qc_grain_feed_gluten_bdk_avg">-</td>
            <td id="qc_grain_drana_gluten_bdk_prelim">-</td>
            <td id="qc_grain_drana_gluten_bdk_avg">-</td>
          </tr>
          <tr>
            <td>Число падіння, с</td>
            <td id="qc_grain_feed_falling_number_prelim">-</td>
            <td id="qc_grain_feed_falling_number_avg">-</td>
            <td id="qc_grain_drana_falling_number_prelim">-</td>
            <td id="qc_grain_drana_falling_number_avg">-</td>
          </tr>
          <tr>
            <td>Зараже&shy;ність шкідни&shy;ками</td>
            <td id="qc_grain_feed_infection_prelim">-</td>
            <td id="qc_grain_feed_infection_avg">-</td>
            <td id="qc_grain_drana_infection_prelim">-</td>
            <td id="qc_grain_drana_infection_avg">-</td>
          </tr>
          <tr>
            <td>Запах, смак, колір</td>
            <td id="qc_grain_feed_color_prelim">-</td>
            <td id="qc_grain_feed_color_avg">-</td>
            <td id="qc_grain_drana_color_prelim">-</td>
            <td id="qc_grain_drana_color_avg">-</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="qc-section">
      <h2 class="qc-section-title">2. ЯКІСТЬ ПРОДУКЦІЇ</h2>
      <table class="journal-table qc-table">
        <thead>
          <tr>
            <th rowspan="2">Показ&shy;ники якос&shy;ті</th>
            <th colspan="2">Борошно В/С</th>
            <th colspan="2">Борошно 1/С</th>
            <th colspan="2">Висівки</th>
          </tr>
          <tr>
            <th>Попереднє</th>
            <th>Середньо&shy;змінне</th>
            <th>Попереднє</th>
            <th>Середньо&shy;змінне</th>
            <th>Попереднє</th>
            <th>Середньо&shy;змінне</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Воло&shy;гість, %</td>
            <td id="qc_prod_vs_moisture_prelim">-</td>
            <td id="qc_prod_vs_moisture_avg">-</td>
            <td id="qc_prod_first_moisture_prelim">-</td>
            <td id="qc_prod_first_moisture_avg">-</td>
            <td id="qc_prod_bran_moisture_prelim">-</td>
            <td id="qc_prod_bran_moisture_avg">-</td>
          </tr>
          <tr>
            <td>Білість, од.</td>
            <td id="qc_prod_vs_whiteness_prelim">-</td>
            <td id="qc_prod_vs_whiteness_avg">-</td>
            <td id="qc_prod_first_whiteness_prelim">-</td>
            <td id="qc_prod_first_whiteness_avg">-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Сирої клейко&shy;вини, %</td>
            <td id="qc_prod_vs_gluten_quantity_prelim">-</td>
            <td id="qc_prod_vs_gluten_quantity_avg">-</td>
            <td id="qc_prod_first_gluten_quantity_prelim">-</td>
            <td id="qc_prod_first_gluten_quantity_avg">-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>БДК, од.</td>
            <td id="qc_prod_vs_gluten_bdk_prelim">-</td>
            <td id="qc_prod_vs_gluten_bdk_avg">-</td>
            <td id="qc_prod_first_gluten_bdk_prelim">-</td>
            <td id="qc_prod_first_gluten_bdk_avg">-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Число падіння, с</td>
            <td id="qc_prod_vs_falling_number_prelim">-</td>
            <td id="qc_prod_vs_falling_number_avg">-</td>
            <td id="qc_prod_first_falling_number_prelim">-</td>
            <td id="qc_prod_first_falling_number_avg">-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Зали&shy;шок на ситі *, %</td>
            <td id="qc_prod_vs_residue_prelim">-</td>
            <td id="qc_prod_vs_residue_avg">-</td>
            <td id="qc_prod_first_residue_prelim">-</td>
            <td id="qc_prod_first_residue_avg">-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Проходже&shy;ння через сито **, %</td>
            <td>-</td>
            <td>-</td>
            <td id="qc_prod_first_passage_prelim">-</td>
            <td id="qc_prod_first_passage_avg">-</td>
            <td id="qc_prod_bran_passage_prelim">-</td>
            <td id="qc_prod_bran_passage_avg">-</td>
          </tr>
          <tr>
            <td>Метало&shy;доміш&shy;ки, мг</td>
            <td id="qc_prod_vs_metal_prelim">-</td>
            <td id="qc_prod_vs_metal_avg">-</td>
            <td id="qc_prod_first_metal_prelim">-</td>
            <td id="qc_prod_first_metal_avg">-</td>
            <td id="qc_prod_bran_metal_prelim">-</td>
            <td id="qc_prod_bran_metal_avg">-</td>
          </tr>
          <tr>
            <td>Хруст&shy;кість</td>
            <td id="qc_prod_vs_crunch_prelim">-</td>
            <td id="qc_prod_vs_crunch_avg">-</td>
            <td id="qc_prod_first_crunch_prelim">-</td>
            <td id="qc_prod_first_crunch_avg">-</td>
            <td>-</td>
            <td>-</td>
          </tr>
          <tr>
            <td>Запах, смак, колір</td>
            <td id="qc_prod_vs_color_prelim">-</td>
            <td id="qc_prod_vs_color_avg">-</td>
            <td id="qc_prod_first_color_prelim">-</td>
            <td id="qc_prod_first_color_avg">-</td>
            <td id="qc_prod_bran_color_prelim">-</td>
            <td id="qc_prod_bran_color_avg">-</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

</div>

<div id="consolidatedJournal" class="workspaceContainer">
  <!-- {{ЗВЕДЕНИЙ_ЖУРНАЛ // consolidated-journal.html}} -->
  <div class="workspace-container">
  <div class="journal-header">
    <button
      class="back-button back-button--journal"
      onclick="returnToMainMenu()"
      tabindex="1"
    >
      &#x2BAA;
    </button>
    <h1 class="journal-title">Зведений журнал</h1>

    <div class="journal-controls">
      <button
        class="pagination-btn"
        onclick="changeMonth(-1)"
        title="Попередній місяць"
      >
        &lt;
      </button>
      <span id="currentMonthDisplay" class="month-display"></span>
      <button
        class="pagination-btn"
        onclick="changeMonth(1)"
        title="Наступний місяць"
      >
        &gt;
      </button>
    </div>
  </div>

  <div class="journal-table-container">
    <div
      id="consolidated-no-data"
      style="
        display: none;
        text-align: center;
        padding: 40px;
        font-size: 16px;
        color: #757575;
      "
    >
      Дані за поточний період відсутні.
    </div>
    <table class="journal-table consolidated-table" id="consolidated-table">
      <thead>
        <tr>
          <th rowspan="2">Дата</th>
          <th rowspan="2">Бригада</th>
          <th>I драна</th>
          <th colspan="6">Борошно В/С</th>
          <th colspan="7">Борошно 1/С</th>
          <th colspan="2">Висівки</th>
        </tr>
        <tr>
          <th>Воло&shy;гість, %</th>
          <th>Воло&shy;гість, %</th>
          <th>Білість, од.</th>
          <th>Метало&shy;доміш&shy;ки, мг</th>
          <th>Зали&shy;шок на ситі*, %</th>
          <th>Сирої клейко&shy;вини, %</th>
          <th>БДК, од.</th>
          <th>Воло&shy;гість, %</th>
          <th>Білість, од.</th>
          <th>Метало&shy;доміш&shy;ки, мг</th>
          <th>Зали&shy;шок на ситі*, %</th>
          <th>Проход&shy;ження через сито**, %</th>
          <th>Сирої клейко&shy;вини, %</th>
          <th>БДК, од.</th>
          <th>Воло&shy;гість, %</th>
          <th>Метало&shy;доміш&shy;ки, мг</th>
        </tr>
      </thead>
      <tbody id="consolidated-journal-body"></tbody>
    </table>
  </div>
</div>

</div>

    </div>
    <div class="promo-box__footer" id="promoBoxFooter">
      <p class="footer-signature" id="footer-signature"></p>
      <p class="promo-box__footer-text">Створено <a href="mailto:m.a.startsev@gmail.com" title="Зв'язатися з розробником">M. Startsev</a> - 2025</p>
    </div>
</body>
<script>
function monitorContainerSize(containerId) {
    var element = document.getElementById(containerId);
    
    if (!element) {
      console.log("Елемент з ID '" + containerId + "' не знайдено");
      return;
    }
    
    function logSize() {
      var width = element.offsetWidth;
      var height = element.offsetHeight;
      console.log(containerId + " - Ширина: " + width + "px, Висота: " + height + "px");
    }
    
    // Перший виклик відразу
    logSize();
    
    // Повторювати кожні 8 секунд
    setInterval(logSize, 8000);
  }

  // monitorContainerSize("body");

</script>
<!-- <script language="JavaScript"> verifyIntegrity() </script> // Закоментовано на час розробки -->
</html>